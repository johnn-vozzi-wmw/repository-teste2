--VERSAO 6.006

/*-------------------------------------------------------------------------
NOVAS COLUNAS
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPTIPOPEDIDO ADD FLIGNORADESCONTOITEM CHAR(1);
GO

ALTER TABLE TBLVPTIPOPEDIDO ADD FLIGNORAQUANTIDADEITEM CHAR(1);
GO

--VERSAO 6.012

/*-------------------------------------------------------------------------
NOVA COLUNA
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCLIENTE ADD CDCONDICAOCOMERCIAL VARCHAR(20);
GO

--VERSAO 6.016

/*-------------------------------------------------------------------------
Descrição: Novas tabelas
Data: 22/10/2018
------------------------------------------------------------------------*/
CREATE TABLE TBLVPDESCONTOCOMISSAO (
    CDEMPRESA               VARCHAR(20)         NOT NULL,
    CDREPRESENTANTE         VARCHAR(20)         NOT NULL,
    VLFAIXADESCONTO         DECIMAL(16,7)       NOT NULL,
    VLPCTCOMISSAO           DECIMAL(16,7)           NULL,
    QTITEM                  DECIMAL(9,0)            NULL,
    VLPCTAPLICADO           DECIMAL(16,7)           NULL,
    FLAPLICAINDICEDESCONTO  CHAR(1)                 NULL,
    VLINDICEDESCONTO        DECIMAL(16,7)           NULL,
    VLPCTDESCONTOMIN        DECIMAL(16,7)           NULL,
    VLPCTCOMISSAOMIN        DECIMAL(16,7)           NULL,
	CDUSUARIO				VARCHAR(8)			NOT NULL,
	NUCARIMBO				DECIMAL(9,0)			NULL,
	FLTIPOALTERACAO			CHAR(1)					NULL,
	DTALTERACAO				DATETIME				NULL,
	HRALTERACAO				VARCHAR(8)				NULL,
	CONSTRAINT		PK_TBLVPDESCONTOCOMISSAO	PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, VLFAIXADESCONTO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPDESCONTOICMS (
    CDEMPRESA       VARCHAR(20)     NOT NULL,
    CDREPRESENTANTE VARCHAR(20)     NOT NULL,
    VLPCTICMS       DECIMAL(16,7)   NOT NULL,
    VLPCTDESCONTO   DECIMAL(16,7)       NULL,
    VLPCTACRESCIMO  DECIMAL(16,7)       NULL,
    FLTIPOALTERACAO	CHAR(1)				NULL,
	NUCARIMBO		DECIMAL(9,0)		NULL,
    DTALTERACAO     DATETIME            NULL,
    HRALTERACAO     VARCHAR(8)          NULL,
	CDUSUARIO		VARCHAR(8)		NOT NULL,
    CONSTRAINT PK_TBLVPDESCONTOICMS PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, VLPCTICMS, CDUSUARIO)
)
GO

CREATE TABLE TBLVPICMSCLIENTE (
    CDEMPRESA VARCHAR(20) NOT NULL,
    CDREPRESENTANTE   VARCHAR(20)   NOT NULL,
    CDRAMOATIVIDADE   VARCHAR(20)   NOT NULL,
    CDUF              VARCHAR(20)   NOT NULL,
    FLCONTRIBUINTE    CHAR(1)       NOT NULL,
    FLCONSUMIDORFINAL CHAR(1)       NOT NULL,
    VLPCTICMS         DECIMAL(16,7)     NULL,
    FLTIPOALTERACAO	CHAR(1)				NULL,
	NUCARIMBO		DECIMAL(9,0)		NULL,
    DTALTERACAO     DATETIME            NULL,
    HRALTERACAO     VARCHAR(8)          NULL,
	CDUSUARIO		VARCHAR(8)		NOT NULL,
    CONSTRAINT PK_TBLVPICMSCLIENTE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDRAMOATIVIDADE, CDUF, FLCONTRIBUINTE, FLCONSUMIDORFINAL, CDUSUARIO)
)
GO

CREATE TABLE TBLVPTERMOCORRECAO (
	DSTERMO					VARCHAR(100)		NOT NULL,
	DSTERMOCORRIGIDO		VARCHAR(100)		NOT NULL,
	CDUSUARIO				VARCHAR(8)			NOT NULL,
	NUCARIMBO				DECIMAL(9,0)			NULL,
	FLTIPOALTERACAO			CHAR(1)					NULL,
	DTALTERACAO				DATETIME				NULL,
	HRALTERACAO				VARCHAR(8)				NULL,
	CONSTRAINT	PK_TBLVPTERMOCORRECAO	PRIMARY KEY (DSTERMO, DSTERMOCORRIGIDO, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------
Data: 01/11/2018
Descrição: Novas colunas
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCLIENTE ADD FLCONTRIBUINTE CHAR(1);
GO

ALTER TABLE TBLVPCLIENTE ADD FLCONSUMIDORFINAL CHAR(1);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTACRESCIMOICMS DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTDESCONTOICMS DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTACRESCIMOICMS DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTDESCONTOICMS DECIMAL(16,7);
GO

ALTER TABLE TBLVPUSUARIODESC ADD VLPCTINICIOALCADA DECIMAL(16,7);
GO

ALTER TABLE TBLVPUSUARIODESC ADD VLPCTFIMALCADA DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTDESCALCADA DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTDESCALCADA DECIMAL(16,7);
GO

ALTER TABLE TBLVPNOVOCLIENTE ADD FLSTATUSCADASTRO CHAR(1);
GO

ALTER TABLE TBLVPNOVOCLIENTE ADD CDUSUARIOCRIACAO VARCHAR(20);
GO

ALTER TABLE TBLVPCLIENTE ADD FLRECEBESMS CHAR(1) NULL;
GO

--VERSAO 6.017

/*-------------------------------------------------------------------------
Descrição: Novos campos
------------------------------------------------------------------------*/

ALTER TABLE TBLVPESTOQUEREP ADD CDESTOQUEREP VARCHAR(20);
GO

ALTER TABLE TBLVPESTOQUEREP ADD FLTIPODEVOLUCAO CHAR(1);
GO

ALTER TABLE TBLVPEMPRESA ADD NUDIASINTDEVOLESTOQUE  DECIMAL(9,0);
GO

ALTER TABLE TBLVPREMESSAESTOQUE ADD FLFINALIZADA CHAR(1);
GO

ALTER TABLE TBLVPTABELAPRECO ADD FLDEVOLUCAOESTOQUE CHAR(1);
GO

ALTER TABLE TBLVPEMPRESA ADD NUINTERVALOCANCNFE DECIMAL(9,0);
GO

ALTER TABLE TBLVPITEMNFE ADD QTMULTIPLOEMBALAGEM DECIMAL(16,7);
GO

ALTER TABLE TBLVPESTOQUE ADD QTESTOQUEREMESSA DECIMAL(16,7);
GO

ALTER TABLE TBLVPMETAVENDACLI ADD VLMETA DECIMAL(16,7);
GO

ALTER TABLE TBLVPMETAVENDACLI ADD VLREALIZADO DECIMAL(16,7);
GO

ALTER TABLE TBLVPREMESSAESTOQUE ADD DTFINALIZACAO DATETIME;
GO

ALTER TABLE TBLVPREMESSAESTOQUE ADD HRFINALIZACAO VARCHAR(8);
GO


/*-------------------------------------------------------------------------
Descrição: Alteração de coluna
------------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPNFE ALTER COLUMN DSMENSAGEMRETORNO VARCHAR(200);
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPNFE MODIFY DSMENSAGEMRETORNO VARCHAR(200);
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPNFE ALTER COLUMN DSMENSAGEMRETORNO TYPE VARCHAR(200);
--/POSTGRES

--SQLSERVER
EXEC SP_RENAME 'TBLVPFAIXABOLETO.CDBANCO', 'CDBOLETOCONFIG', 'COLUMN';
EXEC SP_RENAME 'TBLVPTIPOPAGAMENTO.CDBANCO', 'CDBOLETOCONFIG', 'COLUMN';
EXEC SP_RENAME 'TBLVPPEDIDOBOLETO.CDBANCO', 'CDBOLETOCONFIG', 'COLUMN';
EXEC SP_RENAME 'TBLVPPAGAMENTOPEDIDO.CDBANCO', 'NUBANCO', 'COLUMN';
EXEC SP_RENAME 'TBLVPPAGAMENTOPEDIDOERP.CDBANCO', 'NUBANCO', 'COLUMN';
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPFAIXABOLETO RENAME COLUMN CDBANCO to CDBOLETOCONFIG;
ALTER TABLE TBLVPTIPOPAGAMENTO RENAME COLUMN CDBANCO to CDBOLETOCONFIG;
ALTER TABLE TBLVPPEDIDOBOLETO RENAME COLUMN CDBANCO to CDBOLETOCONFIG;
ALTER TABLE TBLVPPAGAMENTOPEDIDO RENAME COLUMN CDBANCO to NUBANCO;
ALTER TABLE TBLVPPAGAMENTOPEDIDOERP RENAME COLUMN CDBANCO to NUBANCO;
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPFAIXABOLETO RENAME COLUMN CDBANCO to CDBOLETOCONFIG;
ALTER TABLE TBLVPTIPOPAGAMENTO RENAME COLUMN CDBANCO to CDBOLETOCONFIG;
ALTER TABLE TBLVPPEDIDOBOLETO RENAME COLUMN CDBANCO to CDBOLETOCONFIG;
ALTER TABLE TBLVPPAGAMENTOPEDIDO RENAME COLUMN CDBANCO to NUBANCO;
ALTER TABLE TBLVPPAGAMENTOPEDIDOERP RENAME COLUMN CDBANCO to NUBANCO;
--/POSTGRES

/*-------------------------------------------------------------------------
Descrição: Alteração de estrutura de tabelas
------------------------------------------------------------------------*/
DROP TABLE TBLVPBANCO;
GO

CREATE TABLE TBLVPBOLETOCONFIG (
   CDBOLETOCONFIG       VARCHAR(20)          NOT NULL,
   NMBANCO              VARCHAR(100)         NULL,
   IMBANCO              VARBINARY(MAX)       NULL,
   CDBENEFICIARIO       VARCHAR(20)          NULL,
   NUAGENCIACODIGOCEDENTE VARCHAR(20)        NULL,
   NUBANCO              VARCHAR(20)          NULL,
   NUCARTEIRA           VARCHAR(20)          NULL,
   FLMODOBOLETO         CHAR(1)              NULL,
   NUAGENCIA            VARCHAR(20)          NULL,
   NUCONTA              VARCHAR(20)          NULL,
   DSLOCALPAGAMENTO     VARCHAR(100)         NULL,
   NUBYTEBOLETO         DECIMAL(1,0)         NULL,
   DSCARTEIRA           VARCHAR(20)          NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DSESPECIEBANCO       VARCHAR(20)          NULL,
   DSMENSAGEMSACADOR    VARCHAR(50)          NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPBOLETOCONFIG PRIMARY KEY (CDBOLETOCONFIG, CDUSUARIO)
)
GO

--POSTGRES
ALTER TABLE TBLVPPEDIDOBOLETO ALTER COLUMN NUDOCUMENTO TYPE DECIMAL(15,0);
--/POSTGRES

--SQLSERVER
ALTER TABLE TBLVPPEDIDOBOLETO ALTER COLUMN NUDOCUMENTO DECIMAL(15,0);
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPPEDIDOBOLETO MODIFY NUDOCUMENTO NUMBER(15,0);
--/ORACLE

/*-------------------------------------------------------------------------
Descrição: Novos campos
------------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDOERP ADD FLPROCESSANDONFETXT CHAR(1);
GO

ALTER TABLE TBLVPPEDIDO ADD FLPROCESSANDONFETXT CHAR(1);
GO


--VERSAO 6.020

/*------------------------------------------------------------------------
Descrição: Novas Colunas
Data: 20/11/2018
Autor: Anderson
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD FLAGUARDAPEDIDOCOMPLEMENTAR CHAR(1);
GO

ALTER TABLE TBLVPPEDIDOERP ADD FLAGUARDAPEDIDOCOMPLEMENTAR CHAR(1);
GO

ALTER TABLE TBLVPTIPOPEDIDO ADD FLINDICAAGUARDACOMPLEMENTO CHAR(1);
GO

--VERSAO 6.024

/*-------------------------------------------------------------------------
Descrição: Nova coluna
Data: 22/11/2018
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCLIENTE ADD CDCONDICAOPAGTOBLOQUEADA VARCHAR(1000);
GO


--VERSAO 6.027

/*------------------------------------------------------------------------
NOVO CAMPO
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPNFE ADD FLENVIADOVIAJSON CHAR(1);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLALTURA DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLLARGURA DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLCOMPRIMENTO DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPOSVINCO1	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPOSVINCO2	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPOSVINCO3	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPOSVINCO4	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPOSVINCO5	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPOSVINCO6	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPOSVINCO7	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPOSVINCO8	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPOSVINCO9	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPOSVINCO10 DECIMAL(9,0);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLALTURA DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLLARGURA DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLCOMPRIMENTO DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPOSVINCO1	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPOSVINCO2	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPOSVINCO3	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPOSVINCO4	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPOSVINCO5	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPOSVINCO6	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPOSVINCO7	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPOSVINCO8	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPOSVINCO9	DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPOSVINCO10 DECIMAL(9,0);
GO


--VERSAO 6.031

--Nova Tabela

CREATE TABLE TBLVPESTOQUEPREVISTO (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
   CDPRODUTO            VARCHAR(20)          NOT NULL,
   CDITEMGRADE1         VARCHAR(20)          NOT NULL,
   CDITEMGRADE2         VARCHAR(20)          NOT NULL,
   CDITEMGRADE3         VARCHAR(20)          NOT NULL,
   CDLOCALESTOQUE       VARCHAR(20)          NOT NULL,
   FLORIGEMESTOQUE      CHAR(1)              NOT NULL,
   DTESTOQUE            DATETIME             NOT NULL,
   QTESTOQUE            DECIMAL(16,7)        NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPESTOQUEPREVISTO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDITEMGRADE1, CDITEMGRADE2, CDITEMGRADE3, CDLOCALESTOQUE, FLORIGEMESTOQUE, DTESTOQUE, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------
Alteração de Tabela
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPROTAENTREGA ADD DSDIASENTREGA VARCHAR(13);


--VERSAO 6.032

--VERSAO 6.033


CREATE TABLE TBLVPLOCAL (
	CDEMPRESA		VARCHAR(20) NOT NULL,
	CDREPRESENTANTE	VARCHAR(20) NOT NULL,
	CDLOCAL			VARCHAR(20)	NOT NULL,
	DSLOCAL			VARCHAR(100)    NULL,
	FLTIPOALTERACAO CHAR(1)			NULL,
	CDUSUARIO		VARCHAR(8)	NOT NULL,
	NUCARIMBO		DECIMAL(9,0)	NULL,
	DTALTERACAO		DATETIME		NULL,
	HRALTERACAO		VARCHAR(8)		NULL,
CONSTRAINT PK_TBLVPLOCAL PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDLOCAL, CDUSUARIO)
)
GO

ALTER TABLE TBLVPLOTEPRODUTO ADD CDLOCAL VARCHAR(20);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD CDLOCAL VARCHAR(20);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD CDLOCAL VARCHAR(20);
GO

ALTER TABLE TBLVPDESCPROMOCIONAL ADD CDLOCAL VARCHAR(20) DEFAULT '0' NOT NULL;
GO
ALTER TABLE TBLVPDESCPROMOCIONAL DROP CONSTRAINT PK_TBLVPDESCPROMOCIONAL;
GO

--ORACLE
DROP INDEX PK_TBLVPDESCPROMOCIONAL;
GO
--/ORACLE

ALTER TABLE TBLVPDESCPROMOCIONAL ADD CONSTRAINT PK_TBLVPDESCPROMOCIONAL PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDCLIENTE, CDGRUPODESCCLI, CDGRUPODESCPROD, CDCONDICAOCOMERCIAL, CDTABELAPRECO, QTITEM, NUPROMOCAO, CDUSUARIO, CDLOCAL);
GO


--VERSAO 6.034

/*------------------------------------------------------------------------
DescriÃ§Ã£o: Nova tabela
Data: 28/11/2018
Autor: Eduardo
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPACAOTELA (
   CDSISTEMA            DECIMAL(9)           NOT NULL,
   CDTELA               DECIMAL(9)           NOT NULL,
   CDACAO               DECIMAL(9)           NOT NULL,
   CDTELADESTINO        DECIMAL(9)           NULL,
   NMCOMANDOACAO        VARCHAR(500)         NOT NULL,
   NMCONTEXTOACAO       VARCHAR(250)         NULL,
   FLALVOINTERNO        CHAR(1)              NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPACAOTELA PRIMARY KEY (CDSISTEMA, CDTELA, CDACAO, CDUSUARIO)
)
GO

/*==============================================================*/
/* INDEX - LAV-16670     */
/*==============================================================*/


CREATE NONCLUSTERED INDEX IDX_RECEBE_PEDIDO ON TBLVPPEDIDO (CDUSUARIO, FLTIPOALTERACAO);
GO

CREATE NONCLUSTERED INDEX IDX_RECEBE_ITEMPEDIDO ON TBLVPITEMPEDIDO (CDUSUARIO, FLTIPOALTERACAO);
GO

--VERSAO 6.035

--VERSAO 6.036

--VERSAO 6.037
/*------------------------------------------------------------------------
LAV-16939
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPNFE DROP COLUMN FLENVIADOVIAJSON;

--VERSAO 6.038

--VERSAO 6.040

--VERSAO 6.041

/*------------------------------------------------------------------------
LAV-15523
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPGRUPODESCCLI (
	CDEMPRESA		VARCHAR(20)		NOT NULL,
	CDREPRESENTANTE VARCHAR(20)		NOT NULL,
	CDGRUPODESCCLI	VARCHAR(20)		NOT NULL,
	CDCLIENTE		VARCHAR(20)		NOT NULL,
	DSGRUPODESCCLI	VARCHAR(100)		NULL,
	CDUSUARIO		VARCHAR(8)		NOT NULL,
	NUCARIMBO		DECIMAL(9,0)		NULL,
	FLTIPOALTERACAO CHAR(1)				NULL,
	DTALTERACAO		DATETIME			NULL,
	HRALTERACAO		VARCHAR(8)			NULL,
CONSTRAINT PK_TBLVPGRUPODESCCLI PRIMARY KEY(CDEMPRESA,CDREPRESENTANTE,CDGRUPODESCCLI,CDCLIENTE,CDUSUARIO)
)
GO

--VERSAO 6.042
--VERSAO 6.043

/*------------------------------------------------------------------------
	 NOVAS COLUNAS
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD FLORIGEMESCOLHAITEMPEDIDO VARCHAR(3);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD CDPRODUTOORIGEM VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLITEMPEDIDOORIGEM DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD DTINCLUSAOITEMPEDIDO DATETIME;
GO

ALTER TABLE TBLVPITEMPEDIDO ADD HRINCLUSAOITEMPEDIDO VARCHAR(8);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD FLORIGEMESCOLHAITEMPEDIDO VARCHAR(3);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD CDPRODUTOORIGEM VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLITEMPEDIDOORIGEM DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD DTINCLUSAOITEMPEDIDO DATETIME;
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD HRINCLUSAOITEMPEDIDO VARCHAR(8);
GO

--VERSAO 6.044

--VERSAO 6.045

ALTER TABLE TBLVPPRODUTOGRADE ADD NUCODIGOBARRAS VARCHAR(200);
GO

ALTER TABLE TBLVPPRODUTO ADD DSAPLICACAOPRODUTO TEXT;
GO

ALTER TABLE TBLVPPRODUTO ADD DSCODIGOALTERNATIVO VARCHAR(500);
GO

ALTER TABLE TBLVPTIPOPEDIDO ADD FLNAORELACIONAPEDNATROCABONIF VARCHAR(1);
GO

--VERSAO 6.046

--VERSAO 6.047

--VERSAO 6.048

--VERSAO 6.049

/*------------------------------------------------------------------------
LAV-15414
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPINDICECLIENTEGRUPOPROD (
	CDEMPRESA			VARCHAR(20)		NOT NULL,
	CDREPRESENTANTE		VARCHAR(20)		NOT NULL,
	CDCLIENTE			VARCHAR(20)		NOT NULL,
	CDGRUPOPRODUTO1		VARCHAR(20)		NOT NULL,
	CDGRUPOPRODUTO2		VARCHAR(20)		NOT NULL,
	CDPRODUTO			VARCHAR(20)		NOT NULL,
	VLINDICEFINANCEIRO  DECIMAL(16,7)		NULL,
	CDUSUARIO			VARCHAR(8)		NOT NULL,
	NUCARIMBO			DECIMAL(9,0)		NULL,
	FLTIPOALTERACAO		CHAR(1)				NULL,
	DTALTERACAO			DATETIME			NULL,
	HRALTERACAO			VARCHAR(8)			NULL,
CONSTRAINT PK_TBLVPINDICECLIENTEGRUPOPROD PRIMARY KEY(CDEMPRESA,CDREPRESENTANTE,CDCLIENTE,CDGRUPOPRODUTO1,CDGRUPOPRODUTO2,CDPRODUTO,CDUSUARIO)
);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLINDICECLIENTEGRUPOPROD DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLINDICECLIENTEGRUPOPROD DECIMAL(16,7);
GO

--VERSAO 6.050

--VERSAO 6.051

--VERSAO 6.052

--VERSAO 6.053

--VERSAO 6.054

/*-------------------------------------------------------------------------
Data: 10/01/2018
Descrição: Nova tabela
------------------------------------------------------------------------*/
CREATE TABLE TBLVPDESCMAXPRODCLI (
    CDEMPRESA       		 VARCHAR(20)   NOT NULL,
    CDREPRESENTANTE 		 VARCHAR(20)   NOT NULL,
    CDGRUPODESCMAXPROD       VARCHAR(20)   NOT NULL,
    CDCLIENTE   			 VARCHAR(20)   NOT NULL,
    VLPCTDESCMAX  			 DECIMAL(16,7)     NULL,
    CDUSUARIO				 VARCHAR(8)    NOT NULL,
    NUCARIMBO		         DECIMAL(9,0)	   NULL,
	FLTIPOALTERACAO			 CHAR(1)		   NULL,
	DTALTERACAO     		 DATETIME          NULL,
   	HRALTERACAO      		 VARCHAR(8)        NULL,
    CONSTRAINT PK_TBLVPDESCMAXPRODCLI PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDGRUPODESCMAXPROD, CDCLIENTE, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Data: 10/01/2018
Descrição: Nova coluna
------------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTO ADD CDGRUPODESCMAXPROD VARCHAR(20);
GO

/*-------------------------------------------------------------------------
Data: 10/01/2018
Descrição: Exclusão de tabela
------------------------------------------------------------------------*/
DROP TABLE TBLVPGRUPODESCCLI;
GO

--VERSAO 6.055

--VERSAO 6.056

--VERSAO 6.057

--VERSAO 6.058

--VERSAO 6.059

/*------------------------------------------------------------------------
 	NOVO CAMPO
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPUSUARIOPDA ADD DSLINKDOWNLOAD VARCHAR(100);
GO

--VERSAO 6.060

CREATE TABLE TBLVPTRANSPCEP (
   CDEMPRESA	        VARCHAR(20)          NOT NULL,
   CDTRANSPORTADORA     VARCHAR(8)           NOT NULL,
   CDTIPOSERVICOFRETE   VARCHAR(50)          NOT NULL,
   NUFAIXACEPINICIAL    DECIMAL(9,0)         NOT NULL,
   NUFAIXACEPFINAL      DECIMAL(9,0)         NOT NULL,
   NUDIASENTREGA        DECIMAL(9,0)         NULL,
   VLPCTFRETE           DECIMAL(9,0)         NULL,
   VLMINFRETE           DECIMAL(9,0)         NULL,
   VLTAXACOLETA			DECIMAL(9,0)		 NULL,
   CDUSUARIO			VARCHAR(8)			 NOT NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   DTALTERACAO          DATE                 NULL,
   CONSTRAINT PK_TBLVPTRANSPCEP PRIMARY KEY (CDEMPRESA, CDTRANSPORTADORA, CDTIPOSERVICOFRETE, NUFAIXACEPINICIAL, NUFAIXACEPFINAL, CDUSUARIO)
)
GO

ALTER TABLE TBLVPEMPRESA ADD VLPCTFRETE DECIMAL(15,0);
GO

ALTER TABLE TBLVPTIPOFRETE ADD FLSEMFRETE CHAR(1);
GO

--VERSAO 6.061

--VERSAO 6.062

ALTER TABLE TBLVPICMSCLIENTE ADD CDCONFIGICMSESPECIAL VARCHAR(20) DEFAULT '0' NOT NULL;
GO
ALTER TABLE TBLVPICMSCLIENTE DROP CONSTRAINT PK_TBLVPICMSCLIENTE;
GO

--ORACLE
DROP INDEX PK_TBLVPICMSCLIENTE;
--/ORACLE

ALTER TABLE TBLVPICMSCLIENTE ADD CONSTRAINT PK_TBLVPICMSCLIENTE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDRAMOATIVIDADE, CDUF, FLCONTRIBUINTE, FLCONSUMIDORFINAL, CDUSUARIO, CDCONFIGICMSESPECIAL);
GO

--VERSAO 6.063

--VERSAO 6.064

--VERSAO 6.065

/*-------------------------------------------------------------------------
	LAV-17349
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTO ADD VLLARGURAMIN DECIMAL(16,7) NULL;
GO

ALTER TABLE TBLVPPRODUTO ADD VLLARGURAMAX DECIMAL(16,7) NULL;
GO

ALTER TABLE TBLVPPRODUTO ADD VLCOMPRIMENTOMIN DECIMAL(16,7) NULL;
GO

ALTER TABLE TBLVPPRODUTO ADD VLCOMPRIMENTOMAX DECIMAL(16,7) NULL;
GO

ALTER TABLE TBLVPGRUPOPRODUTO1 ADD FLVALIDAINFOCOMPPRODUTO VARCHAR(1) NULL;
GO

ALTER TABLE TBLVPPAGAMENTOPEDIDO ADD CDVENCIMENTOADICBOLETO VARCHAR(20);
GO

ALTER TABLE TBLVPCLIENTE ADD CDVENCIMENTOADICBOLETO VARCHAR(20);
GO

ALTER TABLE TBLVPTIPOPAGAMENTO ADD FLPERMITEUSOMODULOPAGAMENTO CHAR(1);
GO

/*------------------------------------------------------------------------
NOVAS TABELAS
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPVENCIMENTOADICBOLETO (
	CDEMPRESA       			VARCHAR(20)     NOT NULL,
    CDREPRESENTANTE 			VARCHAR(20)		NOT NULL,
    CDVENCIMENTOADICBOLETO      VARCHAR(20)     NOT NULL,
	DSVENCIMENTOADICBOLETO      VARCHAR(100)    NULL,
    NUMAXVENCIMENTOS   			DECIMAL(9,0)    NULL,
    NUINTERVALOVENCIMENTOS  	DECIMAL(9,0)    NULL,
    CDUSUARIO					VARCHAR(8)		NOT NULL,
	NUCARIMBO					DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO				CHAR(1)			NULL,
	DTALTERACAO					DATETIME		NULL,
	HRALTERACAO					VARCHAR(8)		NULL,
    CONSTRAINT PK_TBLVPVENCIMENTOADICBOLETO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDVENCIMENTOADICBOLETO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPVENCTOPAGAMENTOPEDIDO (
	CDEMPRESA       			VARCHAR(20)     NOT NULL,
    CDREPRESENTANTE 			VARCHAR(20)		NOT NULL,
    NUPEDIDO      				VARCHAR(30)     NOT NULL,
    FLORIGEMPEDIDO  		    CHAR(1)			NOT NULL,
    CDPAGAMENTOPEDIDO 		    VARCHAR(20)     NOT NULL,
	NUSEQVENCTOPAGAMENTOPEDIDO  DECIMAL(9,0)    NOT NULL,
    DTVENCIMENTO				DATETIME    	NULL,
	VLBOLETO					DECIMAL(16,7)   NULL,
	CDUSUARIO					VARCHAR(8)		NOT NULL,
	NUCARIMBO					DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO				CHAR(1)			NULL,
	DTALTERACAO					DATETIME		NULL,
	HRALTERACAO					VARCHAR(8)		NULL,
    CONSTRAINT PK_TBLVPVENCTOPAGAMENTOPEDIDO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, NUPEDIDO, FLORIGEMPEDIDO, CDPAGAMENTOPEDIDO, NUSEQVENCTOPAGAMENTOPEDIDO, CDUSUARIO)
)
GO

--VERSAO 6.066

--VERSAO 6.067

--VERSAO 6.068

--VERSAO 6.069

CREATE TABLE TBLVPREAGENDAAGENDAVISITA (
	CDEMPRESA VARCHAR(20) NOT NULL,
	CDREPRESENTANTE VARCHAR(20) NOT NULL,
	CDCLIENTE VARCHAR(20) NOT NULL,
	NUDIASEMANA DECIMAL(9) NOT NULL,
	FLSEMANAMES VARCHAR(1) NOT NULL,
	DTAGENDAORIGINAL DATETIME NOT NULL,
	HRAGENDAORIGINAL VARCHAR(5),
	DTREAGENDAMENTO DATETIME,
	CDMOTIVOREAGENDAMENTO VARCHAR(20) ,
	DSOBSERVACAO VARCHAR(100),
	CDUSUARIO VARCHAR(8) NOT NULL,
	NUCARIMBO DECIMAL(9,0) NULL,
	FLTIPOALTERACAO	CHAR(1)	NULL,
	DTALTERACAO	DATETIME NULL,
	HRALTERACAO	VARCHAR(8) NULL,
	CONSTRAINT PK_REAGENDAAGENDAVISITA PRIMARY KEY (CDEMPRESA,CDREPRESENTANTE,CDCLIENTE,NUDIASEMANA,FLSEMANAMES,DTAGENDAORIGINAL,CDUSUARIO)
);

ALTER TABLE TBLVPMARCADOR ADD CDCORFONTE DECIMAL(9,0) NULL;
GO
ALTER TABLE TBLVPPRODUTOFALTA ADD NUPEDIDO VARCHAR(30);
GO
ALTER TABLE TBLVPPRODUTOFALTA ADD DTENTREGAPEDIDO DATETIME;
GO

--VERSAO 6.070

--VERSAO 6.071

--VERSAO 6.072

--VERSAO 6.073

/*------------------------------------------------------------------------
NOVA COLUNA
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPAGAMENTO ADD VLADICIONALPAGO DECIMAL(16,7);
GO

--VERSAO 6.074

--VERSAO 6.075

--VERSAO 6.076

--VERSAO 6.077

--VERSAO 6.078

--VERSAO 6.079

--VERSAO 6.080

--VERSAO 6.081

/*------------------------------------------------------------------------
NOVA COLUNA
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPEDIDO ADD DTULTIMORECALCULOVALORES DATETIME;
GO

ALTER TABLE TBLVPPEDIDOERP ADD DTULTIMORECALCULOVALORES DATETIME;
GO

ALTER TABLE TBLVPITEMPEDIDO ADD FLERRORECALCULO CHAR(1);
GO

ALTER TABLE TBLVPSTATUSPEDIDOPDA ADD FLCONSIDERAVOLUMEVENDAMENSAL CHAR(1);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLTOTALFECOPITEM DECIMAL(16,9);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLTOTALFECOPITEM DECIMAL(16,9);
GO

/*------------------------------------------------------------------------
Descrição: Nova coluna
Data: 25/03/2019
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMTABELAPRECO ADD QTMINIMAVENDA DECIMAL(16,7);
GO

--VERSAO 6.082

--VERSAO 6.084

/*------------------------------------------------------------------------
Descrição: Novos campos
Data: 25/02/2019
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCLIENTE ADD DTATUALIZACAOCADASTROWMW DATETIME;
GO

ALTER TABLE TBLVPCLIENTE ADD FLATUALIZACADASTROWMW CHAR(1);
GO

ALTER TABLE TBLVPCLIENTEATUA ADD FLATUALIZACADASTROWMW CHAR(1);
GO

--VERSAO 6.085

--VERSAO 6.086

--VERSAO 6.087

/*-------------------------------------------------------------------------
NOVAS COLUNAS
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPCLIENTE ADD DTFUNDACAO DATETIME;
GO

ALTER TABLE TBLVPCONDICAOPAGAMENTO ADD FLABERTURA VARCHAR(1);
GO

ALTER TABLE TBLVPCONDICAOPAGAMENTO ADD FLFUNDACAO VARCHAR(1);
GO

--VERSAO 6.088

--VERSAO 6.089

--VERSAO 6.090

--VERSAO 6.091

--VERSAO 6.092

/*-------------------------------------------------------------------------
Descrição: Nova tabela
Data: 21/03/2019
Autor: Renan
------------------------------------------------------------------------*/
CREATE TABLE TBLVPTABPRECTIPOPEDIDO (
	CDEMPRESA 		VARCHAR(20) NOT NULL,
	CDREPRESENTANTE VARCHAR(20) NOT NULL,
	CDTABELAPRECO 	VARCHAR(30) NOT NULL,
	CDTIPOPEDIDO 	VARCHAR(20) NOT NULL,
	CDUSUARIO 		VARCHAR(8)  NOT NULL,
    NUCARIMBO		DECIMAL(9,0),
	FLTIPOALTERACAO CHAR(1),
	DTALTERACAO 	DATETIME,
	HRALTERACAO 	VARCHAR(8),
	CONSTRAINT PK_TBLVPTABPRECTIPOPEDIDO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDTABELAPRECO, CDTIPOPEDIDO, CDUSUARIO)
);
GO

/*-------------------------------------------------------------------------
Descrição: Nova coluna
Data: 22/03/2019
Autor: Renan
------------------------------------------------------------------------*/
ALTER TABLE TBLVPTIPOPEDIDO ADD FLEXCECAOTABPRECO CHAR(1);
GO

/*-------------------------------------------------------------------------
Descrição: Nova coluna
Data: 26/03/2018
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPTIPOFRETETABPRECO ADD VLFRETE DECIMAL(16,7);
GO

ALTER TABLE TBLVPTIPOFRETETABPRECO ADD CDUNIDADE VARCHAR(20);
GO

/*-------------------------------------------------------------------------
Descrição: Alteração chave primária TBLVPTIPOFRETETABPRECO
Data: 27/03/2018
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPTIPOFRETETABPRECO DROP CONSTRAINT PK_TBLVPTIPOFRETETABPRECO;
GO

UPDATE TBLVPTIPOFRETETABPRECO SET CDUNIDADE = '0' WHERE CDUNIDADE IS NULL;

--SQLSERVER
ALTER TABLE TBLVPTIPOFRETETABPRECO ALTER COLUMN CDUNIDADE VARCHAR(20) NOT NULL;
GO
--/SQLSERVER

--ORACLE
DROP INDEX PK_TBLVPTIPOFRETETABPRECO;
/

ALTER TABLE TBLVPTIPOFRETETABPRECO MODIFY CDUNIDADE VARCHAR(20) NOT NULL;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPTIPOFRETETABPRECO ALTER COLUMN CDUNIDADE SET NOT NULL;
--/POSTGRES

ALTER TABLE TBLVPTIPOFRETETABPRECO ADD CONSTRAINT PK_TBLVPTIPOFRETETABPRECO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDTIPOFRETE, CDTABELAPRECO, CDPRODUTO, QTPESO, CDUNIDADE, CDUSUARIO);
GO


/*------------------------------------------------------------------------
Descrição: Novas colunas
Data: 04/04/2019
Autor: Renan
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMTABELAPRECO ADD CDPRAZOINI DECIMAL(9,0);
GO

ALTER TABLE TBLVPITEMTABELAPRECO ADD CDPRAZOFIM DECIMAL(9,0);
GO

ALTER TABLE TBLVPITEMTABELAPRECO ADD VLUNITPRAZOINI DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMTABELAPRECO ADD VLUNITPRAZOFIM DECIMAL(16,7);
GO

/*------------------------------------------------------------------------
LAV-18637 IntegralAgro - Avisar cliente de Rede com títulos em atraso
Data: 29/03/2019
Autor: Raphael Santos
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPREDECLIENTE (
    CDCLIENTE		 			VARCHAR(20)		NOT NULL,
    CDREDE			 			VARCHAR(20)		NOT NULL,
    NMRAZAOSOCIAL	 			VARCHAR(100)	NULL,
    NMFANTASIA		 			VARCHAR(100)	NULL,
    DSBAIRROCOMERCIAL    	 	VARCHAR(100)    NULL,
    DSCIDADECOMERCIAL  		    VARCHAR(100)    NULL,
    DSESTADOCOMERCIAL  	 		VARCHAR(20)     NULL,
    FLSTATUSCLIENTE  		    CHAR(1)			NOT NULL,
	VLMAXTITULOSATRASO			DECIMAL(16,7)   NULL,
	NUDIASTOLERANCIAATRASO	  	DECIMAL(9,0)    NULL,
	CDUSUARIO					VARCHAR(8)		NOT NULL,
	NUCARIMBO					DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO				CHAR(1)			NULL,
	DTALTERACAO					DATETIME		NULL,
	HRALTERACAO					VARCHAR(8)		NULL,
    CONSTRAINT PK_TBLVPREDECLIENTE PRIMARY KEY (CDCLIENTE, CDUSUARIO)
)
GO

CREATE TABLE TBLVPREDECLIENTETITULO (
   CDCLIENTE            VARCHAR(20)          NOT NULL,
   NUNF                 VARCHAR(15)          NOT NULL,
   NUSERIE              VARCHAR(15)          NOT NULL,
   NUTITULO             VARCHAR(15)          NOT NULL,
   NUSUBDOC             VARCHAR(15)          NOT NULL,
   VLNF                 DECIMAL(16,7)        NULL,
   VLTITULO             DECIMAL(16,7)        NULL,
   VLPAGO               DECIMAL(16,7)        NULL,
   DTEMISSAO            DATETIME             NULL,
   DTVENCIMENTO         DATETIME             NULL,
   DSHISTORICO          VARCHAR(300)         NULL,
   DSOBSERVACAO         VARCHAR(120)         NULL,
   DSTIPODOCUMENTO      VARCHAR(20)          NULL,
   DSPORTADOR      	    VARCHAR(20)          NULL,
   DSSTATUS      	    VARCHAR(30)          NULL,
   CDREPRESENTANTETITULO VARCHAR(20)         NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPPREDECLIENTETITULO PRIMARY KEY (CDCLIENTE, NUNF, NUSERIE, NUTITULO, NUSUBDOC, CDUSUARIO)
)
GO

--VERSAO 6.093

--VERSAO 6.094

--VERSAO 6.095

--VERSAO 6.096

--VERSAO 6.097

--VERSAO 6.098

--VERSAO 6.099

/*------------------------------------------------------------------------
 Novas colunas
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTO ADD FLPRODUTORESTRITO CHAR(1);
GO
ALTER TABLE TBLVPCLIENTE ADD FLDESCPRODUTORESTRITO CHAR(1);
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLPCTDESCPRODUTORESTRITO DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTDESCPRODUTORESTRITO DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTDESCPRODUTORESTRITO DECIMAL(16,7);
GO

ALTER TABLE TBLVPCLIENTE ADD VLPCTVPC DECIMAL(16,9);
GO
ALTER TABLE TBLVPPEDIDO ADD VLPCTVPC DECIMAL(16,9);
GO
ALTER TABLE TBLVPPEDIDOERP ADD VLPCTVPC DECIMAL(16,9);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLVPC DECIMAL(16,9);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLVPC DECIMAL(16,9);
GO

ALTER TABLE TBLVPPRODUTO add VLPCTVARIACAOCOMISSAO decimal(16,9);
GO

ALTER TABLE TBLVPPRODUTOGRADE ADD FLINFOCOMPLVOLUME CHAR(1);
GO
ALTER TABLE TBLVPPRODUTOGRADE ADD VLALTURAMIN DECIMAL(16,7);
GO
ALTER TABLE TBLVPPRODUTOGRADE ADD VLALTURAMAX DECIMAL(16,7);
GO
ALTER TABLE TBLVPPRODUTOGRADE ADD VLLARGURAMIN DECIMAL(16,7);
GO
ALTER TABLE TBLVPPRODUTOGRADE ADD VLLARGURAMAX DECIMAL(16,7);
GO
ALTER TABLE TBLVPPRODUTOGRADE ADD VLCOMPRIMENTOMIN DECIMAL(16,7);
GO
ALTER TABLE TBLVPPRODUTOGRADE ADD VLCOMPRIMENTOMAX DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLINDICEVOLUME DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLINDICEVOLUME DECIMAL(16,7);
GO

--VERSAO 6.100

ALTER TABLE TBLVPGRUPODESCPROD DROP CONSTRAINT PK_TBLVPGRUPODESCPROD;
GO

--POSTGRES
ALTER TABLE TBLVPGRUPODESCPROD ALTER COLUMN CDUSUARIO TYPE VARCHAR(8);
ALTER TABLE TBLVPGRUPODESCPROD ALTER COLUMN CDUSUARIO SET NOT NULL;
ALTER TABLE TBLVPGRUPODESCPROD alter COLUMN CDUSUARIO SET DEFAULT '0';
--/POSTGRES

--ORACLE
DROP INDEX PK_TBLVPGRUPODESCPROD;
/
ALTER TABLE TBLVPGRUPODESCPROD MODIFY CDUSUARIO VARCHAR(8) DEFAULT '0' NOT NULL;
/
--/ORACLE

--SQLSERVER
ALTER TABLE TBLVPGRUPODESCPROD ALTER COLUMN CDUSUARIO VARCHAR(8) NOT NULL;
GO
ALTER TABLE TBLVPGRUPODESCPROD ADD DEFAULT '0' FOR CDUSUARIO;
GO
--/SQLSERVER

ALTER TABLE TBLVPGRUPODESCPROD ADD CONSTRAINT PK_TBLVPGRUPODESCPROD PRIMARY KEY (CDEMPRESA, CDGRUPODESCPROD, CDUSUARIO);
GO

--VERSAO 6.101

--VERSAO 6.102

/*------------------------------------------------------------------------
Data: 18/03/2019
Descrição: Novas colunas
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLPCTDIRETORIA DECIMAL(16,7);
GO

ALTER TABLE TBLVPEMPRESA ADD VLPCTCOMISSAO DECIMAL(16,7);
GO

ALTER TABLE TBLVPPRODUTOCLIENTE ADD VLPCTFIDELIDADE DECIMAL(16,7);
GO

ALTER TABLE TBLVPCLIENTE ADD VLPCTROYALT DECIMAL(16,7);
GO

ALTER TABLE TBLVPCONDICAOPAGAMENTO ADD VLPCTCUSTOFINANCEIRO DECIMAL(16,7);
GO


/*------------------------------------------------------------------------
Data: 13/03/2019
Descrição: Novas Colunas
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD VLRETORNOPRODUTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPPRODUTOCLIENTE ADD VLRETORNOPRODUTO DECIMAL(16,7);
GO

/*------------------------------------------------------------------------
Data: 13/03/2019
Descrição: Alteração PK TBLVPCLIENTEPRODUTO
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTOCLIENTE DROP CONSTRAINT PK_TBLVPPRODUTOCLIENTE;
GO

--SQLSERVER
ALTER TABLE TBLVPPRODUTOCLIENTE ALTER COLUMN FLTIPORELACAO CHAR(1);
GO
--/SQLSERVER

--POSTGRES
ALTER TABLE TBLVPPRODUTOCLIENTE ALTER COLUMN FLTIPORELACAO TYPE CHAR(1);
ALTER TABLE TBLVPPRODUTOCLIENTE ALTER COLUMN FLTIPORELACAO DROP NOT NULL;

GO
--/POSTGRES

--ORACLE
DROP INDEX PK_TBLVPPRODUTOCLIENTE;

ALTER TABLE TBLVPPRODUTOCLIENTE MODIFY FLTIPORELACAO CHAR(1) NULL;
GO
--/ORACLE

ALTER TABLE TBLVPPRODUTOCLIENTE ADD CONSTRAINT PK_TBLVPPRODUTOCLIENTE PRIMARY KEY (CDEMPRESA,CDREPRESENTANTE,CDCLIENTE,CDPRODUTO);
GO

--VERSAO 6.103

--VERSAO 6.104

--VERSAO 6.105

ALTER TABLE TBLVPITEMPEDIDOERPDIF ADD CDUNIDADE VARCHAR(20);
GO
ALTER TABLE TBLVPPRODUTO ADD QTTOLERANCIAMINDIFPU DECIMAL(16,7);
GO
ALTER TABLE TBLVPPRODUTO ADD QTTOLERANCIAMAXDIFPU DECIMAL(16,7);
GO
ALTER TABLE TBLVPPERIODOENTREGA ADD FLRESTRITO CHAR(1);
GO
ALTER TABLE TBLVPREAGENDAAGENDAVISITA DROP CONSTRAINT PK_REAGENDAAGENDAVISITA;
GO

--SQLSERVER
ALTER TABLE TBLVPREAGENDAAGENDAVISITA ALTER COLUMN NUDIASEMANA DECIMAL(9) NOT NULL;
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPREAGENDAAGENDAVISITA MODIFY NUDIASEMANA DECIMAL(9);
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPREAGENDAAGENDAVISITA ALTER COLUMN NUDIASEMANA type DECIMAL(9);
--/POSTGRES

ALTER TABLE TBLVPREAGENDAAGENDAVISITA ADD CONSTRAINT PK_REAGENDAAGENDAVISITA PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, NUDIASEMANA, FLSEMANAMES, DTAGENDAORIGINAL, CDUSUARIO);
GO

--VERSAO 6.106


--VERSAO 6.107

/*------------------------------------------------------------------------
Data: 03/05/2019
DescriÃ§Ã£o: AlteraÃ§Ã£o PK TBLVPCLIENTEPRODUTO
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTOCLIENTE DROP CONSTRAINT PK_TBLVPPRODUTOCLIENTE;
GO

--SQLSERVER
ALTER TABLE TBLVPPRODUTOCLIENTE ALTER COLUMN FLTIPORELACAO CHAR(1) NOT NULL;
GO
--/SQLSERVER

--POSTGRES
ALTER TABLE TBLVPPRODUTOCLIENTE ALTER COLUMN FLTIPORELACAO TYPE CHAR(1);
ALTER TABLE TBLVPPRODUTOCLIENTE ALTER COLUMN FLTIPORELACAO SET NOT NULL;

GO
--/POSTGRES

--ORACLE
DROP INDEX PK_TBLVPPRODUTOCLIENTE;
ALTER TABLE TBLVPPRODUTOCLIENTE MODIFY FLTIPORELACAO CHAR(1) NOT NULL;
GO
--/ORACLE

ALTER TABLE TBLVPPRODUTOCLIENTE ADD CONSTRAINT PK_TBLVPPRODUTOCLIENTE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, CDPRODUTO, FLTIPORELACAO, CDUSUARIO);
GO

--VERSAO 6.108

ALTER TABLE TBLVPPEDIDO ADD NULOTEPROTOCOLO VARCHAR(20);
ALTER TABLE TBLVPPEDIDOERP ADD NULOTEPROTOCOLO VARCHAR(20);

ALTER TABLE TBLVPPEDIDO ADD FLENVIADOPROTOCOLO VARCHAR(1);
ALTER TABLE TBLVPPEDIDOERP ADD FLENVIADOPROTOCOLO VARCHAR(1);

--VERSAO 6.109

--VERSAO 6.110


--VERSAO 6.111

/*-------------------------------------------------------------------------
Descrição: Nova coluna
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPRODUTO ADD NUFRACAOFORNECEDOR DECIMAL(9) NULL;
GO

/*-------------------------------------------------------------------------
Descrição: Novas tabelas
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPNOTACREDITO (
  CDEMPRESA VARCHAR(20) NOT NULL,
  CDREPRESENTANTE VARCHAR(20) NOT NULL,
  CDNOTACREDITO VARCHAR(20) NOT NULL,
  CDCLIENTE VARCHAR(20) NULL,
  VLNOTACREDITO DECIMAL(16,7) NULL,
  FLUTILIZADA CHAR(1) NULL,
  CDUSUARIO VARCHAR(8) NOT NULL,
  NUCARIMBO DECIMAL(9,0) NULL,
  FLTIPOALTERACAO CHAR(1) NULL,
  DTALTERACAO DATETIME NULL,
  HRALTERACAO VARCHAR(8) NULL,
  CONSTRAINT PK_TBLVPNOTACREDITO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDNOTACREDITO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPNOTACREDITOPEDIDO (
  CDEMPRESA VARCHAR(20) NOT NULL,
  CDREPRESENTANTE VARCHAR(20) NOT NULL,
  FLORIGEMPEDIDO CHAR(1) NOT NULL,
  NUPEDIDO VARCHAR(30) NOT NULL,
  CDNOTACREDITO VARCHAR(20) NOT NULL,
  CDUSUARIO VARCHAR(8) NOT NULL,
  NUCARIMBO DECIMAL(9,0) NULL,
  FLTIPOALTERACAO CHAR(1) NULL,
  DTALTERACAO DATETIME NULL,
  HRALTERACAO VARCHAR(8) NULL,
  CONSTRAINT PK_TBLVPNOTACREDITOPEDIDO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, FLORIGEMPEDIDO, NUPEDIDO, CDNOTACREDITO, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Descrição: Alterações tabelas
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD VLTOTALNOTACREDITO DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDOERP ADD VLTOTALNOTACREDITO DECIMAL(16,7);
GO

ALTER TABLE TBLVPFECHAMENTODIARIO ADD VLTOTALCREDITOCLIENTE DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDO ADD VLDESCONTOINDICEFINANCEIROCLIENTE DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDOERP ADD VLDESCONTOINDICEFINANCEIROCLIENTE DECIMAL(16,7);
GO

ALTER TABLE TBLVPFECHAMENTODIARIO ADD VLTOTALDESCONTO DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
Descrição: Nova Tabela GRUPODESCCLI
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPGRUPODESCCLI (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
   CDGRUPODESCCLI       VARCHAR(20)          NOT NULL,
   CDCLIENTE            VARCHAR(20)          NOT NULL,
   NUPRIORIDADE         DECIMAL(9,0)         NULL,
   DSGRUPODESCCLI       VARCHAR(100)         NULL,
   FLATIVO              CHAR(1)              NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CDUSUARIO		    VARCHAR(8)		     NOT NULL,
   NUCARIMBO		    DECIMAL(9,0)		 NULL,
   CONSTRAINT PK_TBLVPGRUPODESCCLI PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDGRUPODESCCLI, CDCLIENTE, CDUSUARIO)
)
GO


/*------------------------------------------------------------------------
Descrição: Alterações GRUPODESCPROD
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPGRUPODESCPROD ADD CDPRODUTO VARCHAR(20) DEFAULT '0' NOT NULL;
GO

ALTER TABLE TBLVPGRUPODESCPROD ADD CDREPRESENTANTE VARCHAR(20) DEFAULT '0' NOT NULL;
GO

ALTER TABLE TBLVPGRUPODESCPROD DROP CONSTRAINT PK_TBLVPGRUPODESCPROD;
GO

--ORACLE
DROP INDEX PK_TBLVPGRUPODESCPROD;
--/ORACLE

ALTER TABLE TBLVPGRUPODESCPROD ADD CONSTRAINT PK_TBLVPGRUPODESCPROD PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDGRUPODESCPROD, CDPRODUTO, CDUSUARIO);
GO

ALTER TABLE TBLVPGRUPODESCPROD ADD NUPRIORIDADE DECIMAL(9,0);
GO

/*------------------------------------------------------------------------
Descrição: Alterações DESCPROMOCIONAL
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPDESCPROMOCIONAL ADD CDTIPOPEDIDO VARCHAR(20) DEFAULT '0' NOT NULL;
GO

ALTER TABLE TBLVPDESCPROMOCIONAL DROP CONSTRAINT PK_TBLVPDESCPROMOCIONAL;
GO

--ORACLE
DROP INDEX PK_TBLVPDESCPROMOCIONAL;
--/ORACLE

ALTER TABLE TBLVPDESCPROMOCIONAL ADD CONSTRAINT PK_TBLVPDESCPROMOCIONAL PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDCLIENTE, CDGRUPODESCCLI, CDGRUPODESCPROD, CDCONDICAOCOMERCIAL, CDTABELAPRECO, QTITEM, NUPROMOCAO, CDLOCAL, CDUSUARIO, CDTIPOPEDIDO);
GO

/*------------------------------------------------------------------------
Descrição: Alterações ITEMPEDIDO
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMPEDIDO ADD CDGRUPODESCPROD VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD CDGRUPODESCCLI VARCHAR(20);
GO

/*------------------------------------------------------------------------
Descrição: Alterações ITEMPEDIDOERP
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMPEDIDOERP ADD CDGRUPODESCPROD VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD CDGRUPODESCCLI VARCHAR(20);
GO

/*------------------------------------------------------------------------
Descrição: Novas colunas na entidade pedido e pedidoERP
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPEDIDO ADD DSMOTIVOCANCLIMCREDITO VARCHAR(500);
GO

ALTER TABLE TBLVPPEDIDO ADD FLPENDENTELIMCRED CHAR(1);
GO

ALTER TABLE TBLVPPEDIDO ADD CDUSUARIOCANCLIMCRED VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDO ADD CDUSUARIOLIBERACAOLIMCRED VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDOERP ADD DSMOTIVOCANCLIMCREDITO VARCHAR(500);
GO

ALTER TABLE TBLVPPEDIDOERP ADD FLPENDENTELIMCRED CHAR(1);
GO

ALTER TABLE TBLVPPEDIDOERP ADD CDUSUARIOCANCLIMCRED VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDOERP ADD CDUSUARIOLIBERACAOLIMCRED VARCHAR(20);
GO


/*------------------------------------------------------------------------
Descrição: Novas colunas
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTDESCONTOAUTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTDESCONTOEFETIVO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLDESCONTOAUTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLTOTALDESCONTOAUTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTDESCONTOAUTOEFETIVO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLPRECOEFETIVOUNITARIO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLPRECOEFETIVOUNITARIODESC DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLEFETIVOTOTALITEM DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLEFETIVOTOTALITEMDESC DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLDESCONTOTOTALAUTODESC DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLBASEINTERPOLACAOPRODUTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDO ADD VLPCTDESCONTOAUTOEFETIVO DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDO ADD VLDESCONTOTOTALAUTODESC DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDO ADD VLTOTALDESCONTOAUTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTDESCONTOAUTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTDESCONTOEFETIVO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLDESCONTOAUTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLTOTALDESCONTOAUTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTDESCONTOAUTOEFETIVO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPRECOEFETIVOUNITARIO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPRECOEFETIVOUNITARIODESC DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLEFETIVOTOTALITEM DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLEFETIVOTOTALITEMDESC DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLDESCONTOTOTALAUTODESC DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLBASEINTERPOLACAOPRODUTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDOERP ADD VLPCTDESCONTOAUTOEFETIVO DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDOERP ADD VLDESCONTOTOTALAUTODESC DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDOERP ADD VLTOTALDESCONTOAUTO DECIMAL(16,7);
GO

--VERSAO 6.113

ALTER TABLE TBLVPPRODUTOCLIENTE ADD VLPCTROYALT DECIMAL(16,7);
GO
ALTER TABLE TBLVPCLIENTE DROP COLUMN VLPCTROYALT;
GO

/*-------------------------------------------------------------------------
Descrição: Correção de nome de coluna
-------------------------------------------------------------------------*/
--SQLSERVER
EXEC SP_RENAME 'TBLVPPEDIDO.VLDESCONTOINDICEFINANCEIROCLIENTE', 'VLDESCONTOINDICEFINANCLIENTE', 'COLUMN';
EXEC SP_RENAME 'TBLVPPEDIDOERP.VLDESCONTOINDICEFINANCEIROCLIENTE', 'VLDESCONTOINDICEFINANCLIENTE', 'COLUMN';
--/SQLSERVER

--ORACLE
DECLARE
 col_count  integer;
BEGIN
 SELECT count(*)
   into col_count
 FROM user_tab_columns
 WHERE table_name = 'TBLVPPEDIDO'
 AND column_name = 'VLDESCONTOINDICEFINANCEIROCLIENTE';

 IF col_count = 0 THEN
    EXECUTE IMMEDIATE 'ALTER TABLE TBLVPPEDIDO ADD VLDESCONTOINDICEFINANCLIENTE number(16,7)';
    EXECUTE IMMEDIATE 'ALTER TABLE TBLVPPEDIDOERP ADD VLDESCONTOINDICEFINANCLIENTE number(16,7)';
    ELSE
    	EXECUTE IMMEDIATE 'ALTER TABLE TBLVPPEDIDO RENAME COLUMN VLDESCONTOINDICEFINANCEIROCLIENTE to VLDESCONTOINDICEFINANCLIENTE';
		EXECUTE IMMEDIATE 'ALTER TABLE TBLVPPEDIDOERP RENAME COLUMN VLDESCONTOINDICEFINANCEIROCLIENTE to VLDESCONTOINDICEFINANCLIENTE';
 END IF;
END;


--/ORACLE

--POSTGRES
ALTER TABLE TBLVPPEDIDO RENAME COLUMN VLDESCONTOINDICEFINANCEIROCLIENTE to VLDESCONTOINDICEFINANCLIENTE;
ALTER TABLE TBLVPPEDIDOERP RENAME COLUMN VLDESCONTOINDICEFINANCEIROCLIENTE to VLDESCONTOINDICEFINANCLIENTE;
--/POSTGRES


--VERSAO 6.114

/*-------------------------------------------------------------------------
Descrição: Corrigir coluna DTFUNDACAO
Data: 22/05/2019
Autor: Anderson
------------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DTFUNDACAO DATETIME;
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPCLIENTE MODIFY DTFUNDACAO DATETIME;
GO
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DTFUNDACAO TYPE DATETIME;
GO
--/POSTGRES

--VERSAO 6.115

ALTER TABLE TBLVPUNIDADE ADD FLCALCULAPRECOMETROQUADRADO CHAR(1);
GO

/*------------------------------------------------------------------------
NOVA COLUNA
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTO ADD CDUNIDADEPREFERENCIAL VARCHAR(20);

--VERSAO 6.116

--VERSAO 6.117

--VERSAO 6.118

--VERSAO 6.119


/*------------------------------------------------------------------------
Descrição: Nova coluna na tabela tipoPedido
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPTIPOPEDIDO ADD FLIGNORACALCULOFRETE CHAR(1);
GO


/*------------------------------------------------------------------------
Descrição: Nova coluna na USUARIODESC para controlar o limite de descontos por usuario
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPUSUARIODESC ADD VLPCTMAXDESCUSU DECIMAL(16,7);
GO

--VERSAO 6.120

--VERSAO 6.121

/*-------------------------------------------------------------------------
Descrição: Alteração de coluna
------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMTABELAPRECO DROP COLUMN VLPCTDESCPRODUTORESTRITO;
GO
ALTER TABLE TBLVPCLIENTE ADD VLPCTDESCPRODUTORESTRITO DECIMAL(16,7);
GO
ALTER TABLE TBLVPCLIENTE DROP COLUMN FLDESCPRODUTORESTRITO;
GO
ALTER TABLE TBLVPCLIENTE ADD FLPERMITEPRODUTORESTRITO CHAR(1);
GO

--VERSAO 6.122

--VERSAO 6.123

--VERSAO 6.124

--VERSAO 6.125

--VERSAO 6.126

--VERSAO 6.127

--VERSAO 6.128

/*-------------------------------------------------------------------------
Descrição: Nova coluna
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPREPRESENTANTE ADD CDREPRESENTANTEERP VARCHAR(20);
GO
ALTER TABLE TBLVPFECHAMENTODIARIO ADD FLLIBERADOSENHA CHAR(1);
GO
ALTER TABLE TBLVPFECHAMENTODIARIO ADD FLAGRUPADO CHAR(1);
GO

--VERSAO 6.129

--VERSAO 6.130

--VERSAO 6.131

--VERSAO 6.132

--VERSAO 6.133

ALTER TABLE TBLVPINDICADOR ADD DSMASCARAFORMATO VARCHAR(50);
GO

/*-------------------------------------------------------------------------
Descrição: Alteração de coluna
------------------------------------------------------------------------*/
ALTER TABLE TBLVPUSUARIOCONFIGEMP ADD VLPCTALCADALIBLIMITECREDITO DECIMAL(16,7);
GO
ALTER TABLE TBLVPUSUARIORELREP ADD VLPCTALCADALIBLIMITECREDITO DECIMAL(16,7);
GO

--VERSAO 6.134

--VERSAO 6.135

ALTER TABLE TBLVPCLIENTE ADD DTABERTURA DATETIME;
GO

--VERSAO 6.136


--VERSAO 6.137

CREATE TABLE TBLVPFUNCAOCONFIG (
   CDFUNCAO			VARCHAR(20)		NOT NULL,
   VLMINPEDIDO		DECIMAL(16,7)		NULL,
   CDUSUARIO		VARCHAR(8)		NOT NULL,
   NUCARIMBO		DECIMAL(9,0)		NULL,
   FLTIPOALTERACAO	CHAR(1)				NULL,
   DTALTERACAO		DATETIME			NULL,
   HRALTERACAO		VARCHAR(8)			NULL,
   CONSTRAINT PK_TBLVPFUNCAOCONFIG PRIMARY KEY(CDFUNCAO, CDUSUARIO)
);
GO


CREATE TABLE TBLVPGRUPOCLIENTE (
   CDGRUPOCLIENTE       VARCHAR(20)    NOT NULL,
   DSGRUPOCLIENTE       VARCHAR(100)	   NULL,
   FLTIPOCADASTRO       CHAR(1)			   NULL,
   FLRESTRINGECONDPAGTO CHAR(1)			   NULL,
   VLMINPEDIDO			DECIMAL(16,7)	   NULL,
   FLTIPOALTERACAO      CHAR(1)			   NULL,
   NUCARIMBO			DECIMAL(9,0)	   NULL,
   CDUSUARIO            VARCHAR(8)     NOT NULL,
   DTALTERACAO          DATETIME		   NULL,
   HRALTERACAO          VARCHAR(8)		   NULL,
   CONSTRAINT PK_TBLVPGRUPOCLIENTE PRIMARY KEY (CDGRUPOCLIENTE, CDUSUARIO)
)
GO

ALTER TABLE TBLVPCLIENTE ADD CDGRUPOVALORMINPEDIDO VARCHAR(20);
GO


--VERSAO 6.138

/*------------------------------------------------------------------------
Descrição: Nova Coluna na tabela de desconto promocional
--------------------------------------------------*/

ALTER TABLE TBLVPDESCPROMOCIONAL ADD CDUNIDADE VARCHAR(20);
GO

--VERSAO 6.139


--VERSAO 6.140

/*-------------------------------------------------------------------------
Descrição: Nova coluna
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPRODUTOGRADE ADD QTPESO DECIMAL(16,7);
GO

--VERSAO 6.141

--VERSAO 6.142

/*-------------------------------------------------------------------------
Descrição: Nova coluna
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMPEDIDO ADD DTENTREGA DATETIME;


/*------------------------------------------------------------------------
Descrição: Nova tabela
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPFORNECEDORREP (
    CDEMPRESA       VARCHAR(20)     NOT NULL,
    CDREPRESENTANTE VARCHAR(20)     NOT NULL,
    CDFORNECEDOR    VARCHAR(20)   	NOT NULL,
    CDUSUARIO       VARCHAR(8)      NOT NULL,
    NUCARIMBO		DECIMAL(9,0)		NULL,
	FLTIPOALTERACAO	CHAR(1)			    NULL,
	DTALTERACAO     DATETIME            NULL,
   	HRALTERACAO     VARCHAR(8)          NULL,
    CONSTRAINT PK_TBLVPFORNECEDORREP PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDFORNECEDOR, CDUSUARIO)
)
GO

--VERSAO 6.143

--VERSAO 6.144

--VERSAO 6.145

--VERSAO 6.146

--VERSAO 6.147

/*----------------------------------------------------
DESCRICAO: ALTERADO COLUNA NMENTIDADE TABELA TBLVPMARCADOR
---------------------------------------------*/

--POSTGRES
ALTER TABLE TBLVPMARCADOR ALTER COLUMN NMENTIDADE TYPE VARCHAR(30);
--/POSTGRES

--SQLSERVER
ALTER TABLE TBLVPMARCADOR ALTER COLUMN NMENTIDADE VARCHAR(30);
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPMARCADOR MODIFY NMENTIDADE VARCHAR(30);
--/ORACLE

/*--------------------------------------------------------------
DESCRICAO: ALTERADO COLUNA CDTABELAPRECO TABELA TBLVPPRODUTOGRADE
----------------------------------------------------------------*/

--POSTGRES
ALTER TABLE TBLVPPRODUTOGRADE ALTER COLUMN CDTABELAPRECO TYPE VARCHAR(30);
--/POSTGRES

--SQLSERVER
ALTER TABLE TBLVPPRODUTOGRADE DROP CONSTRAINT PK_TBLVPPRODUTOGRADE;
GO
ALTER TABLE TBLVPPRODUTOGRADE ALTER COLUMN CDTABELAPRECO VARCHAR(30) NOT NULL;
GO
ALTER TABLE TBLVPPRODUTOGRADE ADD CONSTRAINT PK_TBLVPPRODUTOGRADE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDITEMGRADE1, CDITEMGRADE2, CDITEMGRADE3, CDTABELAPRECO, CDUSUARIO)
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPPRODUTOGRADE MODIFY CDTABELAPRECO VARCHAR(30);
--/ORACLE

/*----------------------------------------------------------------------------------
DESCRICAO: ALTERADO COLUNA CDTRANSPORTADORA,CDTIPOSERVICOFRETE TABELA TBLVPTRANSPCEP
------------------------------------------------------------------------------------*/

--POSTGRES
ALTER TABLE TBLVPTRANSPCEP ALTER COLUMN CDTRANSPORTADORA TYPE VARCHAR(20);
ALTER TABLE TBLVPTRANSPCEP ALTER COLUMN CDTIPOSERVICOFRETE TYPE VARCHAR(20);
GO
--/POSTGRES

--SQLSERVER
ALTER TABLE TBLVPTRANSPCEP ALTER COLUMN CDTRANSPORTADORA VARCHAR(20);
GO
ALTER TABLE TBLVPTRANSPCEP ALTER COLUMN CDTIPOSERVICOFRETE VARCHAR(20);
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPTRANSPCEP MODIFY CDTRANSPORTADORA VARCHAR(20);
ALTER TABLE TBLVPTRANSPCEP MODIFY CDTIPOSERVICOFRETE VARCHAR(20);
GO
--/ORACLE

--VERSAO 6.146

--VERSAO 6.147

--VERSAO 6.148

/*------------------------------------------------------------------------
NOVAS TABELAS
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPMOTNAOVENDAPRODUTO (
   CDMOTIVO             VARCHAR(20)          NOT NULL,
   DSMOTIVO             VARCHAR(100)         NULL,
   FLEXIGEJUSTIFICATIVA CHAR(1)              NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPMOTNAOVENDAPRODUTO PRIMARY KEY (CDMOTIVO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPNAOVENDAPRODPEDIDO (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
   NUPEDIDO             VARCHAR(30)          NOT NULL,
   FLORIGEMPEDIDO       CHAR(1)              NOT NULL,
   CDPRODUTO            VARCHAR(20)          NOT NULL,
   CDMOTIVO             VARCHAR(20)          NULL,
   DSJUSTIFICATIVA      VARCHAR(4000)        NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPNAOVENDAPRODPEDIDO PRIMARY KEY  (CDEMPRESA, CDREPRESENTANTE, NUPEDIDO, FLORIGEMPEDIDO, CDPRODUTO, CDUSUARIO)
)
GO


--VERSAO 6.149


/*-------------------------------------------------------------------------
Data: 08/07/2019
Autor: Renan
Descrição: Novo parâmetro
------------------------------------------------------------------------*/
ALTER TABLE TBLVPTIPOPEDIDO ADD FLIGNORAMULTESPECIAL CHAR(1);
GO


/*--------------------------------------------------------------
Descrição: Alterado tabela TBLVPPRODUTOGRADE e TBLVPTRANSPCEP
----------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTOGRADE DROP CONSTRAINT PK_TBLVPPRODUTOGRADE;
GO
ALTER TABLE TBLVPTRANSPCEP DROP CONSTRAINT PK_TBLVPTRANSPCEP;
GO


--POSTGRES
ALTER TABLE TBLVPPRODUTOGRADE ALTER COLUMN CDTABELAPRECO TYPE VARCHAR(30);
GO
ALTER TABLE TBLVPTRANSPCEP ALTER COLUMN CDTRANSPORTADORA TYPE VARCHAR(20);
GO
ALTER TABLE TBLVPTRANSPCEP ALTER COLUMN CDTIPOSERVICOFRETE TYPE VARCHAR(20);
GO
--/POSTGRES

--SQLSERVER
ALTER TABLE TBLVPPRODUTOGRADE ALTER COLUMN CDTABELAPRECO VARCHAR(30) NOT NULL;
GO
ALTER TABLE TBLVPTRANSPCEP ALTER COLUMN CDTRANSPORTADORA VARCHAR(20) NOT NULL;
GO
ALTER TABLE TBLVPTRANSPCEP ALTER COLUMN CDTIPOSERVICOFRETE VARCHAR(20) NOT NULL;
GO
--/SQLSERVER

--ORACLE
DROP INDEX PK_TBLVPPRODUTOGRADE;
GO
DROP INDEX PK_TBLVPTRANSPCEP;
GO
ALTER TABLE TBLVPPRODUTOGRADE MODIFY CDTABELAPRECO VARCHAR(30);
GO
ALTER TABLE TBLVPTRANSPCEP MODIFY CDTRANSPORTADORA VARCHAR(20);
GO
ALTER TABLE TBLVPTRANSPCEP MODIFY CDTIPOSERVICOFRETE VARCHAR(20);
GO
--/ORACLE


ALTER TABLE TBLVPPRODUTOGRADE ADD  CONSTRAINT PK_TBLVPPRODUTOGRADE PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDITEMGRADE1, CDITEMGRADE2, CDITEMGRADE3, CDTABELAPRECO,	CDUSUARIO);
GO
ALTER TABLE TBLVPTRANSPCEP ADD  CONSTRAINT PK_TBLVPTRANSPCEP PRIMARY KEY(CDEMPRESA, CDTRANSPORTADORA, CDTIPOSERVICOFRETE, NUFAIXACEPINICIAL, NUFAIXACEPFINAL, CDUSUARIO);
GO

--VERSAO 6.150

--VERSAO 6.151


/*-------------------------------------------------------------------------
Descrição: Nova tabela de faixa de comissão do pedido.
------------------------------------------------------------------------*/

CREATE TABLE TBLVPCOMISSAOPEDIDOREP (
    CDEMPRESA               VARCHAR(20)         NOT NULL,
    CDREPRESENTANTE         VARCHAR(20)         NOT NULL,
    CDTABELAPRECO           VARCHAR(20)         NOT NULL,
    CDCOMISSAOPEDIDOREP     DECIMAL(9)          NOT NULL,
	DSCOMISSAOPEDIDOREP		VARCHAR(100)		NOT NULL,
    VLPCTMAXCOMISSAO        DECIMAL(16,7)       NOT NULL,
	CDCORFAIXA				VARCHAR(8)			NOT NULL,
	CDUSUARIO				VARCHAR(20)			NOT NULL,
	NUCARIMBO				DECIMAL(9,0)			NULL,
	FLTIPOALTERACAO			CHAR(1)					NULL,
	DTALTERACAO				DATETIME				NULL,
	HRALTERACAO				VARCHAR(8)				NULL,
	CONSTRAINT		PK_TBLVPCOMISSAOPEDIDOREP	PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDTABELAPRECO, CDCOMISSAOPEDIDOREP, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------
Descrição: Coluna CDCOMISSAOPEDIDOREP na entidade PEDIDO e PEDIDOERP
------------------------------------------------------------------------*/

ALTER TABLE TBLVPPEDIDO ADD CDCOMISSAOPEDIDOREP VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDOERP ADD CDCOMISSAOPEDIDOREP VARCHAR(20);
GO

/*------------------------------------------------------------------------
Descrição: Coluna CDCOMISSAOPEDIDOREP na entidade ITEMPEDIDO e ITEMPEDIDOERP
------------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMPEDIDO ADD CDCOMISSAOPEDIDOREP VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD CDCOMISSAOPEDIDOREP VARCHAR(20);
GO


/*-------------------------------------------------------------------------
Descrição: Nova coluna
------------------------------------------------------------------------*/

ALTER TABLE TBLVPPESQUISAMERCADO ADD NUPEDIDO VARCHAR(30);
GO

ALTER TABLE TBLVPPESQUISAMERCADO ADD FLORIGEMPEDIDO CHAR(1);
GO

--VERSAO 6.152

/*------------------------------------------------------------------------
NOVOS CAMPOS
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTO ADD CDORIGEMMERCADORIA VARCHAR(20);
GO
ALTER TABLE TBLVPITEMNFE ADD CDORIGEMMERCADORIA VARCHAR(20);
GO
ALTER TABLE TBLVPITEMNFE ADD VLPCTREDUCAOBASEICMS DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMNFE ADD VLPCTREDUCAOICMS DECIMAL(16,7);
GO

/*------------------------------------------------------------------------
NOVOS CAMPOS LAV-21091
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPNFE ADD VLTOTALDESCONTOFIN DECIMAL(16,7);
GO
ALTER TABLE TBLVPNFE ADD DSMENSAGEMNOTACREDITO VARCHAR(200);
GO

--VERSAO 6.153

CREATE TABLE TBLVPINDICADORWMW (
   CDINDICADOR			VARCHAR(20)		NOT NULL,
   DSINDICADOR			VARCHAR(100)		NULL,
   DSVLPADRAOINDICADOR	VARCHAR(20)			NULL,
   CDTIPOAPURACAO		VARCHAR(20)			NULL,
   NUSEQUENCIA			DECIMAL(9,0)		NULL,
   DSMASCARAFORMATO		VARCHAR(20)			NULL,
   NUCARIMBO			DECIMAL(9,0)		NULL,
   CDUSUARIO			VARCHAR(8)		NOT NULL,
   FLTIPOALTERACAO	    CHAR(1)				NULL,
   DTALTERACAO			DATETIME			NULL,
   HRALTERACAO			VARCHAR(8)			NULL,
CONSTRAINT PK_TBLVPINDICADORWMW PRIMARY KEY (CDINDICADOR, CDUSUARIO)
)
GO

CREATE TABLE TBLVPVALORINDICADORWMW (
   CDEMPRESA		VARCHAR(20)		NOT NULL,
   CDREPRESENTANTE	VARCHAR(20)		NOT NULL,
   CDINDICADOR		VARCHAR(20)		NOT NULL,
   CDAPURACAO		VARCHAR(20)		NOT NULL,
   DSAPURACAO		VARCHAR(20)			NULL,
   VLINDICADOR		DECIMAL(16,7)		NULL,
   DTAPURACAO		DATETIME			NULL,
   HRAPURACAO		VARCHAR(8)			NULL,
   NUCARIMBO		DECIMAL(9,0)		NULL,
   CDUSUARIO		VARCHAR(8)		NOT NULL,
   FLTIPOALTERACAO	CHAR(1)				NULL,
   DTALTERACAO		DATETIME			NULL,
   HRALTERACAO		VARCHAR(8)			NULL,
CONSTRAINT PK_TBLVPVALORINDICADORWMW PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDINDICADOR, CDAPURACAO, CDUSUARIO)
)
GO

--VERSAO 6.154

/*-------------------------------------------------------------------------
Atividade: LAV-21141	Autor: Rafael Medeiros
Data: 22/07/2019
-------------------------------------------------------------------------*/

/*-------------------------------------------------------------------------
Descrição: Nova coluna
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPRODUTO ADD FLCALCULAPRECOVOLUME CHAR(1);
GO

ALTER TABLE TBLVPPRODUTO ADD VLALTURAMIN DECIMAL(16,7);
GO

ALTER TABLE TBLVPPRODUTO ADD VLALTURAMAX DECIMAL(16,7);
GO

/*------------------------------------------------------------------------
LAV-17866
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPDESCFAIXAVALORPEDIDO (
   CDEMPRESA			VARCHAR(20) NOT NULL,
   CDREPRESENTANTE		VARCHAR(20) NOT NULL,
   CDFAIXAVALORPEDIDO   VARCHAR(20) NOT NULL,
   VLTOTALPEDIDO		DECIMAL(16,7)   NULL,
   VLPCTDESCONTO		DECIMAL(16,7)	NULL,
   NUCARIMBO			DECIMAL(9,0)	NULL,
   CDUSUARIO			VARCHAR(8)	NOT NULL,
   FLTIPOALTERACAO		CHAR(1)			NULL,
   DTALTERACAO			DATETIME		NULL,
   HRALTERACAO			VARCHAR(8)		NULL,
CONSTRAINT PK_TBLVPDESCFAIXAVALORPEDIDO PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDFAIXAVALORPEDIDO, CDUSUARIO)
)
GO

ALTER TABLE TBLVPCLIENTE ADD VLPCTDESCHISTORICOVENDAS DECIMAL (16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLDESCONTOCONDICAO DECIMAL (16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLDESCONTOCONDICAO DECIMAL (16,7);
GO
ALTER TABLE TBLVPCONDTIPOPAGTO ADD VLINDICE DECIMAL(16,7);
GO

--VERSAO 6.155

/*-------------------------------------------------------------------------
DESCRIÇÃO: NOVOS CAMPOS
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCONDICAOPAGAMENTO ADD QTMINVALORPARCELA DECIMAL(16,7);
GO
ALTER TABLE TBLVPPEDIDO ADD FLVALORMINPARCELALIBERADOSENHA CHAR(1);
GO
ALTER TABLE TBLVPPEDIDOERP ADD FLVALORMINPARCELALIBERADOSENHA CHAR(1);
GO

--VERSAO 6.156

--VERSAO 6.157

--VERSAO 6.158

--VERSAO 6.159

--VERSAO 6.160

/*-------------------------------------------------------------------------
Atividade: LAV-21396	Autor: Rafael Medeiros
Data: 09/08/2019
-------------------------------------------------------------------------*/

/*-------------------------------------------------------------------------
Descrição: Nova coluna
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPCLIENTEENDATUA ADD CDUSUARIOALTERACAO VARCHAR(20);
GO

ALTER TABLE TBLVPCLIENTEATUA ADD CDUSUARIOALTERACAO VARCHAR(20);
GO


--VERSAO 6.161

CREATE TABLE TBLVPNOTAFISCAL (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   NUNOTAFISCAL         VARCHAR(20)          NOT NULL,
   CDSERIE              VARCHAR(5)           NOT NULL,
   NUPEDIDO             VARCHAR(30)          NULL,
   FLORIGEMPEDIDO       CHAR(1)              NULL,
   CDREPRESENTANTE      VARCHAR(20)          NULL,
   NMREPRESENTANTE      VARCHAR(100)         NULL,
   CDCLIENTE            VARCHAR(20)          NULL,
   NMRAZAOSOCIAL        VARCHAR(100)         NULL,
   VLNOTAFISCAL         DECIMAL(16,7)        NULL,
   DTEMISSAO            DATETIME             NULL,
   DTPREVISAOENTREGA    DATETIME             NULL,
   DTSAIDA              DATETIME             NULL,
   HRSAIDA              VARCHAR(5)           NULL,
   CDTRANSPORTADORA     VARCHAR(20)          NULL,
   NMTRANSPORTADORA     VARCHAR(100)         NULL,
   DSOBSERVACAO         VARCHAR(255)         NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   NUCARIMBO		DECIMAL(9,0)	     NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPNOTAFISCAL PRIMARY KEY (CDEMPRESA, NUNOTAFISCAL, CDSERIE, CDUSUARIO)
)
GO

CREATE TABLE TBLVPITEMNOTAFISCAL (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   NUNOTAFISCAL         VARCHAR(20)          NOT NULL,
   CDSERIE              VARCHAR(5)           NOT NULL,
   CDPRODUTO            VARCHAR(20)          NOT NULL,
   NUPEDIDO             VARCHAR(30)          NULL,
   FLORIGEMPEDIDO       CHAR(1)              NULL,
   CDREPRESENTANTE      VARCHAR(20)          NULL,
   DSPRODUTO            VARCHAR(100)         NULL,
   NUSEQUENCIAITEM      DECIMAL(9)           NULL,
   DSUNIDADE            VARCHAR(2)           NULL,
   QTITEM               DECIMAL(16,7)        NULL,
   VLUNITARIO           DECIMAL(16,7)        NULL,
   VLTOTALITEM          DECIMAL(16,7)        NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   NUCARIMBO		DECIMAL(9,0)	     NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPITEMNOTAFISCAL PRIMARY KEY (CDEMPRESA, NUNOTAFISCAL, CDSERIE, CDPRODUTO, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------
 Novos campos
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD QTESTOQUEPREVISTO DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD DTESTOQUEPREVISTO DATETIME;
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD QTESTOQUEPREVISTO DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD DTESTOQUEPREVISTO DATETIME;
GO

--VERSAO 6.162

/*-------------------------------------------------------------------------
Descrição: Novas colunas
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPCONDICAOPAGAMENTO ADD QTMINMIXPRODUTO DECIMAL(9);
GO

ALTER TABLE TBLVPPEDIDO ADD VLSEGUROPEDIDO DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDOERP ADD VLSEGUROPEDIDO DECIMAL(16,7);
GO

ALTER TABLE TBLVPTIPOPEDIDO ADD FLIGNORAPESOMINFRETE CHAR(1);
GO

ALTER TABLE TBLVPCLIENTE ADD FLFRETEEMBUTIDO CHAR(1);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLITEMFRETETRIBUTACAO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLTOTALITEMFRETETRIBUTACAO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLITEMFRETETRIBUTACAO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLTOTALITEMFRETETRIBUTACAO DECIMAL(16,7);
GO

 --VERSAO 6.163

 --VERSAO 6.164

 --VERSAO 6.165

 --VERSAO 6.166

 --VERSAO 6.167

/*-------------------------------------------------------------------------
LAV-20539
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPLOGAPP (
   CDEMPRESA		VARCHAR(20)		NOT NULL,
   CDREPRESENTANTE  VARCHAR(20)		NOT NULL,
   CDLOG			VARCHAR(20)		NOT NULL,
   DTLOG			DATETIME		NOT NULL,
   HRLOG			VARCHAR(8)		NOT NULL,
   CDUSUARIOLOG  	VARCHAR(20)		NOT NULL,
   FLTIPOLOG		CHAR(1)			NOT NULL,
   VLCHAVE			VARCHAR(200)	NOT NULL,
   CDPROCESSO		VARCHAR(3)		NOT NULL,
   CDCLIENTE		VARCHAR(20)			NULL,
   DSDETALHES		VARCHAR(4000)		NULL,
   NUCARIMBO		DECIMAL(9,0)		NULL,
   CDUSUARIO		VARCHAR(8)		NOT NULL,
   FLTIPOALTERACAO	CHAR(1)				NULL,
   DTALTERACAO		DATETIME			NULL,
   HRALTERACAO		VARCHAR(8)			NULL,
CONSTRAINT PK_TBLVPLOGAPP PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDLOG, CDUSUARIO)
)
GO

--VERSAO 6.168
 
--VERSAO 6.169
 
/*-------------------------------------------------------------------------
Descrição: Nova Coluna
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPTABELAPRECO ADD FLIGNORAINDICECONDTIPOPAGTO CHAR(1);
GO

--VERSAO 6.170

/*------------------------------------------------------------------------ 
Descrição: Nova coluna
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPUNIDADE ADD FLIGNORAMULTESPECIAL CHAR(1);
GO

--VERSAO 6.171
 
/*-------------------------------------------------------------------------
Descrição: Criação da tabela TBLVWITEMPEDIDOGRADEERPDIF
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPITEMPEDIDOGRADEERPDIF (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
   FLORIGEMPEDIDO       CHAR(1)              NOT NULL,
   NUPEDIDO             VARCHAR(30)          NOT NULL,
   CDPRODUTO            VARCHAR(20)          NOT NULL,
   FLTIPOITEMPEDIDO     CHAR(1)              NOT NULL,
   NUSEQPRODUTO         DECIMAL(9,0)         NOT NULL,
   CDITEMGRADEORG1      VARCHAR(20)          NOT NULL,
   CDITEMGRADEERP1      VARCHAR(20)          NOT NULL,
   CDITEMGRADEORG2      VARCHAR(20)          NOT NULL,
   CDITEMGRADEERP2      VARCHAR(20)          NOT NULL,
   CDITEMGRADEORG3      VARCHAR(20)          NOT NULL,
   CDITEMGRADEERP3      VARCHAR(20)          NOT NULL,
   QTITEMFISICOORG      DECIMAL(16,7)        NULL,
   QTITEMFISICOERP      DECIMAL(16,7)        NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPITEMPEDIDOGRADEERPDIF PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, FLORIGEMPEDIDO, NUPEDIDO, CDPRODUTO, FLTIPOITEMPEDIDO, NUSEQPRODUTO, CDITEMGRADEORG1, CDITEMGRADEERP1, CDITEMGRADEORG2, CDITEMGRADEERP2, CDITEMGRADEORG3, CDITEMGRADEERP3, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-21666	Autor: Gustavo Heidemann
Data: 02/09/2019
-------------------------------------------------------------------------*/

/*-------------------------------------------------------------------------
Descrição: Nova coluna
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPTIPOPEDIDO ADD FLIGNORACALCULOCOMISSAO CHAR(1);
GO


--VERSAO 6.172

--VERSAO 6.173


/*------------------------------------------------------------------------
NOVAS COLUNAS
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTDESCCONDPAGTO DECIMAL(16,7);
GO
ALTER TABLE TBLVPCONDICAOPAGAMENTO ADD VLPCTMAXDESCONTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDO ADD DSOBSERVACAOCLIENTE VARCHAR(4000);
GO

ALTER TABLE TBLVPPEDIDOERP ADD DSOBSERVACAOCLIENTE VARCHAR(4000);
GO

ALTER TABLE TBLVPVALORINDICADORWMW ADD VLMETA DECIMAL(16,7);
GO


ALTER TABLE TBLVPITEMTABELAPRECO ADD VLBASEMARGEM DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLINDICEREDMARGEM DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTTOTALMARGEMITEM DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTTOTALMARGEMITEM DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLBASEMARGEM DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLBASEMARGEM DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLINDICEREDMARGEM DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLINDICEREDMARGEM DECIMAL(16,7);
GO
ALTER TABLE TBLVPPEDIDO ADD VLPCTTOTALMARGEM DECIMAL(16,7);
GO
ALTER TABLE TBLVPPEDIDOERP ADD VLPCTTOTALMARGEM DECIMAL(16,7);
GO

CREATE TABLE TBLVPMARGEMCONTRIBFAIXA(
    CDEMPRESA			VARCHAR(20)		NOT NULL,
    CDREPRESENTANTE		VARCHAR(20)		NOT NULL,
    CDFAIXA				VARCHAR(20)		NOT NULL,
    DSFAIXA				VARCHAR(100)		NULL,
    VLPCTMARGEMINICIO	DECIMAL(16,7)		NULL,
    VLPCTMARGEMFIM		DECIMAL(16,7)		NULL,
    FLBLOQUEIAPEDIDO		CHAR(1)				NULL,
    FLACAOVERBA			CHAR(1)				NULL,
    CDUSUARIO			VARCHAR(8)		NOT NULL,
    NUCARIMBO			DECIMAL(9,0)		NULL,
    FLTIPOALTERACAO		CHAR(1)				NULL,
    DTALTERACAO			DATETIME			NULL,
    HRALTERACAO			VARCHAR(8)			NULL,
CONSTRAINT PK_TBLVPMARGEMCONTRIBFAIXA PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDFAIXA, CDUSUARIO)
)
GO

--VERSAO 6.174

/*------------------------------------------------------------------------
NOVAS COLUNAS
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPFOTOPRODUTO ADD NMEXTENSAO VARCHAR(8);
GO

ALTER TABLE TBLVPFOTOPRODUTOEMP ADD NMEXTENSAO VARCHAR(8);
GO

ALTER TABLE TBLVPPRODUTO ADD VLPCTMAXDESCEXTRA DECIMAL(16,7);
GO

--VERSAO 6.175

/*------------------------------------------------------------------------
NOVO PARÂMETRO
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPEDIDO ADD QTDIASCPGTOLIBSENHA DECIMAL(9);
GO
ALTER TABLE TBLVPPEDIDO ADD VLTOTALPEDIDOLIBERADO DECIMAL(16, 7);
GO
ALTER TABLE TBLVPPEDIDOERP ADD QTDIASCPGTOLIBSENHA DECIMAL(9);
GO
ALTER TABLE TBLVPPEDIDOERP ADD VLTOTALPEDIDOLIBERADO DECIMAL(16, 7);
GO

--VERSAO 6.176
 
/*------------------------------------------------------------------------
Atividade: LAV-19962
Autor: Renan
Data: 29/08/2019
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPVERBAGRUPOPRODUTO (
   CDEMPRESA            VARCHAR(20) NOT NULL,
   CDREPRESENTANTE      VARCHAR(20) NOT NULL,
   CDGRUPOPRODUTO1      VARCHAR(20) NOT NULL,
   CDTABELAPRECO        VARCHAR(20) NOT NULL,
   VLPCTVERBAPOSITIVA   DECIMAL(16,7)   NULL,
   CDUSUARIO            VARCHAR(8)  NOT NULL,
   NUCARIMBO            DECIMAL(9,0)    NULL,
   FLTIPOALTERACAO	   CHAR(1)		    NULL,
   DTALTERACAO	         DATETIME	   	 NULL,
   HRALTERACAO	         VARCHAR(8)		 NULL,
   CONSTRAINT PK_TBLVPVERBAGRUPOPRODUTO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDGRUPOPRODUTO1, CDTABELAPRECO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPVERBASALDOVIGENCIA (
   CDEMPRESA        VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE  VARCHAR(20)          NOT NULL,
   CDMESSALDO       DECIMAL(2,0)         NOT NULL,
   VLSALDO          DECIMAL(16,7)            NULL,
   DTSALDO  	     DATETIME                 NULL,
   DTINICIOVIGENCIA DATETIME                 NULL,
   DTFIMVIGENCIA    DATETIME                 NULL,
   CDUSUARIO        VARCHAR(8)           NOT NULL,
   NUCARIMBO        DECIMAL(9,0)             NULL,
   FLTIPOALTERACAO  CHAR(1)		            NULL,
   DTALTERACAO	     DATETIME  		         NULL,
   HRALTERACAO	     VARCHAR(8)		         NULL,
   CONSTRAINT PK_TBLVPVERBASALDOVIGENCIA PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDMESSALDO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPVERBAVIGENCIAPEDIDO (
   CDEMPRESA        VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE  VARCHAR(20)          NOT NULL,
   CDMESSALDO       DECIMAL(2,0)         NOT NULL,
   NUPEDIDO         VARCHAR(30)          NOT NULL,
   VLSALDO          DECIMAL(16,7)            NULL,
   CDUSUARIO        VARCHAR(8)           NOT NULL,
   NUCARIMBO        DECIMAL(9,0)             NULL,
   FLTIPOALTERACAO  CHAR(1)		            NULL,
   DTALTERACAO	     DATETIME  		         NULL,
   HRALTERACAO	     VARCHAR(8)		         NULL,
   CONSTRAINT PK_TBLVPVERBAVIGENCIAPEDIDO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDMESSALDO, NUPEDIDO, CDUSUARIO)
)
GO

 --VERSAO 6.177

/*------------------------------------------------------------------------
NOVA COLUNA LAV-22193
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPTIPOFRETE ADD FLCALCULAFRETEITEM CHAR(1);
GO

--VERSAO 6.178

--VERSAO 6.179

/*-------------------------------------------------------------------------
Descrição: Nova tabela
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPTABPRECOLOTEPROD (
   CDEMPRESA	        VARCHAR(20)		NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)		NOT NULL,
   CDTABELAPRECO        VARCHAR(20)		NOT NULL,
   CDLOTEPRODUTO       VARCHAR(100)		NOT NULL,
   CDUSUARIO		     VARCHAR(8)		NOT NULL,
   NUCARIMBO	       DECIMAL(9,0)		    NULL,
   FLTIPOALTERACAO	        CHAR(1)		    NULL,
   DTALTERACAO	           DATETIME		    NULL,
   HRALTERACAO		     VARCHAR(8)         NULL,
CONSTRAINT PK_TBLVPTABPRECOLOTEPROD PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDTABELAPRECO, CDLOTEPRODUTO, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------
Atividade: LAV-20499
Autor: Renan
Data: 10/09/2019
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPRELNOVIDADEPROD ADD CDITEMGRADE1 VARCHAR(20);
GO

ALTER TABLE TBLVPRELNOVIDADEPROD ADD CDITEMGRADE2 VARCHAR(20);
GO

ALTER TABLE TBLVPRELNOVIDADEPROD ADD CDITEMGRADE3 VARCHAR(20);
GO

UPDATE TBLVPRELNOVIDADEPROD SET CDITEMGRADE1 = '0', CDITEMGRADE2 = '0', CDITEMGRADE3 = '0';

--SQLSERVER
ALTER TABLE TBLVPRELNOVIDADEPROD ALTER COLUMN CDITEMGRADE1 VARCHAR(20) NOT NULL;
GO

ALTER TABLE TBLVPRELNOVIDADEPROD ALTER COLUMN CDITEMGRADE2 VARCHAR(20) NOT NULL;
GO

ALTER TABLE TBLVPRELNOVIDADEPROD ALTER COLUMN CDITEMGRADE3 VARCHAR(20) NOT NULL;
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPRELNOVIDADEPROD MODIFY CDITEMGRADE1 VARCHAR(20) NOT NULL;

ALTER TABLE TBLVPRELNOVIDADEPROD MODIFY CDITEMGRADE2 VARCHAR(20) NOT NULL;

ALTER TABLE TBLVPRELNOVIDADEPROD MODIFY CDITEMGRADE3 VARCHAR(20) NOT NULL;
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPRELNOVIDADEPROD ALTER COLUMN CDITEMGRADE1 SET NOT NULL;

ALTER TABLE TBLVPRELNOVIDADEPROD ALTER COLUMN CDITEMGRADE2 SET NOT NULL;

ALTER TABLE TBLVPRELNOVIDADEPROD ALTER COLUMN CDITEMGRADE3 SET NOT NULL;
--/POSTGRES

ALTER TABLE TBLVPRELNOVIDADEPROD DROP CONSTRAINT PK_TBLVPRELNOVIDADEPROD;
GO

--ORACLE
DROP INDEX PK_TBLVPRELNOVIDADEPROD;
--/ORACLE

ALTER TABLE TBLVPRELNOVIDADEPROD ADD CONSTRAINT PK_TBLVPRELNOVIDADEPROD PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDTIPONOVIDADE, CDITEMGRADE1, CDITEMGRADE2, CDITEMGRADE3, CDUSUARIO);
GO

--VERSAO 6.180

--VERSAO 6.181

/*------------------------------------------------------------------------ 
Descrição: Novas colunas
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPFECHAMENTODIARIO ADD VLTOTALVENDASOUTROS DECIMAL(16,7);
GO
ALTER TABLE TBLVPFECHAMENTODIARIO ADD VLTOTALPAGAMENTOSOUTROS DECIMAL(16,7);
GO

--VERSAO 6.181-1

--VERSAO 6.182

/*-------------------------------------------------------------------------
Descrição: Criação da tabela TBLVPDESCONTOPACOTE
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPDESCONTOPACOTE (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
   CDPRODUTO            VARCHAR(20)        	 NOT NULL,
   CDPACOTE             VARCHAR(20)          NOT NULL,
   CDTABELAPRECO        VARCHAR(30)      	 NOT NULL,
   QTITEM               DECIMAL(16,7)        NOT NULL,
   VLPCTDESCONTO      	DECIMAL(16,7)        NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPDESCONTOPACOTE PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDPACOTE, CDTABELAPRECO, QTITEM, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Descrição: Criação da tabela TBLVPPACOTE
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPPACOTE (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
   CDPACOTE             VARCHAR(20)          NOT NULL,
   DSPACOTE             VARCHAR(100)         NOT NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPPACOTE PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDPACOTE, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Descrição: Criação da coluna cdPacote na tabela ItemPedido
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD CDPACOTE VARCHAR(20);

/*-------------------------------------------------------------------------
Descrição: Criação da coluna cdPacote na tabela ItemPedidoErp
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDOERP ADD CDPACOTE VARCHAR(20);

--VERSAO 6.183

--VERSAO 6.184

--VERSAO 6.185

/*------------------------------------------------------------------------
Descrição: Nova coluna LAV-21689
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTDESCPEDIDO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTDESCPEDIDO DECIMAL(16,7);
GO

--VERSAO 6.186
--VERSAO 6.187
--VERSAO 6.188

--VERSAO 6.189

/*------------------------------------------------------------------------
Descrição: Novas colunas
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPEDIDO ADD VLPCTDESCHISTORICOVENDAS DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDOERP ADD VLPCTDESCHISTORICOVENDAS DECIMAL(16,7);
GO


--VERSAO 6.190

/*------------------------------------------------------------------------
NOVAS COLUNAS
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPEDIDO ADD DSMOTIVOBONIFICACAO VARCHAR(4000);
GO

ALTER TABLE TBLVPPEDIDOERP ADD DSMOTIVOBONIFICACAO VARCHAR(4000);
GO

ALTER TABLE TBLVPEMPRESA ADD VLFATORFACEAMENTO DECIMAL(16, 7);
GO

ALTER TABLE TBLVPFACEAMENTOESTOQUE ADD HRCADASTRO VARCHAR(8);
GO

ALTER TABLE TBLVPFACEAMENTOESTOQUE ADD VLFATORFACEAMENTO DECIMAL(16, 7);
GO

ALTER TABLE TBLVPFACEAMENTOESTOQUE ADD QTSUGESTAOVENDA DECIMAL(16, 7);
GO

--VERSAO 6.191

--VERSAO 6.192


ALTER TABLE TBLVPITEMTABELAPRECO ADD VLPCTVERBAGRUPOPROD DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMTABELAPRECO ADD VLPCTVERBAPEDIDO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMTABELAPRECO ADD VLMAXVERBACONSFOR DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLVERBAFORNECEDORITEM DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLVERBAGRUPOITEM DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDO ADD VLVERBAFORNECEDOR DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDO ADD VLVERBAGRUPO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLVERBAFORNECEDORITEM DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLVERBAGRUPOITEM DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDOERP ADD VLVERBAFORNECEDOR DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDOERP ADD VLVERBAGRUPO DECIMAL(16,7);
GO

ALTER TABLE TBLVPTIPOFRETE ADD FLSUGERESEGURO CHAR(1);
GO

ALTER TABLE TBLVPPEDIDO ADD FLCALCULASEGURO CHAR(1);
GO

ALTER TABLE TBLVPPEDIDOERP ADD FLCALCULASEGURO CHAR(1);
GO

--VERSAO 6.193

/*------------------------------------------------------------------------
NOVAS COLUNAS
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPEMPRESA ADD CDLOCAL VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDO ADD CDLOCAL VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDOERP ADD CDLOCAL VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLBASEANTECIPACAO DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLBASEANTECIPACAO DECIMAL(16,7);
GO

/*==============================================================*/
/* Descrição: Nova tabela TBLVPCOMISSAOGRUPOFAIXADESC           */
/*==============================================================*/

CREATE TABLE TBLVPCOMISSAOGRUPOFAIXANEG(
   CDEMPRESA            VARCHAR(20)         NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)         NOT NULL,
   CDGRUPOPRODUTO1      VARCHAR(20)         NOT NULL,
   CDGRUPOPRODUTO2      VARCHAR(20)         NOT NULL,
   CDGRUPOPRODUTO3      VARCHAR(20)         NOT NULL,
   VLINDICE             DECIMAL(16,7)       NOT NULL,
   VLPCTCOMISSAO        DECIMAL(16,7)       NULL,
   FLTIPOALTERACAO      CHAR(1)             NULL,
   CDUSUARIO            VARCHAR(8)          NOT NULL,
   NUCARIMBO            DECIMAL(9,0)        NULL,
   DTALTERACAO          DATETIME            NULL,
   HRALTERACAO          VARCHAR(8)          NULL,
   CONSTRAINT PK_TBLVPCOMISSAOGRUPOFAIXANEG PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDGRUPOPRODUTO1, CDGRUPOPRODUTO2, CDGRUPOPRODUTO3, VLINDICE, CDUSUARIO)
)
GO

/*==============================================================*/
/* TABLE: TBLVPPESQUISAAPP                                      */
/*==============================================================*/
CREATE TABLE TBLVPPESQUISAAPP (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
   CDPESQUISAAPP        VARCHAR(20)          NOT NULL,
   CDQUESTIONARIO       VARCHAR(20)          NULL,
   CDCLIENTE            VARCHAR(20)          NULL,
   DTINICIOPESQUISA     DATETIME             NULL,
   HRINICIOPESQUISA     VARCHAR(8)           NULL,
   DTFIMPESQUISA        DATETIME             NULL,
   HRFIMPESQUISA        VARCHAR(8)           NULL,
   CDUSUARIO            VARCHAR(20)          NOT NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPPESQUISAAPP PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPESQUISAAPP, CDUSUARIO)
)
GO

/*==============================================================*/
/* TABLE: TBLVPPESQUISARESPAPP                                  */
/*==============================================================*/
CREATE TABLE TBLVPPESQUISARESPAPP (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
   CDPESQUISAAPP        VARCHAR(20)          NOT NULL,
   CDQUESTIONARIO       VARCHAR(20)          NOT NULL,
   CDPERGUNTA           VARCHAR(20)          NOT NULL,
   CDRESPOSTA           VARCHAR(20)          NOT NULL,
   CDCLIENTE            VARCHAR(20)          NULL,
   DTRESPOSTA           DATETIME             NULL,
   HRRESPOSTA           VARCHAR(8)           NULL,
   DSRESPOSTA           VARCHAR(4000)        NULL,
   DSOBSERVACAO         VARCHAR(4000)        NULL,
   CDUSUARIO            VARCHAR(20)          NOT NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO     CHAR(1)              NULL,
   DTALTERACAO         DATETIME             NULL,
   HRALTERACAO         VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPPESQUISARESPAPP PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPESQUISAAPP, CDQUESTIONARIO, CDPERGUNTA, CDRESPOSTA, CDUSUARIO)
)
GO

/*==============================================================*/
/* TABLE: TBLVPPERGUNTA                                         */
/*==============================================================*/
CREATE TABLE TBLVPPERGUNTA (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDPERGUNTA           VARCHAR(20)          NOT NULL,
   DSPERGUNTA           VARCHAR(4000)        NULL,
   DTCADASTRO           DATETIME             NULL,
   FLEXIBEOBSERVACAO    CHAR(1)              NULL,
   CDTIPOPERGUNTA       VARCHAR(20)          NULL,
   CDUSUARIO            VARCHAR(20)          NOT NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPPERGUNTA PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDPERGUNTA, CDUSUARIO)
)
GO

/*==============================================================*/
/* TABLE: TBLVPPERGUNTARESPOSTA                                 */
/*==============================================================*/
CREATE TABLE TBLVPPERGUNTARESPOSTA (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDPERGUNTA           VARCHAR(20)          NOT NULL,
   CDRESPOSTA           VARCHAR(20)          NOT NULL,
   DSRESPOSTA           VARCHAR(4000)        NULL,
   DTCADASTRO           DATETIME             NULL,
   NUSEQUENCIA          DECIMAL(9,0)         NULL,
   CDUSUARIO            VARCHAR(20)          NOT NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPPERGUNTARESPOSTA PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDPERGUNTA, CDRESPOSTA, CDUSUARIO)
)
GO

/*==============================================================*/
/* TABLE: TBLVPQUESTIONARIO                                     */
/*==============================================================*/
CREATE TABLE TBLVPQUESTIONARIO (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDQUESTIONARIO       VARCHAR(20)          NOT NULL,
   NMQUESTIONARIO       VARCHAR(100)         NULL,
   DTCADASTRO           DATETIME             NULL,
   CDTIPOQUESTIONARIO   VARCHAR(20)          NULL,
   CDUSUARIO            VARCHAR(20)          NOT NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPQUESTIONARIO PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDQUESTIONARIO, CDUSUARIO)
)
GO

/*==============================================================*/
/* TABLE: TBLVPQUESTIONARIOPERGUNTA                             */
/*==============================================================*/
CREATE TABLE TBLVPQUESTIONARIOPERGUNTA (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDQUESTIONARIO       VARCHAR(20)          NOT NULL,
   CDPERGUNTA           VARCHAR(20)          NOT NULL,
   DTCADASTRO           DATETIME             NULL,
   NUSEQUENCIA          DECIMAL(9,0)         NULL,
   FLOBRIGATORIO        CHAR(1)              NULL,
   FLEXIBEOBSERVACAO    CHAR(1)              NULL,
   CDUSUARIO            VARCHAR(20)          NOT NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPQUESTIONARIOPERGUNTA PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDQUESTIONARIO, CDPERGUNTA, CDUSUARIO)
)
GO

/*==============================================================*/
/* TABLE: TBLVPPESQUISARESPAPPHISTCLI                           */
/*==============================================================*/
CREATE TABLE TBLVPPESQUISARESPAPPHISTCLI (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDCLIENTE            VARCHAR(20)          NOT NULL,
   CDQUESTIONARIO       VARCHAR(20)          NOT NULL,
   CDPERGUNTA           VARCHAR(20)          NOT NULL,
   CDRESPOSTA           VARCHAR(20)          NULL,
   DSRESPOSTA           VARCHAR(4000)        NULL,
   DSOBSERVACAO         VARCHAR(4000)        NULL,
   CDUSUARIO            VARCHAR(20)          NOT NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPPESQUISARESPAPPHISTCLI PRIMARY KEY (CDEMPRESA, CDCLIENTE, CDQUESTIONARIO, CDPERGUNTA, CDUSUARIO)
)
GO

--VERSAO 6.194

--VERSAO 6.195

/*-------------------------------------------------------------------------
Descrição: Alteração de coluna
------------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPTELA ALTER COLUMN DSSQL TEXT;
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPTELA ADD (tmpdssql  CLOB);
UPDATE TBLVPTELA SET tmpdssql=dssql;
COMMIT;
ALTER TABLE TBLVPTELA DROP COLUMN DSSQL;
ALTER TABLE TBLVPTELA RENAME COLUMN tmpdssql TO DSSQL;
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPTELA ALTER COLUMN DSSQL TYPE TEXT;
--/POSTGRES

--VERSAO 6.196

--VERSAO 6.197

/*------------------------------------------------------------------------
Atividade: LAV-21597 - DISPROL - Aviso Tablet
Descrição: Criação da coluna FLDIVULGAINFO na tabela TBLVWCLIENTE
Autor: Raphael Santos
Data: 08/11/2019
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCLIENTE ADD FLDIVULGAINFO CHAR(1);
GO

/*------------------------------------------------------------------------
Atividade: LAV-21597 - DISPROL - Aviso Tablet
Descrição: Criação da tabela TBLVWDIVULGAINFO
Autor: Raphael Santos
Data: 08/11/2019
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPDIVULGAINFO(
	CDEMPRESA 				VARCHAR(20)   NOT NULL,
	CDREPRESENTANTE 		VARCHAR(20)   NOT NULL,
	CDCLIENTE       		VARCHAR(20)   NOT NULL,
	CDDIVULGAINFO   		VARCHAR(20)   NOT NULL,
	DSDIVULGAINFO  			VARCHAR(4000)     NULL,
    FLTIPODIVULGAINFO		CHAR(1)			  NULL,
	DSTIPODIVULGAINFOTXT    VARCHAR(200)      NULL,
	NMIMAGEM   				VARCHAR(100)      NULL,
	DTINICIAL     			DATETIME          NULL,
	DTFINAL         		DATETIME          NULL,
 	NUCARIMBO            	DECIMAL(9,0)      NULL,
   	FLTIPOALTERACAO      	CHAR(1)           NULL,
   	CDUSUARIO            	VARCHAR(8)    NOT NULL,
   	DTALTERACAO          	DATETIME          NULL,
   	HRALTERACAO          	VARCHAR(8)        NULL,
	CONSTRAINT PK_TBLVPDIVULGAINFO PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, CDDIVULGAINFO, CDUSUARIO)
)
GO

--VERSAO 6.199

/*------------------------------------------------------------------------
Descrição: Colunas faltantes na ITEMPEDIDOERP
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDOERP ADD DTENTREGA DATETIME;
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTDESCCONDPAGTO DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLRETORNOPRODUTO DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD FLERRORECALCULO CHAR(1);
GO

/*------------------------------------------------------------------------
Novas colunas
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCONDICAOPAGAMENTO ADD FLPERMITEIGNORARRECALCULO CHAR(1);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLINDICECONDICAOPAGTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLINDICECONDICAOPAGTO DECIMAL(16,7);
GO

--VERSAO 6.200

--VERSAO 6.201

/*-------------------------------------------------------------------------
Descricao: Nova coluna
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCONDTIPOPAGTO ADD QTMINVALORPARCELA DECIMAL(16,7);
GO
ALTER TABLE TBLVPPESQUISAMERCADO ADD CDLATITUDE DECIMAL(16,9);
GO
ALTER TABLE TBLVPPESQUISAMERCADO ADD CDLONGITUDE DECIMAL(16,9);
GO

/*-------------------------------------------------------------------------
Descrição: Nova tabela
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPFOTOPESQUISAMERCADO(
   CDEMPRESA        		VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE  		VARCHAR(20)          NOT NULL,
   FLORIGEMPESQUISAMERCADO 	CHAR(1)	 	         NOT NULL,
   CDPESQUISAMERCADO		VARCHAR(20)          NOT NULL,
   NMFOTO			        VARCHAR(100)         NOT NULL,
   CDFOTO			        DECIMAL(9)           NULL,
   FLENVIADOSERVIDOR		CHAR		         NULL,
   NUCARIMBO        		DECIMAL(9,0)         NULL,
   CDUSUARIO		        VARCHAR(8)	         NOT NULL,
   FLTIPOALTERACAO  		CHAR(1)		         NULL,
   DTALTERACAO	     		DATETIME  		     NULL,
   HRALTERACAO	     		VARCHAR(8)		     NULL,
   CONSTRAINT PK_TBLVPFOTOPESQUISAMERCADO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, FLORIGEMPESQUISAMERCADO, CDPESQUISAMERCADO, NMFOTO, CDUSUARIO)
)
GO

--VERSAO 6.202

--VERSAO 6.203

/*-------------------------------------------------------------------------
NOVAS COLUNAS TABELA TBLVPITEMTABELAPRECO
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMTABELAPRECO ADD FLBLOQUEIADESCPROMO VARCHAR(1) NULL;
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD FLBLOQUEIADESCPADRAO VARCHAR(1) NULL;
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD FLBLOQUEIADESCCONDICAO VARCHAR(1) NULL;
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD FLBLOQUEIADESC2 VARCHAR(1) NULL;
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD FLBLOQUEIADESC3 VARCHAR(1) NULL;
GO

/*-------------------------------------------------------------------------
Descrição: Novo campo
------------------------------------------------------------------------*/
ALTER TABLE TBLVPTABELAPRECO ADD CDTABELAPRECOPRINCIPAL VARCHAR(20); 
GO

--VERSAO 6.204

--VERSAO 6.205

/*-------------------------------------------------------------------------
Atividade: LAV-22732 - Módulo de cálculo de frete dinâmico
Descrição: Criação da tabela TBLVPFRETECONFIG
Autor: Raphael Santos
Data: 21/10/2019
------------------------------------------------------------------------*/
CREATE TABLE TBLVPFRETECONFIG (
   CDEMPRESA	        VARCHAR(20)		NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)		NOT NULL,
   CDTRANSPORTADORA     VARCHAR(20)		NOT NULL,
   CDFRETECONFIG        VARCHAR(20)		NOT NULL,
   DSFRETECONFIG        VARCHAR(100)	NULL,
   CDTIPOFRETE       	VARCHAR(20)     NULL,
   FLTIPOTABFRETE       CHAR(1)         NULL,
   CDREGIAO             VARCHAR(20)		NULL,
   NUCEPINICIO          DECIMAL(9,0)    NULL,
   NUCEPFIM             DECIMAL(9,0)    NULL,
   CDUSUARIO		    VARCHAR(8)		NOT NULL,
   NUCARIMBO			DECIMAL(9,0)	NULL,
   FLTIPOALTERACAO		CHAR(1)			NULL,
   DTALTERACAO			DATETIME		NULL,
   HRALTERACAO			VARCHAR(8)		NULL,
   CONSTRAINT PK_TBLVPFRETECONFIG PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDTRANSPORTADORA, CDFRETECONFIG, CDUSUARIO)
)
GO


/*-------------------------------------------------------------------------
Atividade: LAV-22732 - Módulo de cálculo de frete dinâmico
Descrição: Criação da tabela TBLVPFRETEEVENTO
Autor: Raphael Santos
Data: 21/10/2019
------------------------------------------------------------------------*/
CREATE TABLE TBLVPFRETEEVENTO (
   CDEMPRESA	        VARCHAR(20)		NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)		NOT NULL,
   CDFRETEEVENTO        VARCHAR(20)		NOT NULL,
   DSFRETEEVENTO        VARCHAR(100)	NULL,
   NUTIPOBASECALCULO    DECIMAL(9,0)    NULL,
   CDUSUARIO		    VARCHAR(8)		NOT NULL,
   NUCARIMBO			DECIMAL(9,0)	NULL,
   FLTIPOALTERACAO		CHAR(1)			NULL,
   DTALTERACAO			DATETIME		NULL,
   HRALTERACAO			VARCHAR(8)		NULL,
   CONSTRAINT PK_TBLVPFRETEEVENTO PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDFRETEEVENTO, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-22732 - Módulo de cálculo de frete dinâmico
Descrição: Criação da tabela TBLVPFRETECALCULO
Autor: Raphael Santos
Data: 21/10/2019
------------------------------------------------------------------------*/
CREATE TABLE TBLVPFRETECALCULO (
   CDEMPRESA	        		VARCHAR(20)		NOT NULL,
   CDREPRESENTANTE      		VARCHAR(20)		NOT NULL,
   CDTRANSPORTADORA     		VARCHAR(20)		NOT NULL,
   CDFRETECONFIG        		VARCHAR(20)		NOT NULL,
   CDFRETECALCULO        		DECIMAL(9,0)	NOT NULL,
   NUORDEMCALCULO        		DECIMAL(9,0)	NOT NULL,
   CDFRETEEVENTO        		VARCHAR(20) 	NOT NULL,
   FLTIPOTAXA              		CHAR(1)         NULL,
   VLTAXA             	    	DECIMAL(16,7)	NULL,
   FLFORMAPRECOFRETE    		CHAR(1)         NULL,
   VLMINIMO             		DECIMAL(16,7)	NULL,
   VLFAIXABC            		DECIMAL(16,7)	NULL,
   FLTIPOTAXAEXCEDENDEFAIXABC  	CHAR(1)         NULL,
   VLTAXAEXCEDENTEFAIXABC   	DECIMAL(16,7)	NULL,
   CDUSUARIO		   			VARCHAR(8)		NOT NULL,
   NUCARIMBO					DECIMAL(9,0)	NULL,
   FLTIPOALTERACAO				CHAR(1)			NULL,
   DTALTERACAO					DATETIME		NULL,
   HRALTERACAO					VARCHAR(8)		NULL,
   CONSTRAINT PK_TBLVPFRETECALCULO PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDTRANSPORTADORA, CDFRETECONFIG, CDFRETECALCULO, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-22732 - Módulo de cálculo de frete dinâmico
Descrição: Criação da tabela TBLVPFRETEBASECALCULO
Autor: Raphael Santos
Data: 21/10/2019
------------------------------------------------------------------------*/
CREATE TABLE TBLVPFRETEBASECALCULO (
   CDEMPRESA	        VARCHAR(20)		NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)		NOT NULL,
   CDTRANSPORTADORA     VARCHAR(20)		NOT NULL,
   CDFRETECONFIG        VARCHAR(20)		NOT NULL,
   CDFRETECALCULO       DECIMAL(9,0)	NOT NULL,
   CDFRETECALCULOBC     DECIMAL(9,0)	NOT NULL,
   CDUSUARIO		    VARCHAR(8)		NOT NULL,
   NUCARIMBO			DECIMAL(9,0)	NULL,
   FLTIPOALTERACAO		CHAR(1)			NULL,
   DTALTERACAO			DATETIME		NULL,
   HRALTERACAO			VARCHAR(8)		NULL,
   CONSTRAINT PK_TBLVPFRETEBASECALCULO PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDTRANSPORTADORA, CDFRETECONFIG, CDFRETECALCULO, CDFRETECALCULOBC, CDUSUARIO)
)
GO

ALTER TABLE TBLVPPEDIDO ADD CDFRETECONFIG VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDOERP ADD CDFRETECONFIG VARCHAR(20);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-22852 (Novas colunas)
Autor: Augusto
Data: 20/11/2019
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPTIPOPEDIDO ADD FLUTILIZACONDPGTOPADRAOCLI VARCHAR(1);
GO

ALTER TABLE TBLVPPRODUTO ADD VLGRAMATURA DECIMAL(16,7);
GO

ALTER TABLE TBLVPUNIDADE ADD FLCALCULAPESOGRAMATURA VARCHAR(1);
GO

--VERSAO 6.206


/*-------------------------------------------------------------------------
Descricao: Nova coluna chave.
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPAGENDAVISITA ADD NUSEQUENCIAAGENDA DECIMAL(9);
GO

UPDATE TBLVPAGENDAVISITA SET NUSEQUENCIAAGENDA = 0;
ALTER TABLE TBLVPAGENDAVISITA ALTER COLUMN NUSEQUENCIAAGENDA DECIMAL(9) NOT NULL;
GO

ALTER TABLE TBLVPAGENDACADASTRO ADD NUSEQUENCIAAGENDA DECIMAL(9);
GO

UPDATE TBLVPAGENDACADASTRO SET NUSEQUENCIAAGENDA = 0;
ALTER TABLE TBLVPAGENDACADASTRO ALTER COLUMN NUSEQUENCIAAGENDA DECIMAL(9) NOT NULL;
GO

ALTER TABLE TBLVPAGENDAVISITA DROP CONSTRAINT PK_TBLVPAGENDAVISITA;
GO

--ORACLE
DROP INDEX PK_TBLVPAGENDAVISITA;
GO
--/ORACLE

ALTER TABLE TBLVPAGENDAVISITA ADD CONSTRAINT PK_TBLVPAGENDAVISITA PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, NUDIASEMANA, FLSEMANAMES, NUSEQUENCIAAGENDA, CDUSUARIO);
GO

ALTER TABLE TBLVPAGENDACADASTRO DROP CONSTRAINT PK_TBLVPAGENDACADASTRO;
GO

--ORACLE
DROP INDEX PK_TBLVPAGENDACADASTRO;
GO
--/ORACLE

ALTER TABLE TBLVPAGENDACADASTRO ADD CONSTRAINT PK_TBLVPAGENDACADASTRO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, NUDIASEMANA, FLSEMANAMES, NUSEQUENCIAAGENDA, CDUSUARIO);
GO

--VERSAO 6.207

--VERSAO 6.208

/*-------------------------------------------------------------------------
Descrição: Alteração de coluna
------------------------------------------------------------------------*/

--SQLSERVER
ALTER TABLE TBLVPPESQUISAMERCADO ALTER COLUMN CDLATITUDE DECIMAL(23,20);
GO
ALTER TABLE TBLVPPESQUISAMERCADO ALTER COLUMN CDLONGITUDE DECIMAL(23,20);
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPPESQUISAMERCADO MODIFY CDLATITUDE DECIMAL(23,20);
/
ALTER TABLE TBLVPPESQUISAMERCADO MODIFY CDLONGITUDE DECIMAL(23,20);
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPPESQUISAMERCADO ALTER COLUMN CDLATITUDE TYPE DECIMAL(23,20);
ALTER TABLE TBLVPPESQUISAMERCADO ALTER COLUMN CDLONGITUDE TYPE DECIMAL(23,20);
--/POSTGRES

--VERSAO 6.209

/*-------------------------------------------------------------------------
Descricao: Novo campo na tabela TabelaPreco
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPTABELAPRECO ADD FLBLOQUEIADESC2 CHAR(1);
GO

--VERSAO 6.210

/*------------------------------------------------------------------------
Data: 02/02/2019
Autor: Renan
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPPROSPECT (
   CDEMPRESA            		VARCHAR(20)      NOT NULL,
   CDREPRESENTANTE      		VARCHAR(20)      NOT NULL,
   FLORIGEMPROSPECT   			CHAR(1)          NOT NULL,
   CDPROSPECT 	        		VARCHAR(20)      NOT NULL,
   NUCNPJ						VARCHAR(20)		 NULL,
   DTCADASTRO					DATETIME		 NULL,
   NMRAZAOSOCIAL 				VARCHAR(100)	 NULL,
   NUFONE						VARCHAR(20)		 NULL,
   CDTIPOPROPESCT				VARCHAR(20)		 NULL,
   DSCEPCOMERCIAL				VARCHAR(20) 	 NULL,
   DSLOGRADOUROCOMERCIAL		VARCHAR(100)	 NULL,
   DSTIPOLOGRADOUROCOMERCIAL	VARCHAR(20)		 NULL,
   DSNUMEROLOGRADOUROCOMERCIAL	VARCHAR(20)		 NULL,
   DSCOMPLEMENTOCOMERCIAL		VARCHAR(20)		 NULL,
   DSBAIRROCOMERCIAL			VARCHAR(100)	 NULL,
   DSCIDADECOMERCIAL			VARCHAR(100)	 NULL,
   CDUFCOMERCIAL				VARCHAR(20)		 NULL,
   FLTIPOPESSOA					CHAR(1)			 NULL,
   CDLATITUDE					DECIMAL(16,7)	 NULL,
   CDLONGITUDE					DECIMAL(16,7)	 NULL,
   DSEMAIL						VARCHAR(100)	 NULL,
   HRCADASTRO					VARCHAR(8)		 NULL,
   NMFANTASIA					VARCHAR(100)	 NULL,
   NUIERG						VARCHAR(16)		 NULL,
   CDUSUARIOCRIACAO				VARCHAR(20)		 NULL,
   CDUSUARIO				    VARCHAR(8)			NOT NULL,
   NUCARIMBO				    DECIMAL(9,0)			NULL,
   FLTIPOALTERACAO			    CHAR(1)					NULL,
   DTALTERACAO				    DATETIME				NULL,
   HRALTERACAO				    VARCHAR(8)				NULL,
   CONSTRAINT PK_TBLVPPROSPECT PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, FLORIGEMPROSPECT, CDPROSPECT, CDUSUARIO)
)
GO

CREATE TABLE TBLVPFOTOPROSPECT (
   CDEMPRESA            		VARCHAR(20)      NOT NULL,
   CDREPRESENTANTE      		VARCHAR(20)      NOT NULL,
   FLORIGEMPROSPECT   			CHAR(1)          NOT NULL,
   CDPROSPECT 	        		VARCHAR(20)      NOT NULL,
   NMFOTO						VARCHAR(100)	 NOT NULL,
   NUTAMANHO					DECIMAL(9,0)	 NULL,
   DTMODIFICACAO				DATETIME		 NULL,
   CDUSUARIO				    VARCHAR(8)			NOT NULL,
   NUCARIMBO				    DECIMAL(9,0)			NULL,
   FLTIPOALTERACAO			    CHAR(1)					NULL,
   DTALTERACAO				    DATETIME				NULL,
   HRALTERACAO				    VARCHAR(8)				NULL,
   CONSTRAINT PK_TBLVPFOTOPROSPECT PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, FLORIGEMPROSPECT, CDPROSPECT, NMFOTO, CDUSUARIO)
)
GO


--VERSAO 6.211

/*-------------------------------------------------------------------------
Descricao: Nova coluna dtPagamento na tabela TituloFinanceiro
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPTITULOFINANCEIRO ADD DTPAGAMENTO DATE;
GO

/*------------------------------------------------------------------------ 
Descricao: Nova Coluna
-------------------------------------------------------------------------*/ 

ALTER TABLE TBLVPSTATUSPEDIDOPDA ADD CDCORFUNDO DECIMAL(9,0);
GO


/*------------------------------------------------------------------------
Descricao: Nova coluna
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPCLIENTE ADD FLOBRIGAORDEMCOMPRA CHAR(1);
GO

--VERSAO 6.212


/*-------------------------------------------------------------------------
Descricao: Nova tabela
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPMODOFATURAMENTO (
	CDEMPRESA		VARCHAR(20) 		NOT NULL,
	CDREPRESENTANTE		VARCHAR(20)		NOT NULL,
	CDMODOFATURAMENTO	VARCHAR(20)		NOT NULL,
	DSMODOFATURAMENTO	VARCHAR(100)		NULL,
	FLEXIGEOBSERVACAO	CHAR(1)			NULL,
	NUCARIMBO           	DECIMAL(9,0)		NULL,
   	FLTIPOALTERACAO     	CHAR(1)			NULL,
   	CDUSUARIO           	VARCHAR(8)          	NOT NULL,
   	DTALTERACAO         	DATETIME            	NULL,
   	HRALTERACAO         	VARCHAR(8)          	NULL,
   	CONSTRAINT PK_TBLVPMODOFATURAMENTO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDMODOFATURAMENTO, CDUSUARIO)
);
GO

/*-------------------------------------------------------------------------
Descricao: Novos campos na pedido e pedidoerp;
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD CDMODOFATURAMENTO VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDO ADD DSOBSMODOFATURAMENTO VARCHAR(500);
GO

ALTER TABLE TBLVPPEDIDOERP ADD CDMODOFATURAMENTO VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDOERP ADD DSOBSMODOFATURAMENTO VARCHAR(500);
GO


/*-------------------------------------------------------------------------
LAV-21674 - Descrição: Criação da tabela TBLVPCENTROCUSTOPROD e alteração da tabela TBLVPTIPOPEDIDO
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPCENTROCUSTOPROD(
	CDEMPRESA 		VARCHAR(20)  NOT NULL,
	CDREPRESENTANTE VARCHAR(20)  NOT NULL,
	CDCENTROCUSTO 	VARCHAR(20)  NOT NULL,
	CDPRODUTO 		VARCHAR(20)  NOT NULL,
	CDUSUARIO		VARCHAR(8)	 NOT NULL,
	NUCARIMBO		DECIMAL(9,0) NULL,
	FLTIPOALTERACAO CHAR(1)		 NULL,
	DTALTERACAO		DATETIME	 NULL,
	HRALTERACAO		VARCHAR(8)	 NULL,
	CONSTRAINT PK_TBLVPCENTROCUSTOPROD PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDCENTROCUSTO, CDPRODUTO, CDUSUARIO)
)
GO

ALTER TABLE TBLVPTIPOPEDIDO ADD FLOBRIGAINFOCOMPLEMENTAR CHAR(1) NULL;
GO

UPDATE TBLVPTIPOPEDIDO SET FLOBRIGAINFOCOMPLEMENTAR = FLOBRIGAINFOADICIONAL;

ALTER TABLE TBLVPTIPOPEDIDO DROP COLUMN FLOBRIGAINFOADICIONAL;
GO

/*--------------------------------------------------------
NOVAS TABELAS
--------------------------------------------------------*/
CREATE TABLE TBLVPMARCA (
    CDEMPRESA 			VARCHAR(20) 	NOT NULL,
    CDMARCA   			VARCHAR(20)  	NOT NULL,
    DSMARCA				VARCHAR(50)     NULL,
	FLTIPOALTERACAO	    CHAR(1)			NULL,
	NUCARIMBO			DECIMAL(9,0)	NULL,
    DTALTERACAO    		DATETIME        NULL,
    HRALTERACAO     	VARCHAR(8)    	NULL,
	CDUSUARIO			VARCHAR(8)		NOT NULL,
    CONSTRAINT PK_TBLVPMARCA PRIMARY KEY (CDEMPRESA, CDMARCA, CDUSUARIO)
)
GO

CREATE TABLE TBLVPPLATAFORMAVENDA (
    CDEMPRESA 			VARCHAR(20) 	NOT NULL,
    CDPLATAFORMAVENDA  	VARCHAR(20)  	NOT NULL,
    DSPLATAFORMAVENDA	VARCHAR(50)     NULL,
	FLTIPOALTERACAO		CHAR(1)			NULL,
	NUCARIMBO			DECIMAL(9,0)	NULL,
    DTALTERACAO     	DATETIME        NULL,
    HRALTERACAO    		VARCHAR(8)    	NULL,
	CDUSUARIO			VARCHAR(8)		NOT NULL,
    CONSTRAINT PK_TBLVPPLATAFORMAVENDA PRIMARY KEY (CDEMPRESA, CDPLATAFORMAVENDA, CDUSUARIO)
)
GO

CREATE TABLE TBLVPPLATAFORMAVENDACLIENTE (
    CDEMPRESA			VARCHAR(20) 	NOT NULL,
    CDREPRESENTANTE 	VARCHAR(20) 	NOT NULL,
    CDCLIENTE 			VARCHAR(20) 	NOT NULL,
    CDPLATAFORMAVENDA  	VARCHAR(20)  	NOT NULL,
    CDCENTROCUSTO		VARCHAR(20)     NOT NULL,
	FLTIPOALTERACAO		CHAR(1)			NULL,
	NUCARIMBO			DECIMAL(9,0)	NULL,
    DTALTERACAO     	DATETIME        NULL,
    HRALTERACAO     	VARCHAR(8)    	NULL,
	CDUSUARIO			VARCHAR(8)		NOT NULL,
    CONSTRAINT PK_TBLVPPLATAFORMAVENDACLIENTE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, CDPLATAFORMAVENDA, CDCENTROCUSTO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPPLATAFORMAVENDAPRODUTO (
    CDEMPRESA 				VARCHAR(20) 	NOT NULL,
    CDPLATAFORMAVENDA   	VARCHAR(20)  	NOT NULL,
    CDPLATAFORMAVENDAPROD   VARCHAR(20)  	NOT NULL,
    CDMARCA				 	VARCHAR(20) 	NULL,
    CDLINHA 				VARCHAR(20) 	NULL,
	FLTIPOALTERACAO			CHAR(1)			NULL,
	NUCARIMBO				DECIMAL(9,0)	NULL,
    DTALTERACAO     		DATETIME        NULL,
    HRALTERACAO     		VARCHAR(8)     	NULL,
	CDUSUARIO				VARCHAR(8)		NOT NULL,
    CONSTRAINT PK_TBLVPPLATAFORMAVENDAPRODUTO PRIMARY KEY (CDEMPRESA, CDPLATAFORMAVENDA, CDPLATAFORMAVENDAPROD, CDUSUARIO)
)
GO

CREATE TABLE TBLVPLINHA (
   CDEMPRESA           	VARCHAR(20)     NOT NULL,
   CDLINHA             	VARCHAR(20)      NOT NULL,
   DSLINHA              VARCHAR(50)     NULL,
   FLTIPOALTERACAO      CHAR(1)         NULL,
   NUCARIMBO			DECIMAL(9,0)	NULL,
   DTALTERACAO     		DATETIME        NULL,
   HRALTERACAO     		VARCHAR(8)     	NULL,
   CDUSUARIO			VARCHAR(8)		NOT NULL,
   CONSTRAINT PK_TBLVPLINHA PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDLINHA, CDUSUARIO)
)
GO

/*--------------------------------------------------------
ALTERACOES DE TABELAS
--------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD CDPLATAFORMAVENDA VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDOERP ADD CDPLATAFORMAVENDA VARCHAR(20);
GO
ALTER TABLE TBLVPPRODUTO ADD CDMARCA VARCHAR(20);
GO


/*-------------------------------------------------------------------------
NOVA COLUNA
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDOERP ADD CDREPRESENTANTEORG VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDO ADD CDREPRESENTANTEORG VARCHAR(20);
GO

--VERSAO 6.213

/*-------------------------------------------------------------------------
LAV-22424
Autor: Renan
Descrição: Alteração coluna
-------------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPPRODUTO ALTER COLUMN DSPRINCIPIOATIVO VARCHAR(4000);
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPPRODUTO MODIFY DSPRINCIPIOATIVO VARCHAR(4000);
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPPRODUTO ALTER COLUMN DSPRINCIPIOATIVO TYPE VARCHAR(4000);
--/POSTGRES

/*------------------------------------------------------------------------
Novas colunas LAV-23405
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDOERP ADD CDCONTACORRENTE VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDOERP ADD DTVERBASALDOCALCULADA DATETIME;
GO
ALTER TABLE TBLVPPEDIDO ADD CDCONTACORRENTE VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDO ADD DTVERBASALDOCALCULADA DATETIME;
GO

--VERSAO 6.214

/*------------------------------------------------------------------------
Atividade: LAV-21855 - ICONIC - Sistema de pontuação por litro
Descrição: Criação da tabela TBLVPPONTUACAOCONFIG
Autor: Raphael Santos
Data: 16/12/2019
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPPONTUACAOCONFIG (
	CDEMPRESA 				VARCHAR(20)   NOT NULL,
	CDREPRESENTANTE 		VARCHAR(20)   NOT NULL,
	CDPONTUACAOCONFIG  		VARCHAR(20)   NOT NULL,
	DSCIDADECOMERCIAL   	VARCHAR(100)  	  NULL,
	DSPONTUACAOCONFIG   	VARCHAR(100)  	  NULL,
	CDSEGMENTOPONTUACAO   	VARCHAR(100)   	  NULL,
	CDCANALPONTUACAO  	 	VARCHAR(100)	  NULL,
	DTINICIOVIGENCIA      	DATETIME          NULL,
	DTFIMVIGENCIA         	DATETIME          NULL,
 	NUCARIMBO            	DECIMAL(9,0)      NULL,
   	FLTIPOALTERACAO      	CHAR(1)           NULL,
   	CDUSUARIO            	VARCHAR(8)    NOT NULL,
   	DTALTERACAO          	DATETIME          NULL,
   	HRALTERACAO          	VARCHAR(8)        NULL,
	CONSTRAINT PK_TBLVPPONTUACAOCONFIG PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDPONTUACAOCONFIG, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------
Atividade: LAV-21855 - ICONIC - Sistema de pontuação por litro
Descrição: Criação da tabela TBLVPPONTUACAOFAIXADIAS
Autor: Raphael Santos
Data: 17/12/2019
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPPONTUACAOFAIXADIAS (
	CDEMPRESA 				VARCHAR(20)   NOT NULL,
	CDREPRESENTANTE 		VARCHAR(20)   NOT NULL,
	CDPONTUACAOCONFIG  		VARCHAR(20)   NOT NULL,
	FLTIPOFATORCORRECAO    	CHAR(1)  	  NOT NULL,
	QTDIASMEDIOS  	    	DECIMAL(9,0)  NOT NULL,
	VLFATORCORRECAO       	DECIMAL(16,7)     NULL,
 	NUCARIMBO            	DECIMAL(9,0)      NULL,
   	FLTIPOALTERACAO      	CHAR(1)           NULL,
   	CDUSUARIO            	VARCHAR(8)    NOT NULL,
   	DTALTERACAO          	DATETIME          NULL,
   	HRALTERACAO          	VARCHAR(8)        NULL,
	CONSTRAINT PK_TBLVPPONTUACAOFAIXADIAS PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDPONTUACAOCONFIG, FLTIPOFATORCORRECAO, QTDIASMEDIOS, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------
Atividade: LAV-21855 - ICONIC - Sistema de pontuação por litro
Descrição: Criação da tabela TBLVPPONTUACAOFAIXAPRECO
Autor: Raphael Santos
Data: 17/12/2019
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPPONTUACAOFAIXAPRECO (
	CDEMPRESA 				VARCHAR(20)   NOT NULL,
	CDREPRESENTANTE 		VARCHAR(20)   NOT NULL,
	CDPONTUACAOCONFIG  		VARCHAR(20)   NOT NULL,
	FLTIPOFATORCORRECAO    	CHAR(1)  	  NOT NULL,
	VLPCTFAIXA  	    	DECIMAL(16,7) NOT NULL,
	VLFATORCORRECAO       	DECIMAL(16,7)     NULL,
 	NUCARIMBO            	DECIMAL(9,0)      NULL,
   	FLTIPOALTERACAO      	CHAR(1)           NULL,
   	CDUSUARIO            	VARCHAR(8)    NOT NULL,
   	DTALTERACAO          	DATETIME          NULL,
   	HRALTERACAO          	VARCHAR(8)        NULL,
	CONSTRAINT PK_TBLVPPONTUACAOFAIXAPRECO PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDPONTUACAOCONFIG, FLTIPOFATORCORRECAO, VLPCTFAIXA, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------
Atividade: LAV-21855 - ICONIC - Sistema de pontuação por litro
Descrição: Criação da tabela TBLVPPONTUACAOPRODUTO
Autor: Raphael Santos
Data: 17/12/2019
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPPONTUACAOPRODUTO (
	CDEMPRESA 				VARCHAR(20)   NOT NULL,
	CDREPRESENTANTE 		VARCHAR(20)   NOT NULL,
	CDPONTUACAOCONFIG  		VARCHAR(20)   NOT NULL,
	CDPRODUTO    			VARCHAR(20)   NOT NULL,
	VLPESOPONTUACAO       	DECIMAL(16,7)     NULL,
 	NUCARIMBO            	DECIMAL(9,0)      NULL,
   	FLTIPOALTERACAO      	CHAR(1)           NULL,
   	CDUSUARIO            	VARCHAR(8)    NOT NULL,
   	DTALTERACAO          	DATETIME          NULL,
   	HRALTERACAO          	VARCHAR(8)        NULL,
	CONSTRAINT PK_TBLVPPONTUACAOPRODUTO PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDPONTUACAOCONFIG, CDPRODUTO, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------
Atividade: LAV-21855 - ICONIC - Sistema de pontuação por litro
Descrição: Criação das colunas VLPONTUACAOBASEITEM, VLPONTUACAOREALIZADOITEM na tabela TBLVPITEMPEDIDO e TBLVPITEMPEDIDOERP
Autor: Raphael Santos
Data: 17/12/2019
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD VLPONTUACAOBASEITEM DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPONTUACAOBASEITEM DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLPONTUACAOREALIZADOITEM DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPONTUACAOREALIZADOITEM DECIMAL(16,7);
GO

/*------------------------------------------------------------------------
Atividade: LAV-21855 - ICONIC - Sistema de pontuação por litro
Descrição: Criação das colunas VLTOTALPONTUACAOBASE, VLTOTALPONTUACAOREALIZADO na tabela TBLVPPEDIDO e TBLVPPEDIDOERP
Autor: Raphael Santos
Data: 17/12/2019
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD VLTOTALPONTUACAOBASE DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDOERP ADD VLTOTALPONTUACAOBASE DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDO ADD VLTOTALPONTUACAOREALIZADO DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDOERP ADD VLTOTALPONTUACAOREALIZADO DECIMAL(16,7);
GO

/*------------------------------------------------------------------------
Atividade: LAV-21855 - ICONIC - Sistema de pontuação por litro
Descrição: Criação das colunas CDCANALPONTUACAO, CDSEGMENTOPONTUACAO na tabela TBLVPCLIENTE
Autor: Raphael Santos
Data: 18/12/2019
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCLIENTE ADD CDCANALPONTUACAO VARCHAR(100);
GO

ALTER TABLE TBLVPCLIENTE ADD CDSEGMENTOPONTUACAO VARCHAR(100);
GO

/*------------------------------------------------------------------------
Atividade: LAV-21855 - ICONIC - Sistema de pontuação por litro
Descrição: Criação das colunas VLTOTALPONTUACAOBASE, VLTOTALPONTUACAOREALIZADO na tabela TBLVPRESUMODIA
Autor: Raphael Santos
Data: 24/12/2019
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPRESUMODIA ADD VLTOTALPONTUACAOBASE DECIMAL(16,7);
GO

ALTER TABLE TBLVPRESUMODIA ADD VLTOTALPONTUACAOREALIZADO DECIMAL(16,7);
GO

/*------------------------------------------------------------------------
Atividade: LAV-21855 - ICONIC - Sistema de pontuação por litro
Descrição: Criação da tabela TBLVPPONTEXTPED
Autor: Raphael Santos
Data: 09/01/2020
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPPONTEXTPED (
	CDEMPRESA 				VARCHAR(20)   NOT NULL,
	CDREPRESENTANTE 		VARCHAR(20)   NOT NULL,
    FLORIGEMPEDIDO  		CHAR(1)		  NOT NULL,
    NUPEDIDO      			VARCHAR(30)   NOT NULL,
    DSTIPOLANCAMENTO		VARCHAR(100) 	  NULL,
	VLPONTUACAOBASE       	DECIMAL(16,7)     NULL,
	VLPONTUACAOREALIZADO   	DECIMAL(16,7)     NULL,
	VLTOTALPEDIDO			DECIMAL(16,7)     NULL,
	QTDIASMEDIOS   			DECIMAL(9,0)      NULL,
    FLPEDIDOCANCELADO		VARCHAR(1)	  	  NULL,
   	DTEMISSAO           	DATETIME          NULL,
   	HREMISSAO            	VARCHAR(8)        NULL,
 	NUCARIMBO            	DECIMAL(9,0)      NULL,
   	FLTIPOALTERACAO      	CHAR(1)           NULL,
   	CDUSUARIO            	VARCHAR(8)    NOT NULL,
   	DTALTERACAO          	DATETIME          NULL,
   	HRALTERACAO          	VARCHAR(8)        NULL,
	CONSTRAINT PK_TBLVPPONTEXTPED PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, FLORIGEMPEDIDO, NUPEDIDO, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------
Atividade: LAV-21855 - ICONIC - Sistema de pontuação por litro
Descrição: Criação das colunas VLPESOPONTUACAO, VLFATORCORRECAOFAIXAPRECO, VLFATORCORRECAOFAIXADIAS, VLPCTFAIXAPRECOPONTUACAO, VLBASEPONTUACAO, VLPCTDIFFAIXAPRECOPONTUACAO na tabela TBLVPITEMPEDIDO e TBLVPITEMPEDIDOERP
Autor: Raphael Santos
Data: 16/01/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD VLPESOPONTUACAO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPESOPONTUACAO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLFATORCORRECAOFAIXAPRECO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLFATORCORRECAOFAIXAPRECO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLFATORCORRECAOFAIXADIAS DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLFATORCORRECAOFAIXADIAS DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTFAIXAPRECOPONTUACAO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTFAIXAPRECOPONTUACAO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLBASEPONTUACAO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLBASEPONTUACAO DECIMAL(16,7);
GO

/*------------------------------------------------------------------------
Atividade: LAV-21855 - ICONIC - Sistema de pontuação por litro
Descrição: Criação da coluna QTDIASFAIXAPONTUACAO na tabela TBLVPPEDIDO e TBLVPPEDIDOERP
Autor: Raphael Santos
Data: 16/01/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD QTDIASFAIXAPONTUACAO DECIMAL(9,0);
GO

ALTER TABLE TBLVPPEDIDOERP ADD QTDIASFAIXAPONTUACAO DECIMAL(9,0);
GO

/*------------------------------------------------------------------------
Atividade: LAV-21855 - ICONIC - Sistema de pontuação por litro
Descrição: Criação da coluna VLBASEPONTUACAO na tabela TBLVPITEMTABELAPRECO
Autor: Raphael Santos
Data: 16/01/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLBASEPONTUACAO DECIMAL(16,7);
GO

/*------------------------------------------------------------------------
Atividade: LAV-21855 - ICONIC - Sistema de pontuação por litro
Descrição: Criação da tabela TBLVPPONTEXTITEMPED
Autor: Raphael Santos
Data: 17/12/2019
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPPONTEXTITEMPED (
	CDEMPRESA 					VARCHAR(20)   NOT NULL,
	CDREPRESENTANTE 			VARCHAR(20)   NOT NULL,
    FLORIGEMPEDIDO  			CHAR(1)		  NOT NULL,
    NUPEDIDO      				VARCHAR(30)   NOT NULL,
	CDPRODUTO		 			VARCHAR(20)   NOT NULL,
    FLTIPOITEMPEDIDO  			CHAR(1)		  NOT NULL,
    NUSEQPRODUTO         		DECIMAL(9,0)  NOT NULL,
    FLTIPOLANCAMENTO			VARCHAR(1)	  NOT NULL,
    DSTIPOLANCAMENTO			VARCHAR(100) 	  NULL,
    QTITEMFISICO       			DECIMAL(16,7)     NULL,
    CDUNIDADE       			VARCHAR(20)       NULL,
    NUCONVERSAOUNIDADE       	DECIMAL(16,7)     NULL,
    QTITEMFATURAMENTO       	DECIMAL(16,7)     NULL,
    VLTOTALITEMPEDIDO       	DECIMAL(16,7)     NULL,
    VLPESOPONTUACAO       		DECIMAL(16,7)     NULL,
    VLFATORCORRECAOFAIXAPRECO 	DECIMAL(16,7)     NULL,
    VLFATORCORRECAOFAIXADIAS 	DECIMAL(16,7)     NULL,
    VLPCTFAIXAPRECOPONTUACAO  	DECIMAL(16,7)     NULL,
    VLBASEPONTUACAO       		DECIMAL(16,7)     NULL,
	VLPONTUACAOBASE       		DECIMAL(16,7)     NULL,
	VLPONTUACAOREALIZADO   		DECIMAL(16,7)     NULL,
   	DTEMISSAO           		DATETIME          NULL,
   	HREMISSAO            		VARCHAR(8)        NULL,
 	NUCARIMBO            		DECIMAL(9,0)      NULL,
   	FLTIPOALTERACAO      		CHAR(1)           NULL,
   	CDUSUARIO            		VARCHAR(8)    NOT NULL,
   	DTALTERACAO          		DATETIME          NULL,
   	HRALTERACAO          		VARCHAR(8)        NULL,
	CONSTRAINT PK_TBLVPPONTEXTITEMPED PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, FLORIGEMPEDIDO, NUPEDIDO, CDPRODUTO, FLTIPOITEMPEDIDO, NUSEQPRODUTO, FLTIPOLANCAMENTO, CDUSUARIO)
)
GO

--VERSAO 6.215

--VERSAO 6.216


/*--------------------------------------------------------
LAV-21661 - NOVAS TABELAS
--------------------------------------------------------*/

CREATE TABLE TBLVPPOLITICACOMERCIAL (
	CDEMPRESA	VARCHAR(20) 	NOT NULL,
	CDPOLITICACOMERCIAL	VARCHAR(20) 	NOT NULL,
	DTINIVIGENCIA	DATETIME	NULL,
	DTFIMVIGENCIA	DATETIME	NULL,
	FLCAMPANHA	CHAR(1)	NULL,
	CDPRODUTO	VARCHAR(20) 	NULL,
	CDLINHA	VARCHAR(20) 	NULL,
	CDCLASSE	VARCHAR(20) 	NULL,
	CDGRUPOPRODUTO1	VARCHAR(20) 	NULL,
	CDCONJUNTO	VARCHAR(20) 	NULL,
	CDMARCA	VARCHAR(20) 	NULL,
	CDCOLECAO	VARCHAR(20) 	NULL,
	CDSTATUSCOLECAO 	VARCHAR(20) 	NULL,
	CDFAMILIA	VARCHAR(20) 	NULL,
	VLINDICECLIENTE	DECIMAL(16,7)	NULL,
	CDCENTROCUSTO	VARCHAR(20) 	NULL,
	CDREPRESENTANTEPOLITICA	VARCHAR(20) 	NULL,
	CDCATEGORIA	VARCHAR(20) 	NULL,
	CDCLIENTE	VARCHAR(20) 	NULL,
	CDGRUPODESCCLI	VARCHAR(20) 	NULL,			
	CDTABELAPRECO	VARCHAR(20) 	NULL,
	CDCONDICAOPAGAMENTO	VARCHAR(20) 	NULL,
	FLACUMULAINDICES	CHAR(1)	NULL,
	FLATIVO	CHAR(1)		    NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	NUCARIMBO	DECIMAL(9,0)	NULL,
	DTALTERACAO	DATETIME        NULL,
	HRALTERACAO	VARCHAR(8)    	NULL,
	CDUSUARIO	VARCHAR(8)		NOT NULL,
	CONSTRAINT PK_TBLVPPOLITICACOMERCIAL PRIMARY KEY (CDEMPRESA, CDPOLITICACOMERCIAL, CDUSUARIO)
)
GO

CREATE TABLE TBLVPPOLITICACOMERCIALFAIXA (
	CDEMPRESA	VARCHAR(20) 	NOT NULL,
	CDPOLITICACOMERCIAL	VARCHAR(20) 	NOT NULL,
	VLPCTPOLITICACOMERCIAL	DECIMAL(16,7)	NOT NULL,
	VLPCTCOMISSAO	DECIMAL(16,7)	NULL,
	FLATIVO	CHAR(1)		    NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	NUCARIMBO	DECIMAL(9,0)	NULL,
	DTALTERACAO	DATETIME        NULL,
	HRALTERACAO	VARCHAR(8)    	NULL,
	CDUSUARIO	VARCHAR(8)		NOT NULL,
	CONSTRAINT PK_TBLVPPOLITICACOMERCIALFAIXA PRIMARY KEY (CDEMPRESA, CDPOLITICACOMERCIAL, VLPCTPOLITICACOMERCIAL, CDUSUARIO)
)
GO

CREATE TABLE TBLVPCONJUNTO (
	CDEMPRESA	VARCHAR(20) 	NOT NULL,
	CDCONJUNTO	VARCHAR(20) 	NOT NULL,
	DSCONJUNTO	VARCHAR(100)	NULL,
	FLATIVO	CHAR(1)		    NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	NUCARIMBO	DECIMAL(9,0)	NULL,
	DTALTERACAO	DATETIME        NULL,
	HRALTERACAO	VARCHAR(8)    	NULL,
	CDUSUARIO	VARCHAR(8)		NOT NULL,
    CONSTRAINT PK_TBLVPCONJUNTO PRIMARY KEY (CDEMPRESA, CDCONJUNTO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPCOLECAO (
	CDEMPRESA	VARCHAR(20) 	NOT NULL,
	CDMARCA	VARCHAR(20) 	NOT NULL,
	CDCOLECAO	VARCHAR(20) 	NOT NULL,
	DSCOLECAO	VARCHAR(100)	NULL,
	FLATIVO	CHAR(1)		    NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	NUCARIMBO	DECIMAL(9,0)	NULL,
	DTALTERACAO	DATETIME        NULL,
	HRALTERACAO	VARCHAR(8)    	NULL,
	CDUSUARIO	VARCHAR(8)		NOT NULL,
    CONSTRAINT PK_TBLVPCOLECAO PRIMARY KEY (CDEMPRESA, CDMARCA, CDCOLECAO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPCOLECAOSTATUS (
	CDEMPRESA	VARCHAR(20) 	NOT NULL,
	CDSTATUSCOLECAO	VARCHAR(20) 	NOT NULL,
	DSSTATUSCOLECAO	VARCHAR(100)	NULL,
	FLATIVO	CHAR(1)		    NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	NUCARIMBO	DECIMAL(9,0)	NULL,
	DTALTERACAO	DATETIME        NULL,
	HRALTERACAO	VARCHAR(8)    	NULL,
	CDUSUARIO	VARCHAR(8)		NOT NULL,
    CONSTRAINT PK_TBLVPCOLECAOSTATUS PRIMARY KEY (CDEMPRESA, CDSTATUSCOLECAO, CDUSUARIO)
)
GO

/*==============================================================*/
/* TABLE: TBLVPFAMILIAPRODUTO                                   */
/*==============================================================*/

CREATE TABLE TBLVPFAMILIAPRODUTO (
	CDEMPRESA            VARCHAR(20)          NOT NULL,
	CDFAMILIA            VARCHAR(20)          NOT NULL,
	CDPRODUTO            VARCHAR(20)          NOT NULL,
	FLATIVO	CHAR(1)		    NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	NUCARIMBO	DECIMAL(9,0)	NULL,
	DTALTERACAO	DATETIME        NULL,
	HRALTERACAO	VARCHAR(8)    	NULL,
	CDUSUARIO	VARCHAR(8)		NOT NULL,
   CONSTRAINT PK_TBLVPFAMILIAPRODUTO PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDFAMILIA, CDPRODUTO, CDUSUARIO)
)
GO

/*--------------------------------------------------------
LAV-21661 - ALTERAÇÕES DE TABELAS
--------------------------------------------------------*/

ALTER TABLE TBLVPPRODUTO ADD CDCONJUNTO VARCHAR(20);
GO
ALTER TABLE TBLVPPRODUTO ADD CDCOLECAO VARCHAR(20);
GO
ALTER TABLE TBLVPPRODUTO ADD CDSTATUSCOLECAO VARCHAR(20);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD CDPOLITICACOMERCIAL VARCHAR(20);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTPOLITICACOMERCIAL DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD CDPOLITICACOMERCIAL VARCHAR(20);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTPOLITICACOMERCIAL DECIMAL(9,0);
GO


/*-------------------------------------------------------------------------
Descricao: Novas colunas na ClienteEndereco, Pedido e NovoCliEndereco.
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCLIENTEENDERECO ADD FLCOBRANCA CHAR;
GO

ALTER TABLE TBLVPCLIENTEENDERECO ADD FLCOBRANCAPADRAO CHAR;
GO

ALTER TABLE TBLVPPEDIDO ADD CDENDERECOCOBRANCA VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDOERP ADD CDENDERECOCOBRANCA VARCHAR(20);
GO

ALTER TABLE TBLVPNOVOCLIENDERECO ADD FLCOBRANCA CHAR;
GO

ALTER TABLE TBLVPNOVOCLIENDERECO ADD FLCOBRANCAPADRAO CHAR;
GO

/*-------------------------------------------------------------------------
Descricao: Criacao de nova tabela
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPPEDIDORELACIONADO(
	CDEMPRESA 	VARCHAR(20) 	NOT NULL,
	CDREPRESENTANTE VARCHAR(20) 	NOT NULL,
	NUPEDIDO 	VARCHAR(30) 	NOT NULL,
	FLORIGEMPEDIDO 	CHAR(1) 		NOT NULL,
	CDEMPRESAREL 	VARCHAR(20) 	NOT NULL,
	CDREPRESENTANTEREL VARCHAR(20) 	NOT NULL,
	NUPEDIDOREL 	VARCHAR(30) 	NOT NULL,
	FLORIGEMPEDIDOREL CHAR(1) 		NOT NULL,
	FLTIPOALTERACAO CHAR(1) 		NULL,
	FLTIPORELACIONAMENTO CHAR(1) 	NOT NULL,
	CDUSUARIO 	VARCHAR(8) 	NOT NULL,
	NUCARIMBO 	DECIMAL(9) 	NULL,
	DTALTERACAO 	DATETIME	NULL,
	HRALTERACAO 	VARCHAR(8)	NULL,
	CONSTRAINT PK_TBLVPPEDIDORELACIONADO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, NUPEDIDO, FLORIGEMPEDIDO, CDEMPRESAREL, CDREPRESENTANTEREL, NUPEDIDOREL, FLORIGEMPEDIDOREL, FLTIPORELACIONAMENTO, CDUSUARIO)
);
GO

ALTER TABLE TBLVPTIPOPEDIDO ADD FLPRODUCAO CHAR(1);
GO

/*-------------------------------------------------------------------------
NOVAS COLUNAS
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPCONDICAOPAGAMENTO ADD FLPERMITEEDITARPARCELAS VARCHAR(1) NULL;
GO

ALTER TABLE TBLVPPEDIDO ADD NUPARCELAS DECIMAL(9,0) NULL;
GO

ALTER TABLE TBLVPPEDIDOERP ADD NUPARCELAS DECIMAL(9,0) NULL;
GO


/*-------------------------------------------------------------------------
Descrição: Nova coluna na Produto.
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMTABELAPRECO ADD VLINDICECOMISSAO DECIMAL(16,7);
GO


/*------------------------------------------------------------------------
Descrição: Novas Tabelas
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPREQUISICAOSERVTIPO (
   CDREQUISICAOSERVTIPO VARCHAR(20)	     	 NOT NULL,
   DSREQUISICAOSERVTIPO VARCHAR(100)	     	 NULL,
   FLOBRIGACLIENTE		CHAR(1)		     		 NULL,
   NUCARIMBO            DECIMAL(9,0)         	 NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   FLTIPOALTERACAO      CHAR(1)              	 NULL,
   DTALTERACAO          DATETIME             	 NULL,
   HRALTERACAO          VARCHAR(8)           	 NULL,
   CONSTRAINT PK_TBLVPREQUISICAOSERVTIPO PRIMARY KEY NONCLUSTERED (CDREQUISICAOSERVTIPO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPREQUISICAOSERVMOTIVO (
   CDREQUISICAOSERVMOTIVO 		 VARCHAR(20)	      NOT NULL,
   DSREQUISICAOSERVMOTIVO 		 VARCHAR(100)         	  NULL,
   FLUSOMOTIVO				 	 CHAR(1)	      		  NULL,
   FLOBRIGAOBSERVACAO			 CHAR(1)	      		  NULL,
   FLSTATUSREQUISICAO			 CHAR(1)	      		  NULL,
   NUCARIMBO           			 DECIMAL(9,0)         	  NULL,
   CDUSUARIO            		 VARCHAR(8)           NOT NULL,
   FLTIPOALTERACAO      		 CHAR(1)              	  NULL,
   DTALTERACAO          		 DATETIME             	  NULL,
   HRALTERACAO          		 VARCHAR(8)           	  NULL,
   CONSTRAINT PK_TBLVPREQUISICAOSERVMOTIVO PRIMARY KEY NONCLUSTERED (CDREQUISICAOSERVMOTIVO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPREQUISICAOSERVTIPMOT (
   CDEMPRESA           			 VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      		 VARCHAR(20)          NOT NULL,
   CDREQUISICAOSERVTIPO 		 VARCHAR(20)	      NOT NULL,
   CDREQUISICAOSERVMOTIVO 		 VARCHAR(20)	      NOT NULL,
   NUCARIMBO           			 DECIMAL(9,0)         	  NULL,
   CDUSUARIO            		 VARCHAR(8)           NOT NULL,
   FLTIPOALTERACAO      		 CHAR(1)              	  NULL,
   DTALTERACAO          		 DATETIME             	  NULL,
   HRALTERACAO          		 VARCHAR(8)           	  NULL,
   CONSTRAINT PK_TBLVPREQUISICAOSERVTIPMOT PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDREQUISICAOSERVMOTIVO,  CDREQUISICAOSERVTIPO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPREQUISICAOSERV (
   CDEMPRESA           			 VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      		 VARCHAR(20)          NOT NULL,
   CDREQUISICAOSERV 		 	 VARCHAR(20)	      NOT NULL,
   CDREQUISICAOSERVMOTIVO 		 VARCHAR(20)	          NULL,
   CDREQUISICAOSERVTIPO 		 VARCHAR(20)	          NULL,
   DTREQUISICAOSERV			 	 DATETIME	      		  NULL,
   HRREQUISICAOSERV              VARCHAR(8)	     		  NULL,
   DSOBSERVACAO				 	 VARCHAR(1000)	      	  NULL,
   CDCLIENTE				 	 VARCHAR(20)	      	  NULL,
   NUCARIMBO           			 DECIMAL(9,0)         	  NULL,
   CDUSUARIO            		 VARCHAR(8)           NOT NULL,
   FLTIPOALTERACAO      		 CHAR(1)              	  NULL,
   DTALTERACAO          		 DATETIME             	  NULL,
   HRALTERACAO          		 VARCHAR(8)           	  NULL,
   CONSTRAINT PK_TBLVPREQUISICAOSERV PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDREQUISICAOSERV, CDUSUARIO)
)
GO

CREATE TABLE TBLVPREQUISICAOSERVRESP (
   CDEMPRESA           			 VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      		 VARCHAR(20)          NOT NULL,
   CDREQUISICAOSERV 		 	 VARCHAR(20)	      NOT NULL,
   CDREQUISICAOSERVRESP 		 VARCHAR(20)	      NOT NULL,
   CDREQUISICAOSERVMOTIVORET 	 VARCHAR(20)	      	  NULL,
   DTREQUISICAOSERVRESP			 DATETIME	      		  NULL,
   HRREQUISICAOSERVRESP          VARCHAR(8)	      	      NULL,
   DSOBSERVACAO				 	 VARCHAR(1000)	      	  NULL,
   CDUSUARIOCRIACAO			 	 VARCHAR(20)	      	  NULL,
   NUCARIMBO           			 DECIMAL(9,0)         	  NULL,
   CDUSUARIO            		 VARCHAR(8)           NOT NULL,
   FLTIPOALTERACAO      		 CHAR(1)              	  NULL,
   DTALTERACAO          		 DATETIME             	  NULL,
   HRALTERACAO          		 VARCHAR(8)           	  NULL,
   CONSTRAINT PK_TBLVPREQUISICAOSERVRESP PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDREQUISICAOSERV, CDREQUISICAOSERVRESP, CDUSUARIO)
)
GO

--VERSAO 6.217

/*-------------------------------------------------------------------------
Descrição: LAV-21800 - Novas tabelas e parâmetro
Autor: João Henrique
------------------------------------------------------------------------*/
CREATE TABLE TBLVPMENUCATEGORIA (
    CDEMPRESA               VARCHAR(20)         NOT NULL,
    CDREPRESENTANTE         VARCHAR(20)         NOT NULL,
    CDMENU                  VARCHAR(20)         NOT NULL,
    CDMENUPAI               VARCHAR(20)             NULL,
    DSMENU                  VARCHAR(100)            NULL,
    IMFOTO                  IMAGE                   NULL,
    NMFOTO                  VARCHAR(100)            NULL,
    FLMOSTRAPRODUTOS        CHAR(1)                 NULL,
    FLMOSTRAPRODUTOSFILHOS  CHAR(1)                 NULL,
    FLPRINCIPAL             CHAR(1)                 NULL,
	CDUSUARIO				VARCHAR(8)			NOT NULL,
	NUCARIMBO				DECIMAL(9,0)			NULL,
	FLTIPOALTERACAO			CHAR(1)					NULL,
	DTALTERACAO				DATETIME				NULL,
	HRALTERACAO				VARCHAR(8)				NULL,
	CONSTRAINT		PK_TBLVPMENUCATEGORIA	PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDMENU, CDUSUARIO)
)
GO

CREATE TABLE TBLVPPRODUTOMENUCATEGORIA (
    CDEMPRESA               VARCHAR(20)         NOT NULL,
    CDREPRESENTANTE         VARCHAR(20)         NOT NULL,
    CDMENU                  VARCHAR(20)         NOT NULL,
    CDPRODUTO               VARCHAR(20)         NOT NULL,
	CDUSUARIO				VARCHAR(8)			NOT NULL,
	NUCARIMBO				DECIMAL(9,0)			NULL,
	FLTIPOALTERACAO			CHAR(1)					NULL,
	DTALTERACAO				DATETIME				NULL,
	HRALTERACAO				VARCHAR(8)				NULL,
	CONSTRAINT		PK_TBLVPPRODUTOMENUCATEGORIA	PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDMENU, CDPRODUTO, CDUSUARIO)
)
GO

--VERSAO 6.218

/*------------------------------------------------------------------------
Atividade: LAV-23011
Data: 05/02/2020
Autor: Gustavo Heidemann
Descrição: Novas Colunas
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMPEDIDO ADD CDCULTURA VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD CDPRAGA VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLDOSE VARCHAR(50);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD CDCULTURA VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD CDPRAGA VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLDOSE VARCHAR(50);
GO

ALTER TABLE TBLVPGRUPOPRODUTO1 ADD FLOBRIGACULTURAPRAGA CHAR(1);
GO

/*------------------------------------------------------------------------
Atividade: LAV-23011
Data: 05/02/2020
Autor: Gustavo Heidemann
Descrição: Novas Tabelas
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPCULTURA (
   CDCULTURA            VARCHAR(20)          NOT NULL,
   DSCULTURA      	VARCHAR(100)         	 	 NULL,
   DSNOMECIENTCULTURA	VARCHAR(100)         	 NULL,
   ABREVCULTURA         VARCHAR(100)         	 NULL,
   NUCARIMBO            DECIMAL(9,0)         	 NULL,
   FLTIPOALTERACAO      CHAR(1)              	 NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             	 NULL,
   HRALTERACAO          VARCHAR(8)           	 NULL,
   CONSTRAINT PK_TBLVPCULTURA PRIMARY KEY NONCLUSTERED (CDCULTURA, CDUSUARIO)
)
GO

CREATE TABLE TBLVPPRAGA (
   CDPRAGA		VARCHAR(20)          		 NOT NULL,
   DSPRAGA      	VARCHAR(100)         	 	 NULL,
   DSNOMECIENTPRAGA	VARCHAR(100)         	 	 NULL,
   NUCARIMBO            DECIMAL(9,0)         	 NULL,
   FLTIPOALTERACAO      CHAR(1)              	 NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             	 NULL,
   HRALTERACAO          VARCHAR(8)           	 NULL,
   CONSTRAINT PK_TBLVPPRAGA PRIMARY KEY NONCLUSTERED (CDPRAGA, CDUSUARIO)
)
GO

CREATE TABLE TBLVPAPLICACAOPRODUTO (
   CDPRODUTO		VARCHAR(20)          	 NOT NULL,
   CDCULTURA		VARCHAR(20)	     		 NOT NULL,
   CDPRAGA		VARCHAR(20)	     			 NOT NULL,
   VLDOSE		VARCHAR(50)		 				 NULL,
   NUCARIMBO            DECIMAL(9,0)         	 NULL,
   FLTIPOALTERACAO      CHAR(1)              	 NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             	 NULL,
   HRALTERACAO          VARCHAR(8)           	 NULL,
   CONSTRAINT PK_TBLVPAPLICACAOPRODUTO PRIMARY KEY NONCLUSTERED (CDPRODUTO, CDCULTURA, CDPRAGA, CDUSUARIO)
)
GO

/*------------------------------------------------------------------
LAV-24449 - Reinclução da coluna VLLITRO nos scripts
Autor: Gabriel Guedes
Data: 06/03/2020
--------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTO ADD VLLITRO DECIMAL(16,7);
GO

/*------------------------------------------------------------------
LAV-24187 - Correções de inconsistências entre bancos APP e WEB
Autor: Gabriel Guedes
Data: 27/02/2020
--------------------------------------------------------------------*/

/*------------------------------------------------------------------
Descrição: Correção tipo coluna VLPCTFRETE na TBLVPEMPRESA
--------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPEMPRESA ALTER COLUMN VLPCTFRETE DECIMAL(16,7) NULL;
GO
--/SQLSERVER

--ORACLE
CREATE TABLE TMPEMPRESA (
    CDEMPRESA VARCHAR(20),
    CDUSUARIO VARCHAR(20),
    VLPCTFRETE NUMBER(15,0),
    CONSTRAINT PK_TMPEMPRESA PRIMARY KEY (CDEMPRESA, CDUSUARIO)
);
/

INSERT INTO TMPEMPRESA SELECT CDEMPRESA, CDUSUARIO, VLPCTFRETE FROM TBLVPEMPRESA;

ALTER TABLE TBLVPEMPRESA DROP COLUMN VLPCTFRETE;
/

ALTER TABLE TBLVPEMPRESA ADD VLPCTFRETE NUMBER(16, 7) NULL;
/

UPDATE TBLVPEMPRESA SET VLPCTFRETE = (SELECT VLPCTFRETE FROM TMPEMPRESA WHERE TBLVPEMPRESA.CDEMPRESA = CDEMPRESA AND TBLVPEMPRESA.CDUSUARIO = CDUSUARIO);
/

DROP TABLE TMPEMPRESA;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPEMPRESA ALTER COLUMN VLPCTFRETE TYPE DECIMAL(16,7);
--/POSTGRES

/*-------------------------------------------------------------------
Descrição: Tamanho da coluna NUPEDIDO na TBLVPITEMNOTAFISCAL
           inconsistente.
---------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPITEMNOTAFISCAL ALTER COLUMN NUPEDIDO VARCHAR(30);
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPITEMNOTAFISCAL MODIFY NUPEDIDO VARCHAR(30);
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPITEMNOTAFISCAL ALTER COLUMN NUPEDIDO TYPE VARCHAR(30);
--/POSTGRES

/*-------------------------------------------------------------------
Descrição: Tamanho da coluna NUPEDIDO na TBLVPNOTAFISCAL
           inconsistente.
---------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPNOTAFISCAL ALTER COLUMN NUPEDIDO VARCHAR(30);
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPNOTAFISCAL MODIFY NUPEDIDO VARCHAR(30);
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPNOTAFISCAL ALTER COLUMN NUPEDIDO TYPE VARCHAR(30);
--/POSTGRES

/*-------------------------------------------------------------------
Descrição: Tamanho da coluna DSNOVIDADE na TBLVPNOVIDADE
           inconsistente.
---------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPNOVIDADE ALTER COLUMN DSNOVIDADE VARCHAR(30);
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPNOVIDADE MODIFY DSNOVIDADE VARCHAR(30);
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPNOVIDADE ALTER COLUMN DSNOVIDADE TYPE VARCHAR(30);
--/POSTGRES

/*-------------------------------------------------------------------
Descrição: Tamanho da coluna DSPERIODOENTREGA na TBLVPNOVOCLIENDERECO
           inconsistente.
---------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPNOVOCLIENDERECO ALTER COLUMN DSPERIODOABERTURA VARCHAR(100);
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPNOVOCLIENDERECO MODIFY DSPERIODOABERTURA VARCHAR(100);
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPNOVOCLIENDERECO ALTER COLUMN DSPERIODOABERTURA TYPE VARCHAR(100);
--/POSTGRES

/*-------------------------------------------------------------------
Descrição: Tamanho da coluna DSPERIODOENTREGA na TBLVPPERIODOENTREGA
           inconsistente.
---------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPPERIODOENTREGA ALTER COLUMN DSPERIODOENTREGA VARCHAR(50);
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPPERIODOENTREGA MODIFY DSPERIODOENTREGA VARCHAR(50);
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPPERIODOENTREGA ALTER COLUMN DSPERIODOENTREGA TYPE VARCHAR(50);
--/POSTGRES

/*-------------------------------------------------------------------
Descrição: Coluna DSUNIDADEPLURAL não necessária na TBLVPPRODUTO
---------------------------------------------------------------------*/
--SQLSERVER
IF EXISTS (
  SELECT
    *
  FROM
    INFORMATION_SCHEMA.COLUMNS
  WHERE
    TABLE_NAME = 'TBLVPPRODUTO' AND COLUMN_NAME = 'DSUNIDADEPLURAL')
BEGIN
  ALTER TABLE TBLVPPRODUTO DROP COLUMN DSUNIDADEPLURAL;
END;
--/SQLSERVER

--ORACLE
DECLARE
  V_COLUMN_EXISTS NUMBER := 0;
BEGIN
  SELECT COUNT(*) INTO V_COLUMN_EXISTS
    FROM USER_TAB_COLS
    WHERE UPPER(COLUMN_NAME) = 'DSUNIDADEPLURAL'
      AND UPPER(TABLE_NAME) = 'TBLVPPRODUTO';
  IF (V_COLUMN_EXISTS = 1) THEN
      EXECUTE IMMEDIATE 'ALTER TABLE TBLVPPRODUTO DROP COLUMN DSUNIDADEPLURAL';
  END IF;
END;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPPRODUTO DROP COLUMN IF EXISTS DSUNIDADEPLURAL;
--/POSTGRES

/*-------------------------------------------------------------------
Descrição: Tamanho da coluna DSTIMEZONEUF na TBLVPUF
           inconsistente.
---------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPUF ALTER COLUMN DSTIMEZONEUF VARCHAR(100);
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPUF MODIFY DSTIMEZONEUF VARCHAR(100);
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPUF ALTER COLUMN DSTIMEZONEUF TYPE VARCHAR(100);
--/POSTGRES

/*-------------------------------------------------------------------
Descrição: Coluna VLRECEITALIQUIDA não necessária na TBLVPITEMTABELAPRECO
---------------------------------------------------------------------*/
--SQLSERVER
IF EXISTS (
  SELECT
    *
  FROM
    INFORMATION_SCHEMA.COLUMNS
  WHERE
    TABLE_NAME = 'TBLVPITEMTABELAPRECO' AND COLUMN_NAME = 'VLRECEITALIQUIDA')
BEGIN
  ALTER TABLE TBLVPITEMTABELAPRECO DROP COLUMN VLRECEITALIQUIDA;
END;
--/SQLSERVER

--ORACLE
DECLARE
  V_COLUMN_EXISTS NUMBER := 0;
BEGIN
  SELECT COUNT(*) INTO V_COLUMN_EXISTS
    FROM USER_TAB_COLS
    WHERE UPPER(COLUMN_NAME) = 'VLRECEITALIQUIDA'
      AND UPPER(TABLE_NAME) = 'TBLVPITEMTABELAPRECO';
  IF (V_COLUMN_EXISTS = 1) THEN
      EXECUTE IMMEDIATE 'ALTER TABLE TBLVPITEMTABELAPRECO DROP COLUMN VLRECEITALIQUIDA';
  END IF;
END;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPITEMTABELAPRECO DROP COLUMN IF EXISTS VLRECEITALIQUIDA;
--/POSTGRES

/*-------------------------------------------------------------------
Descrição: Coluna CDMOTIVOREGISTROVISITA não necessária na TBLVPPEDIDO
---------------------------------------------------------------------*/
--SQLSERVER
IF EXISTS (
  SELECT
    *
  FROM
    INFORMATION_SCHEMA.COLUMNS
  WHERE
    TABLE_NAME = 'TBLVPPEDIDO' AND COLUMN_NAME = 'CDMOTIVOREGISTROVISITA')
BEGIN
  ALTER TABLE TBLVPPEDIDO DROP COLUMN CDMOTIVOREGISTROVISITA;
END;
--/SQLSERVER

--ORACLE
DECLARE
  V_COLUMN_EXISTS NUMBER := 0;
BEGIN
  SELECT COUNT(*) INTO V_COLUMN_EXISTS
    FROM USER_TAB_COLS
    WHERE UPPER(COLUMN_NAME) = 'CDMOTIVOREGISTROVISITA'
      AND UPPER(TABLE_NAME) = 'TBLVPPEDIDO';
  IF (V_COLUMN_EXISTS = 1) THEN
      EXECUTE IMMEDIATE 'ALTER TABLE TBLVPPEDIDO DROP COLUMN CDMOTIVOREGISTROVISITA';
  END IF;
END;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPPEDIDO DROP COLUMN IF EXISTS CDMOTIVOREGISTROVISITA;
--/POSTGRES

/*-------------------------------------------------------------------
Descrição: Coluna CDMOTIVOREGISTROVISITA não necessária na TBLVPPEDIDOERP
---------------------------------------------------------------------*/
--SQLSERVER
IF EXISTS (
  SELECT
    *
  FROM
    INFORMATION_SCHEMA.COLUMNS
  WHERE
    TABLE_NAME = 'TBLVPPEDIDOERP' AND COLUMN_NAME = 'CDMOTIVOREGISTROVISITA')
BEGIN
  ALTER TABLE TBLVPPEDIDOERP DROP COLUMN CDMOTIVOREGISTROVISITA;
END;
--/SQLSERVER

--ORACLE
DECLARE
  V_COLUMN_EXISTS NUMBER := 0;
BEGIN
  SELECT COUNT(*) INTO V_COLUMN_EXISTS
    FROM USER_TAB_COLS
    WHERE UPPER(COLUMN_NAME) = 'CDMOTIVOREGISTROVISITA'
      AND UPPER(TABLE_NAME) = 'TBLVPPEDIDOERP';
  IF (V_COLUMN_EXISTS = 1) THEN
      EXECUTE IMMEDIATE 'ALTER TABLE TBLVPPEDIDOERP DROP COLUMN CDMOTIVOREGISTROVISITA';
  END IF;
END;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPPEDIDOERP DROP COLUMN IF EXISTS CDMOTIVOREGISTROVISITA;
--/POSTGRES


/*-------------------------------------------------------------------
Descrição: Coluna CDREPORIGINAL não necessária na TBLVPPEDIDO
---------------------------------------------------------------------*/
--SQLSERVER
IF EXISTS (
  SELECT
    *
  FROM
    INFORMATION_SCHEMA.COLUMNS
  WHERE
    TABLE_NAME = 'TBLVPPEDIDO' AND COLUMN_NAME = 'CDREPORIGINAL')
BEGIN
  ALTER TABLE TBLVPPEDIDO DROP COLUMN CDREPORIGINAL;
END;
--/SQLSERVER

--ORACLE
DECLARE
  V_COLUMN_EXISTS NUMBER := 0;
BEGIN
  SELECT COUNT(*) INTO V_COLUMN_EXISTS
    FROM USER_TAB_COLS
    WHERE UPPER(COLUMN_NAME) = 'CDREPORIGINAL'
      AND UPPER(TABLE_NAME) = 'TBLVPPEDIDO';
  IF (V_COLUMN_EXISTS = 1) THEN
      EXECUTE IMMEDIATE 'ALTER TABLE TBLVPPEDIDO DROP COLUMN CDREPORIGINAL';
  END IF;
END;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPPEDIDO DROP COLUMN IF EXISTS CDREPORIGINAL;
--/POSTGRES

/*-------------------------------------------------------------------
Descrição: Coluna CDREPORIGINAL não necessária na TBLVPPEDIDOERP
---------------------------------------------------------------------*/
--SQLSERVER
IF EXISTS (
  SELECT
    *
  FROM
    INFORMATION_SCHEMA.COLUMNS
  WHERE
    TABLE_NAME = 'TBLVPPEDIDOERP' AND COLUMN_NAME = 'CDREPORIGINAL')
BEGIN
  ALTER TABLE TBLVPPEDIDOERP DROP COLUMN CDREPORIGINAL;
END;
--/SQLSERVER

--ORACLE
DECLARE
  V_COLUMN_EXISTS NUMBER := 0;
BEGIN
  SELECT COUNT(*) INTO V_COLUMN_EXISTS
    FROM USER_TAB_COLS
    WHERE UPPER(COLUMN_NAME) = 'CDREPORIGINAL'
      AND UPPER(TABLE_NAME) = 'TBLVPPEDIDOERP';
  IF (V_COLUMN_EXISTS = 1) THEN
      EXECUTE IMMEDIATE 'ALTER TABLE TBLVPPEDIDOERP DROP COLUMN CDREPORIGINAL';
  END IF;
END;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPPEDIDOERP DROP COLUMN IF EXISTS CDREPORIGINAL;
--/POSTGRES

/*-------------------------------------------------------------------------
Atividade: LAV-23695
Descrição: coluna nova
Autor: Augusto Martins
Data: 28/02/2020
------------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMPEDIDO ADD FLPROMOCIONAL VARCHAR(1);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD FLPROMOCIONAL VARCHAR(1);
GO

--VERSAO 6.219

/*-------------------------------------------------------------------------
Descrição: Novas colunas
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPOLITICACOMERCIALFAIXA ADD CDMOTIVOPENDENCIA VARCHAR(20);
GO
ALTER TABLE TBLVPPOLITICACOMERCIALFAIXA ADD NUORDEMLIBERACAO DECIMAL(9);
GO

/*-------------------------------------------------------------------------
Descrição: Alterações de colunas
-------------------------------------------------------------------------*/
--SQLSERVER
EXEC SP_RENAME 'TBLVPPOLITICACOMERCIAL.CDREPRESENTANTE', 'CDREPRESENTANTEPOLITICA', 'COLUMN';
GO
--/SQLSERVER

--ORACLE
DECLARE
 col_count_rep integer;
 col_count_rep_politica integer;
BEGIN
 SELECT count(*)
   into col_count_rep
 FROM user_tab_columns
 WHERE table_name = 'TBLVPPOLITICACOMERCIAL'
 AND column_name = 'CDREPRESENTANTE';
 
 SELECT count(*)
   into col_count_rep_politica
 FROM user_tab_columns
 WHERE table_name = 'TBLVPPOLITICACOMERCIAL'
 AND column_name = 'CDREPRESENTANTEPOLITICA';

 IF col_count_rep = 0 AND col_count_rep_politica = 0 THEN
    EXECUTE IMMEDIATE 'ALTER TABLE TBLVPPOLITICACOMERCIAL ADD CDREPRESENTANTEPOLITICA VARCHAR(20)';
 END IF;
 
 IF col_count_rep > 0 AND col_count_rep_politica = 0 THEN
    	EXECUTE IMMEDIATE 'ALTER TABLE TBLVPPOLITICACOMERCIAL RENAME COLUMN CDREPRESENTANTE to CDREPRESENTANTEPOLITICA';
 END IF;
END;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPPOLITICACOMERCIAL RENAME COLUMN CDREPRESENTANTE to CDREPRESENTANTEPOLITICA;
--/POSTGRES


/*-------------------------------------------------------------------------
NOVA COLUNA
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPRESUMODIA ADD QTITENSVENDIDOSBONIFICADOS DECIMAL(16,7);
GO


/*-------------------------------------------------------------------------
Nova tabela
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPMOTIVOPENDENCIA (
	CDEMPRESA 	  VARCHAR(20)  NOT NULL,
	CDREPRESENTANTE   VARCHAR(20)  NOT NULL,
	CDMOTIVOPENDENCIA VARCHAR(20)  NOT NULL,
	DSMOTIVOPENDENCIA VARCHAR(100)     NULL,
        FLREGRALIBERACAO       CHAR(1)	   NULL,
	FLTIPOALTERACAO	       CHAR(1)	   NULL,
        NUCARIMBO		DECIMAL(9,0) NULL,
	DTALTERACAO           DATETIME     NULL,
	HRALTERACAO         VARCHAR(8)     NULL,
        CDUSUARIO          VARCHAR(20)  NOT NULL,
	CONSTRAINT PK_TBLVPMOTIVOPENDENCIA PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDMOTIVOPENDENCIA, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Alteração na tabela TipoPedido
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPTIPOPEDIDO ADD CDMOTIVOPENDENCIABONIF VARCHAR(20);
GO

ALTER TABLE TBLVPTIPOPEDIDO ADD NUORDEMLIBERACAOBONIF DECIMAL(9);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD CDMOTIVOPENDENCIA VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD NUORDEMLIBERACAO DECIMAL(9);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD CDMOTIVOPENDENCIA VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD NUORDEMLIBERACAO DECIMAL(9);
GO


/*-------------------------------------------------------------------------
Novas colunas
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLMAODEOBRA DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLPCTCUSTOCOMERCIAL DECIMAL(16,7);
GO

ALTER TABLE TBLVPCLIENTE ADD VLINDICEIMPOSTOS DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLTOTALMAODEOBRA DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLTOTALIMPOSTOS DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLTOTALCUSTOCOMERCIAL DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLTOTALCUSTOFINANCEIRO DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLTOTALCOMISSAO DECIMAL(16,7);
GO


ALTER TABLE TBLVPITEMPEDIDOERP ADD VLTOTALMAODEOBRA DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLTOTALIMPOSTOS DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLTOTALCUSTOCOMERCIAL DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLTOTALCUSTOFINANCEIRO DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLTOTALCOMISSAO DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
Exclusão de colunas
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMTABELAPRECO DROP COLUMN VLBASEMARGEM;
GO
ALTER TABLE TBLVPITEMTABELAPRECO DROP COLUMN VLINDICEREDMARGEM;
GO
ALTER TABLE TBLVPITEMPEDIDO DROP COLUMN VLBASEMARGEM;
GO
ALTER TABLE TBLVPITEMPEDIDO DROP COLUMN VLINDICEREDMARGEM;
GO
ALTER TABLE TBLVPITEMPEDIDOERP DROP COLUMN VLBASEMARGEM;
GO
ALTER TABLE TBLVPITEMPEDIDOERP DROP COLUMN VLINDICEREDMARGEM;
GO

/*------------------------------------------------------------------------
Descrição: Nova Tabela
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPTIPOPAGTOTABPRECO (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
   CDTABELAPRECO        VARCHAR(30)          NOT NULL,
   CDTIPOPAGAMENTO      VARCHAR(40)          NOT NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPTIPOPAGTOTABPRECO PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDTABELAPRECO, CDTIPOPAGAMENTO, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------
Descrição: Alteração de colunas
-------------------------------------------------------------------------*/


--SQLSERVER

ALTER TABLE TBLVPITEMPEDIDO ALTER COLUMN CDLINHA VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ALTER COLUMN CDLINHA VARCHAR(20);
GO

ALTER TABLE TBLVPITEMTABELAPRECO ALTER COLUMN CDLINHA VARCHAR(20);
GO

--/SQLSERVER

--ORACLE

ALTER TABLE TBLVPITEMPEDIDO ADD NEWCDLINHA VARCHAR(20);
/

UPDATE TBLVPITEMPEDIDO SET NEWCDLINHA = TO_CHAR(CDLINHA);

ALTER TABLE TBLVPITEMPEDIDO DROP COLUMN CDLINHA;
/

ALTER TABLE TBLVPITEMPEDIDO RENAME COLUMN NEWCDLINHA TO CDLINHA;
/

ALTER TABLE TBLVPITEMPEDIDOERP ADD NEWCDLINHA VARCHAR(20);
/

UPDATE TBLVPITEMPEDIDOERP SET NEWCDLINHA = TO_CHAR(CDLINHA);

ALTER TABLE TBLVPITEMPEDIDOERP DROP COLUMN CDLINHA;
/

ALTER TABLE TBLVPITEMPEDIDOERP RENAME COLUMN NEWCDLINHA TO CDLINHA;
/

ALTER TABLE TBLVPITEMTABELAPRECO ADD NEWCDLINHA VARCHAR(20);
/

UPDATE TBLVPITEMTABELAPRECO SET NEWCDLINHA = TO_CHAR(CDLINHA);

ALTER TABLE TBLVPITEMTABELAPRECO DROP COLUMN CDLINHA;
/

ALTER TABLE TBLVPITEMTABELAPRECO RENAME COLUMN NEWCDLINHA TO CDLINHA;
/

--/ORACLE

--POSTGRES

ALTER TABLE TBLVPITEMPEDIDO ALTER COLUMN CDLINHA TYPE VARCHAR(20);

ALTER TABLE TBLVPITEMPEDIDOERP ALTER COLUMN CDLINHA TYPE VARCHAR(20);

ALTER TABLE TBLVPITEMTABELAPRECO ALTER COLUMN CDLINHA TYPE VARCHAR(20);

--/POSTGRES

--VERSAO 6.220

/*------------------------------------------------------------------------
Nova tabela
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPCONFIGVALORMINIMO (
   CDEMPRESA             VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE       VARCHAR(20)          NOT NULL,
   CDCONFIGVALORMINIMO   VARCHAR(20)          NOT NULL,
   CDTABELAPRECO         VARCHAR(30)          NULL,
   CDGRUPOVALORMINPEDIDO VARCHAR(20)          NULL,
   CDCENTROCUSTO         VARCHAR(20)          NULL,
   CDPLATAFORMAVENDA     VARCHAR(20)          NULL,
   CDLINHA               VARCHAR(20)          NULL,
   VLMINPEDIDO           DECIMAL(16,7)        NULL,
   VLMINPARCELA          DECIMAL(16,7)        NULL,
   CDUSUARIO		 VARCHAR(8)           NOT NULL,
   NUCARIMBO		 DECIMAL(9,0)	      NULL,
   FLTIPOALTERACAO       CHAR(1)              NULL,
   DTALTERACAO           DATETIME             NULL,
   HRALTERACAO           VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPCONFIGVALORMINIMO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCONFIGVALORMINIMO, CDUSUARIO)
)
GO


/*-------------------------------------------------------------------------
Descricao: Nova tabela
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPCENTROCUSTO ADD CDLOCALESTOQUE VARCHAR(20);
GO

CREATE TABLE TBLVPLOCALESTOQUE (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
   CDLOCALESTOQUE       VARCHAR(20)          NOT NULL,
   DSLOCALESTOQUE       VARCHAR(50)          NULL,
   NUORDEM              DECIMAL(9,0)         NULL,
   FLATIVO              CHAR(1)              NULL,
   CDUSUARIO		    VARCHAR(8)		     NOT NULL,
   NUCARIMBO			DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPLOCALESTOQUE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDLOCALESTOQUE, CDUSUARIO)
)
GO

--VERSAO 6.221

/*-------------------------------------------------------------------------
Autor: Renê
Data: 27/02/2020
Atividade: LAV-24078
descrição: GRUPO BIG - Informações Tributárias do Produto
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLNCM VARCHAR(20);
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLPCTICMS DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLPCTST DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLPCTIPI DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLPCTPIS DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLPCTCOFINS DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLCST VARCHAR(100);
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLPCTMVA DECIMAL(16,7);
GO

/*------------------------------------------------------------------------
Novas Colunas
LAV-24200
GRUPO BIG - Fazer gôndola por dentro do pedido
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDOERP ADD QTITEMGONDOLA DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD QTITEMGONDOLA DECIMAL(9,0);
GO
ALTER TABLE TBLVPPEDIDOERP ADD FLGONDOLA VARCHAR(1);
GO
ALTER TABLE TBLVPPEDIDO ADD FLGONDOLA VARCHAR(1);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-24480    Autor: Gustavo Domingos Nunes
Data: 06/03/2020
-------------------------------------------------------------------------*/
/*-------------------------------------------------------------------------
Descrição: Nova coluna na NovoCliEndereco e ClienteEndereco
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPNOVOCLIENDERECO ADD NUCNPJ VARCHAR(20) NULL;
GO

ALTER TABLE TBLVPCLIENTEENDERECO ADD NUCNPJ VARCHAR(20) NULL;
GO

--VERSAO 6.222


/*-------------------------------------------------------------------------
Novas tabelas
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPPLATVENDAMETAPERID(
	CDEMPRESA 		VARCHAR(20)  NOT NULL,
	CDREPRESENTANTE VARCHAR(20)  NOT NULL,
	CDPERIODO 		VARCHAR(20)  NOT NULL,
	DSPERIODO 		VARCHAR(100) 	 NULL,
	DTINICIAL 		DATETIME 	 	 NULL,
	DTFINAL 		DATETIME 	 	 NULL,
	CDUSUARIO		VARCHAR(8)	 NOT NULL,
	NUCARIMBO		DECIMAL(9,0) NULL,
	FLTIPOALTERACAO CHAR(1)		 NULL,
	DTALTERACAO		DATETIME	 NULL,
	HRALTERACAO		VARCHAR(8)	 NULL,
CONSTRAINT PK_TBLVPPLATVENDAMETAPERID PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPERIODO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPPLATVENDAMETA(
	CDEMPRESA 			VARCHAR(20)  NOT NULL,
	CDREPRESENTANTE 	VARCHAR(20)  NOT NULL,
	CDPLATVENDAMETA 	VARCHAR(20)  NOT NULL,
	CDCLIENTE 			VARCHAR(20)  NOT NULL,
	CDCENTROCUSTO 		VARCHAR(20)	 NOT NULL,
	CDPLATAFORMAVENDA 	VARCHAR(20)	 NOT NULL,
	CDUSUARIO			VARCHAR(8)	 NOT NULL,
	DTMETA 				DATETIME 	 	 NULL,
	VLMETACONTRATADA	DECIMAL(16,7) 	 NULL,
	VLMETAPLANEJADAREP	DECIMAL(16,7) 	 NULL,
	VLMETAPLANEJADASUP	DECIMAL(16,7) 	 NULL,
	FLPLANEJADO			CHAR(1)			 NULL,
	FLENCERRADO			CHAR(1)			 NULL,
	NUCARIMBO			DECIMAL(9,0) NULL,
	FLTIPOALTERACAO 	CHAR(1)		 NULL,
	DTALTERACAO			DATETIME	 NULL,
	HRALTERACAO			VARCHAR(8)	 NULL,
CONSTRAINT PK_TBLVPPLATVENDAMETA PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPLATVENDAMETA, CDCLIENTE, CDCENTROCUSTO, CDPLATAFORMAVENDA, CDUSUARIO)
)
GO

CREATE TABLE TBLVPPLATVENDAMETAHIST(
	CDEMPRESA 			VARCHAR(20)  NOT NULL,
	CDREPRESENTANTE 	VARCHAR(20)  NOT NULL,
	CDPLATVENDAMETA		VARCHAR(20)  NOT NULL,
	CDCLIENTE 			VARCHAR(20)  NOT NULL,
	CDCENTROCUSTO 		VARCHAR(20)	 NOT NULL,
	CDPLATAFORMAVENDA 	VARCHAR(20)	 NOT NULL,
	CDUSUARIO			VARCHAR(8)	 NOT NULL,
	DTMETA 				DATETIME 	 	 NULL,
	VLVENDAREALIZADA	DECIMAL(16,7) 	 NULL,
	NUCARIMBO			DECIMAL(9,0) NULL,
	FLTIPOALTERACAO	 	CHAR(1)		 NULL,
	DTALTERACAO			DATETIME	 NULL,
	HRALTERACAO			VARCHAR(8)	 NULL,
CONSTRAINT PK_TBLVPPLATVENDAMETAHIST PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPLATVENDAMETA, CDCLIENTE, CDCENTROCUSTO, CDPLATAFORMAVENDA, CDUSUARIO)
)
GO

CREATE TABLE TBLVPPLATVENDAMETAATUA(
	CDEMPRESA 			VARCHAR(20)  NOT NULL,
	CDREPRESENTANTE 	VARCHAR(20)  NOT NULL,
	CDPLATVENDAMETA		VARCHAR(20)	 NOT NULL,
	CDCLIENTE 			VARCHAR(20)  NOT NULL,
	CDCENTROCUSTO 		VARCHAR(20)	 NOT NULL,
	CDPLATAFORMAVENDA 	VARCHAR(20)	 NOT NULL,
	CDUSUARIO			VARCHAR(8)	 NOT NULL,
	DTMETA 				DATETIME 	 	 NULL,
	VLMETAPLANEJADAREP	DECIMAL(16,7) 	 NULL,
	VLMETAPLANEJADASUP	DECIMAL(16,7) 	 NULL,
	FLPLANEJADO			CHAR(1)			 NULL,
	FLENCERRADO			CHAR(1)			 NULL,
	FLCONTROLEWMW		CHAR(1)			 NULL,
	DSMENSAGEMCONTROLEWMW VARCHAR(4000)  NULL,
	FLCONTROLEERP		CHAR(1)			 NULL,
	DSMENSAGEMCONTROLEERP VARCHAR(4000)	 NULL,
	NUCARIMBO			DECIMAL(9,0) NULL,
	FLTIPOALTERACAO 	CHAR(1)		 NULL,
	DTALTERACAO			DATETIME	 NULL,
	HRALTERACAO			VARCHAR(8)	 NULL,
CONSTRAINT PK_TBLVPLATVENDAMETAATUA PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPLATVENDAMETA, CDCLIENTE, CDCENTROCUSTO, CDPLATAFORMAVENDA, CDUSUARIO)
)
GO

/*--------------------------------------------------------
NOVAS TABELAS
--------------------------------------------------------*/
CREATE TABLE TBLVPVARIAVELCALCULO (
	CDEMPRESA	VARCHAR(20) 	NOT NULL,
	CDREPRESENTANTE	VARCHAR(20) 	NOT NULL,
	CDENTIDADE	VARCHAR(50)	NOT NULL,
	PKENTIDADE	VARCHAR(100)	NOT NULL,
	CDVARIAVEL	VARCHAR(50)	NOT NULL,
	DSVARIAVEL	VARCHAR(100)	NULL,
	DSVALORVARIAVEL	VARCHAR(100)	NULL,
	CDTIPOVALORVARIAVEL	VARCHAR(20)	NULL,
	CDCLIENTE	VARCHAR(20)	NULL,
	CDPRODUTO	VARCHAR(20)	NULL,
	CDUSUARIO	VARCHAR(8)		NOT NULL,
	NUCARIMBO	DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	DTALTERACAO	DATETIME        NULL,
	HRALTERACAO	VARCHAR(8)    	NULL,
    CONSTRAINT PK_TBLVPVARIAVELCALCULO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDENTIDADE, PKENTIDADE, CDVARIAVEL, CDUSUARIO)
)
GO


CREATE TABLE TBLVPFORMULACALCULO (
	CDFORMULACALCULO	VARCHAR(20) 	NOT NULL,
	DSFORMULACALCULO	VARCHAR(100)	NOT NULL,
	FLTIPOFORMULACALCULO	CHAR(1)			NULL,
	CDUSUARIO	VARCHAR(8)		NOT NULL,
	NUCARIMBO	DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	DTALTERACAO	DATETIME        NULL,
	HRALTERACAO	VARCHAR(8)    	NULL,
    CONSTRAINT PK_TBLVPFORMULACALCULO PRIMARY KEY (CDFORMULACALCULO, DSFORMULACALCULO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPFORMULACALCULOSQL (
	CDFORMULACALCULO	VARCHAR(20) 	NOT NULL,
	CDFORMULACALCULOSQL 	VARCHAR(20) 	NOT NULL,
	DSSQL	TEXT	NOT NULL,
	FLTIPOFORMULACALCULO	CHAR(1)			NULL,
	NUORDEM	DECIMAL(9,0)	NULL,
	CDUSUARIO	VARCHAR(8)		NOT NULL,
	NUCARIMBO	DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	DTALTERACAO	DATETIME        NULL,
	HRALTERACAO	VARCHAR(8)    	NULL,
    CONSTRAINT PK_TBLVPFORMULACALCULOSQL PRIMARY KEY (CDFORMULACALCULO, CDFORMULACALCULOSQL, CDUSUARIO)
)
GO

/*--------------------------------------------------------
NOVAS COLUNAS
--------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD VLBASEMARGEMRENTAB DECIMAL(16,7);
GO
ALTER TABLE TBLVPPEDIDO ADD VLCUSTOMARGEMRENTAB DECIMAL(16,7);
GO
ALTER TABLE TBLVPPEDIDO ADD VLPCTMARGEMRENTAB DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLBASEMARGEMRENTAB DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLCUSTOMARGEMRENTAB DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTMARGEMRENTAB DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDOERP ADD VLBASEMARGEMRENTAB DECIMAL(16,7);
GO
ALTER TABLE TBLVPPEDIDOERP ADD VLCUSTOMARGEMRENTAB DECIMAL(16,7);
GO
ALTER TABLE TBLVPPEDIDOERP ADD VLPCTMARGEMRENTAB DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLBASEMARGEMRENTAB DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLCUSTOMARGEMRENTAB DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTMARGEMRENTAB DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
Inclusão de colunas
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPCAMPO ADD FLVALORINICIAL CHAR(1) NULL;
GO
ALTER TABLE TBLVPCAMPO ADD NMENTIDADEORIGEM VARCHAR(30) NULL;
GO

/*-------------------------------------------------------------------------
 Nova coluna
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPREQUISICAOSERVRESP ADD NMUSUARIOCRIACAO VARCHAR(20);
GO

/*------------------------------------------------------------------------
 Nova coluna
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPAGENDAVISITA ADD NUORDEMMANUAL DECIMAL(9,0);
GO

/*--------------------------------------------------------
NOVAS TABELAS
--------------------------------------------------------*/
CREATE TABLE TBLVPMARGEMRENTAB (
	CDEMPRESA	VARCHAR(20) 	NOT NULL,
	CDMARGEMRENTAB	VARCHAR(40) 	NOT NULL,
	DTINIVIGENCIA	DATETIME	    NULL,
        DTFIMVIGENCIA	DATETIME	    NULL,
	CDPLATAFORMAVENDA VARCHAR(20)	    NULL,
	CDCENTROCUSTO	VARCHAR(20)	    NULL,
        CDGRUPODESCCLI	VARCHAR(20)	    NULL,
        CDCLIENTE	VARCHAR(20)	    NULL,
        CDLINHA 	VARCHAR(20)	    NULL,
        CDSTATUSCOLECAO	VARCHAR(20)	    NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
        NUCARIMBO		DECIMAL(9,0) NULL,
	DTALTERACAO	DATETIME        NULL,
   	HRALTERACAO	VARCHAR(8)      NULL,
        CDUSUARIO          VARCHAR(20)  NOT NULL,
    CONSTRAINT PK_TBLVPMARGEMRENTAB PRIMARY KEY (CDEMPRESA, CDMARGEMRENTAB, CDUSUARIO)
)
GO

CREATE TABLE TBLVPMARGEMRENTABFAIXA (
	CDEMPRESA	  VARCHAR(20) 	NOT NULL,
	CDMARGEMRENTAB	  VARCHAR(40) 	NOT NULL,
	VLPCTMARGEMRENTAB DECIMAL(16,7)	NOT NULL,
	CDMOTIVOPENDENCIA VARCHAR(20)	    NULL,
	NUORDEMLIBERACAO  DECIMAL(9,0)	    NULL,
        CDCORFAIXA	  DECIMAL(9,0) 	    NULL,
        DSCORFAIXA	  VARCHAR(100) 	    NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
        NUCARIMBO		DECIMAL(9,0) NULL,
	DTALTERACAO	DATETIME        NULL,
   	HRALTERACAO	VARCHAR(8)      NULL,
        CDUSUARIO          VARCHAR(20)  NOT NULL,
    CONSTRAINT PK_TBLVPMARGEMRENTABFAIXA PRIMARY KEY (CDEMPRESA, CDMARGEMRENTAB, VLPCTMARGEMRENTAB, CDUSUARIO)
)
GO


/*--------------------------------------------------------
NOVOS CAMPOS
--------------------------------------------------------*/

ALTER TABLE TBLVPITEMPEDIDO ADD CDMARGEMRENTAB VARCHAR(40);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD CDMARGEMRENTAB VARCHAR(40);
GO

/*-------------------------------------------------------------------------
 Novas colunas
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPREQUISICAOSERV ADD CDUSUARIOCRIACAO VARCHAR(20);
GO

--VERSAO 6.223

/*-------------------------------------------------------------------
Descricao: Novas colunas
---------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMNFE ADD VLPCTFECOPRECOLHER DECIMAL(16,7);
GO

ALTER TABLE TBLVPREQUISICAOSERVTIPO ADD FLFILTROSTATUSCLIENTE CHAR(1) NULL;
GO

ALTER TABLE TBLVPREQUISICAOSERVTIPO ADD DSSTATUSCLIENTELIST VARCHAR(4000) NULL;
GO

ALTER TABLE TBLVPPRODUTO ADD FLVENDAENCERRADA CHAR(1);
GO

ALTER TABLE TBLVPPOLITICACOMERCIAL ADD DSREFERENCIA VARCHAR(100);
GO

ALTER TABLE TBLVPPOLITICACOMERCIAL ADD FLVENDAENCERRADA CHAR(1);
GO


/*-------------------------------------------------------------------
Descricao: Correcao de valor na coluna
---------------------------------------------------------------------*/

UPDATE TBLVPAGENDAVISITA SET NUORDEMMANUAL = 0 WHERE NUORDEMMANUAL IS NULL;

--VERSAO 6.224

/*-------------------------------------------------------------------
Novas colunas
---------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMTABELAPRECO ADD VLCREDITOIMPOSTOS DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLDESCPRODUTORESTRITO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLDESCPRODUTORESTRITO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD VLTOTALDESCPRODUTORESTRITO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLTOTALDESCPRODUTORESTRITO DECIMAL(16,7);
GO

ALTER TABLE TBLVPTIPOPAGAMENTO ADD FLIGNORALIMITECREDITO VARCHAR(1);
GO

--VERSAO 6.225

/*-------------------------------------------------------------------
Autor: Gustavo Heidemann
Atividade: LAV-25458
Descrição: Alteração de chave primária.
---------------------------------------------------------------------*/

ALTER TABLE TBLVPPESQUISARESPAPP DROP CONSTRAINT PK_TBLVPPESQUISARESPAPP;

--SQLSERVER
ALTER TABLE TBLVPPESQUISARESPAPP ALTER COLUMN CDRESPOSTA VARCHAR(20) NOT NULL;
GO
--/SQLSERVER

--ORACLE
DROP INDEX PK_TBLVPPESQUISARESPAPP;
/

ALTER TABLE TBLVPPESQUISARESPAPP MODIFY CDRESPOSTA VARCHAR(20) NOT NULL;
/

--/ORACLE

--POSTGRES
ALTER TABLE TBLVPPESQUISARESPAPP ALTER COLUMN CDRESPOSTA SET NOT NULL;
--/POSTGRES

ALTER TABLE TBLVPPESQUISARESPAPP ADD CONSTRAINT PK_TBLVPPESQUISARESPAPP PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPESQUISAAPP, CDQUESTIONARIO, CDPERGUNTA, CDRESPOSTA, CDUSUARIO);

/*-------------------------------------------------------------------------
Autor: Gustavo Heidemann
Descrição: Alteração de primary key
Data: 20/04/2020
Atividade: LAV-25158
------------------------------------------------------------------------*/

ALTER TABLE TBLVPPESQUISAAPP DROP CONSTRAINT PK_TBLVPPESQUISAAPP;

--ORACLE
DROP INDEX PK_TBLVPPESQUISAAPP;
--/ORACLE

ALTER TABLE TBLVPPESQUISAAPP ADD CONSTRAINT PK_TBLVPPESQUISAAPP PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPESQUISAAPP, CDUSUARIO);

/*-------------------------------------------------------------------------
Autor: Gustavo Heidemann
Descrição: Criação de coluna
Data: 30/04/2020
Atividade: LAV-25158
------------------------------------------------------------------------*/

ALTER TABLE TBLVPPESQUISAAPP ADD FLPESQUISANOVOCLIENTE CHAR(1) NULL;

--VERSAO 6.226

/*------------------------------------------------------------------------
Atividade: LAV-24276 - WMW - Inserir os filtros Segmento e Canal na tela de Extrato de Pontuação do Pedido
Descrição: Criação das CDSEGMENTO, CDCANAL na tabela TBLVPPONTEXTPED
Autor: Raphael Santos
Data: 24/02/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPONTEXTPED ADD CDSEGMENTO VARCHAR(100);
GO

ALTER TABLE TBLVPPONTEXTPED ADD CDCANAL VARCHAR(100);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25596    Autor: Gustavo Domingos Nunes
Data: 06/05/2020
-------------------------------------------------------------------------*/
/*-------------------------------------------------------------------------
Descrição: Alteração do tipo de coluna
-------------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPITEMPEDIDO ALTER COLUMN VLPCTPOLITICACOMERCIAL DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ALTER COLUMN VLPCTPOLITICACOMERCIAL DECIMAL(16,7);
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPITEMPEDIDO MODIFY VLPCTPOLITICACOMERCIAL DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP MODIFY VLPCTPOLITICACOMERCIAL DECIMAL(16,7);
GO
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPITEMPEDIDO ALTER COLUMN VLPCTPOLITICACOMERCIAL TYPE DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ALTER COLUMN VLPCTPOLITICACOMERCIAL TYPE DECIMAL(16,7);
GO
--/POSTGRES

/*-------------------------------------------------------------------
Autor: Gustavo Heidemann
Atividade: LAV-25538
Descrição: Alterações de tamanho e nome de coluna.
---------------------------------------------------------------------*/

--SQLSERVER

EXEC SP_RENAME 'TBLVPMARGEMRENTAB.CDMARGEMRENT', 'CDMARGEMRENTAB', 'COLUMN';
GO

EXEC SP_RENAME 'TBLVPMARGEMRENTABFAIXA.CDMARGEMRENT', 'CDMARGEMRENTAB', 'COLUMN';
GO

ALTER TABLE TBLVPMARGEMRENTAB DROP CONSTRAINT PK_TBLVPMARGEMRENTAB;
GO

ALTER TABLE TBLVPMARGEMRENTAB ALTER COLUMN CDMARGEMRENTAB VARCHAR(40) NOT NULL;
GO

ALTER TABLE TBLVPMARGEMRENTAB ADD CONSTRAINT PK_TBLVPMARGEMRENTAB PRIMARY KEY (CDEMPRESA, CDMARGEMRENTAB, CDUSUARIO);
GO

ALTER TABLE TBLVPMARGEMRENTABFAIXA DROP CONSTRAINT PK_TBLVPMARGEMRENTABFAIXA;
GO

ALTER TABLE TBLVPMARGEMRENTABFAIXA ALTER COLUMN CDMARGEMRENTAB VARCHAR(40) NOT NULL;
GO

ALTER TABLE TBLVPMARGEMRENTABFAIXA ADD CONSTRAINT PK_TBLVPMARGEMRENTABFAIXA PRIMARY KEY (CDEMPRESA, CDMARGEMRENTAB, VLPCTMARGEMRENTAB, CDUSUARIO);
GO

ALTER TABLE TBLVPITEMPEDIDO ALTER COLUMN CDMARGEMRENTAB VARCHAR(40);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ALTER COLUMN CDMARGEMRENTAB VARCHAR(40);
GO
--/SQLSERVER

--ORACLE

ALTER TABLE TBLVPMARGEMRENTAB RENAME COLUMN CDMARGEMRENT TO CDMARGEMRENTAB;
/

ALTER TABLE TBLVPMARGEMRENTABFAIXA RENAME COLUMN CDMARGEMRENT TO CDMARGEMRENTAB;
/

ALTER TABLE TBLVPMARGEMRENTAB MODIFY CDMARGEMRENTAB VARCHAR(40);
/

ALTER TABLE TBLVPMARGEMRENTABFAIXA MODIFY CDMARGEMRENTAB VARCHAR(40);
/

ALTER TABLE TBLVPITEMPEDIDO MODIFY CDMARGEMRENTAB VARCHAR(40);
/

ALTER TABLE TBLVPITEMPEDIDOERP MODIFY CDMARGEMRENTAB VARCHAR(40);
/

--/ORACLE

--POSTGRES

ALTER TABLE TBLVPMARGEMRENTAB RENAME COLUMN CDMARGEMRENT TO CDMARGEMRENTAB;

ALTER TABLE TBLVPMARGEMRENTABFAIXA RENAME COLUMN CDMARGEMRENT TO CDMARGEMRENTAB;

ALTER TABLE TBLVPMARGEMRENTAB ALTER COLUMN CDMARGEMRENTAB TYPE VARCHAR(40);

ALTER TABLE TBLVPMARGEMRENTABFAIXA ALTER COLUMN CDMARGEMRENTAB TYPE VARCHAR(40);

ALTER TABLE TBLVPITEMPEDIDO ALTER COLUMN CDMARGEMRENTAB TYPE VARCHAR(40);

ALTER TABLE TBLVPITEMPEDIDOERP ALTER COLUMN CDMARGEMRENTAB TYPE VARCHAR(40);

--/POSTGRES

/*------------------------------------------------------------------------
Atividade: LAV-22704 - ICONIC - Mudança Sugestão de produto
Descrição: Nova Tabela ProdutoIndustria
Autor: Raphael Santos
Data: 23/03/2020
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPPRODUTOINDUSTRIA (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
   CDPRODUTO	        VARCHAR(20)          NOT NULL,
   CDPRODINDUSTRIA 	    VARCHAR(20)          NOT NULL,
   CDREFPRODINDUSTRIA   VARCHAR(20)          NOT NULL,
   CDSUGESTAOVENDA	    VARCHAR(20)          NOT NULL,
   DSPRODINDUSTRIA	    VARCHAR(100)          	 NULL,
   DSREFPRODINDUSTRIA   VARCHAR(100)          	 NULL,
   CDUSUARIO			VARCHAR(8)			 NOT NULL,
   NUCARIMBO			DECIMAL(9,0)			 NULL,
   FLTIPOALTERACAO		CHAR(1)					 NULL,
   DTALTERACAO			DATETIME				 NULL,
   HRALTERACAO			VARCHAR(8)				 NULL,
   CONSTRAINT PK_TBLVPPRODUTOINDUSTRIA PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDPRODINDUSTRIA, CDREFPRODINDUSTRIA, CDSUGESTAOVENDA, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------
Atividade: LAV-22704 - ICONIC - Mudança Sugestão de produto
Descrição: Criando as colunas CDSEGMENTO, CDCANAL e FLINDUSTRIA na entidade SUGESTAOVENDA
Autor: Raphael Santos
Data: 23/03/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPSUGESTAOVENDA ADD CDSEGMENTO VARCHAR(100);
GO
ALTER TABLE TBLVPSUGESTAOVENDA ADD CDCANAL VARCHAR(100);
GO
ALTER TABLE TBLVPSUGESTAOVENDA ADD FLINDUSTRIA CHAR(1);
GO

/*------------------------------------------------------------------------
Atividade: LAV-22704 - ICONIC - Mudança Sugestão de produto
Descrição: Renomeando as colunas CDSEGMENTOPONTUACAO e CDCANALPONTUACAO da entidade CLIENTE
Autor: Raphael Santos
Data: 23/03/2020
-------------------------------------------------------------------------*/
--SQLSERVER
EXEC SP_RENAME 'TBLVPCLIENTE.CDSEGMENTOPONTUACAO', 'CDSEGMENTO', 'COLUMN';
EXEC SP_RENAME 'TBLVPCLIENTE.CDCANALPONTUACAO', 'CDCANAL', 'COLUMN';
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPCLIENTE RENAME COLUMN CDSEGMENTOPONTUACAO TO CDSEGMENTO;
/
ALTER TABLE TBLVPCLIENTE RENAME COLUMN CDCANALPONTUACAO TO CDCANAL;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPCLIENTE RENAME COLUMN CDSEGMENTOPONTUACAO TO CDSEGMENTO;
ALTER TABLE TBLVPCLIENTE RENAME COLUMN CDCANALPONTUACAO TO CDCANAL;
--/POSTGRES

/*------------------------------------------------------------------------
Atividade: LAV-22704 - ICONIC - Mudança Sugestão de produto
Descrição: Renomeando as colunas CDSEGMENTOPONTUACAO e CDCANALPONTUACAO da entidade PONTUACAOCONFIG
Autor: Raphael Santos
Data: 23/03/2020
-------------------------------------------------------------------------*/
--SQLSERVER
EXEC SP_RENAME 'TBLVPPONTUACAOCONFIG.CDSEGMENTOPONTUACAO', 'CDSEGMENTO', 'COLUMN';
EXEC SP_RENAME 'TBLVPPONTUACAOCONFIG.CDCANALPONTUACAO', 'CDCANAL', 'COLUMN';
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPPONTUACAOCONFIG RENAME COLUMN CDSEGMENTOPONTUACAO TO CDSEGMENTO;
/
ALTER TABLE TBLVPPONTUACAOCONFIG RENAME COLUMN CDCANALPONTUACAO TO CDCANAL;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPPONTUACAOCONFIG RENAME COLUMN CDSEGMENTOPONTUACAO TO CDSEGMENTO;
ALTER TABLE TBLVPPONTUACAOCONFIG RENAME COLUMN CDCANALPONTUACAO TO CDCANAL;
--/POSTGRES


--VERSAO 6.227

/*-------------------------------------------------------------------
Descricao: Novas colunas
---------------------------------------------------------------------*/
ALTER TABLE TBLVPCLIENTEENDERECO ADD FLTIPOPESSOA CHAR(1);
GO

ALTER TABLE TBLVPNOVOCLIENDERECO ADD FLTIPOPESSOA CHAR(1);
GO

/*-------------------------------------------------------------------
Descricao: Alteracao de tamanho da coluna.
---------------------------------------------------------------------*/

--SQLSERVER
ALTER TABLE TBLVPCONFIGVALORMINIMO DROP CONSTRAINT PK_TBLVPCONFIGVALORMINIMO;
GO

ALTER TABLE TBLVPCONFIGVALORMINIMO ALTER COLUMN CDCONFIGVALORMINIMO VARCHAR(40) NOT NULL;
GO

ALTER TABLE TBLVPCONFIGVALORMINIMO ADD CONSTRAINT PK_TBLVPCONFIGVALORMINIMO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCONFIGVALORMINIMO);
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPCONFIGVALORMINIMO MODIFY CDCONFIGVALORMINIMO VARCHAR(40);
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPCONFIGVALORMINIMO ALTER COLUMN CDCONFIGVALORMINIMO TYPE VARCHAR(40);
--/POSTGRES


/*-------------------------------------------------------------------
Descricao: Novas colunas
---------------------------------------------------------------------*/
ALTER TABLE TBLVPTRIBUTACAO ADD CDBENEFICIOFISCAL VARCHAR(20);
GO

ALTER TABLE TBLVPITEMNFE ADD CDBENEFICIOFISCAL VARCHAR(20);
GO




--VERSAO 6.228

/*-------------------------------------------------------------------
Descricao: Novas Tabelas
---------------------------------------------------------------------*/

CREATE TABLE TBLVPCOLETAINFOSPDA (
	CDUSUARIO VARCHAR(20) NOT NULL,
	DTSYNC DATETIME NOT NULL,
	VLPCTBATERIAINICIAL DECIMAL(9) NULL,
	VLPCTBATERIA DECIMAL(9) NULL,
	HRSYNCINICIAL VARCHAR(8) NULL,
	HRSYNC VARCHAR(8) NULL,
	FLGPSATIVO CHAR(1) NULL,
	NUCARIMBO DECIMAL(9,0) NULL,
	FLTIPOALTERACAO CHAR(1) NULL,
	DTALTERACAO DATETIME NULL,
	HRALTERACAO VARCHAR(8) NULL,
	CONSTRAINT PK_TBLVPCOLETAINFOSPDA PRIMARY KEY (CDUSUARIO, DTSYNC)
);
GO


CREATE TABLE TBLVPTABPRECOCLASSEPROD (
   CDEMPRESA			VARCHAR(20)			 NOT NULL,
   CDREPRESENTANTE		VARCHAR(20)			 NOT NULL,
   CDTABELAPRECO		VARCHAR(30)			 NOT NULL,
   CDCLASSE				VARCHAR(20)			 NOT NULL,
   QTMINPRODUTO			DECIMAL(16,7)		 NULL,
   QTMINPEDIDO			DECIMAL(16,7)		 NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPTABPRECOCLASSEPROD PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDTABELAPRECO, CDCLASSE, CDUSUARIO)
)
GO


/*-------------------------------------------------------------------------
Descricao: Nova coluna na TipoPedido
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPTIPOPEDIDO ADD FLIGNORAVALORMINIMOPARCELA CHAR(1);
GO


--VERSAO 6.229

/*-------------------------------------------------------------------
Atividade: LAV-25835
Autor: Ronan Cardoso
Descricao: Nova Tabela
Data: 20/05/2020
---------------------------------------------------------------------*/
CREATE TABLE TBLVPPLATAFORMAVENDACLIFIN (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
   CDCLIENTE            VARCHAR(20)          NOT NULL,
   CDPLATAFORMAVENDA    VARCHAR(20)          NOT NULL,
   CDLINHA              VARCHAR(20)          NOT NULL,
   VLINDICEFINANCEIRO   DECIMAL(16,7)        NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPPLATAFORMAVENDACLIFIN PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, CDPLATAFORMAVENDA, CDLINHA, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25858
Autor: Gustavo Heidemann
Descrição: Criação de coluna
Data: 21/05/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCONDICAOPAGAMENTO ADD FLPARCELAUNICAVLMINPARCELA CHAR(1);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25743
Autor: Gustavo Domingos Nunes
Descrição: Nova coluna na TipoPagamento
Data: 22/05/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPTIPOPAGAMENTO ADD FLOCULTOPARANOVOCLIENTE CHAR(1);
GO


/*------------------------------------------------------------------------
Atividade: LAV-24473 - GRUPO BIG - Novidade de produto para baixa de preço
Data: 17/03/2020
Autor: Raphael Santos
Descrição: Adicionado coluna VLPRECOANTIGO na tabela RELNOVIDADEPROD
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPRELNOVIDADEPROD ADD VLPRECOANTIGO DECIMAL(16,7);
GO

/*------------------------------------------------------------------------
Atividade: LAV-24473 - GRUPO BIG - Novidade de produto para baixa de preço
Data: 09/04/2020
Autor: Raphael Santos
Descrição: Atualização da chave primária
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPRELNOVIDADEPROD ADD CDTABELAPRECO VARCHAR(30) DEFAULT '0' NOT NULL;
GO
ALTER TABLE TBLVPRELNOVIDADEPROD ADD CDUF VARCHAR(2) DEFAULT '0' NOT NULL;
GO
ALTER TABLE TBLVPRELNOVIDADEPROD ADD CDUNIDADE VARCHAR(20) DEFAULT '0' NOT NULL;
GO
ALTER TABLE TBLVPRELNOVIDADEPROD ADD QTITEM DECIMAL(9,0) DEFAULT 0 NOT NULL;
GO
ALTER TABLE TBLVPRELNOVIDADEPROD ADD CDPRAZOPAGTOPRECO DECIMAL(9,0) DEFAULT 0 NOT NULL;
GO
ALTER TABLE TBLVPRELNOVIDADEPROD ADD CDLOCALESTOQUE VARCHAR(20) DEFAULT '0' NOT NULL;
GO
ALTER TABLE TBLVPRELNOVIDADEPROD ADD FLORIGEMESTOQUE CHAR(1) DEFAULT '0' NOT NULL;
GO

ALTER TABLE TBLVPRELNOVIDADEPROD DROP CONSTRAINT PK_TBLVPRELNOVIDADEPROD;
GO

--ORACLE
DROP INDEX PK_TBLVPRELNOVIDADEPROD;
GO
--/ORACLE

ALTER TABLE TBLVPRELNOVIDADEPROD ADD CONSTRAINT PK_TBLVPRELNOVIDADEPROD PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDTIPONOVIDADE, CDITEMGRADE1, CDITEMGRADE2, CDITEMGRADE3, CDTABELAPRECO, CDUF, CDUNIDADE, QTITEM, CDPRAZOPAGTOPRECO, CDLOCALESTOQUE, FLORIGEMESTOQUE, CDUSUARIO);
GO

/*-------------------------------------------------------------------------
Descrição: Novas colunas e alteração de parâmetro
Data: 23/04/2020
Autor: Renan
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMCOMBO ADD FLTIPOITEMCOMBO CHAR(1);
GO

ALTER TABLE TBLVPITEMCOMBO ADD VLUNITARIOCOMBO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMCOMBO ADD QTITEMCOMBO DECIMAL(9,0);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD CDCOMBO VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD CDCOMBO VARCHAR(20);
GO

ALTER TABLE TBLVPCOMBO ADD CDTABELAPRECO VARCHAR(20) DEFAULT '0' NOT NULL;
GO

ALTER TABLE TBLVPCOMBO DROP CONSTRAINT PK_TBLVPCOMBO;
GO

--ORACLE
DROP INDEX PK_TBLVPCOMBO;
GO
--/ORACLE

ALTER TABLE TBLVPCOMBO ADD CONSTRAINT PK_TBLVPCOMBO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCOMBO, CDTABELAPRECO, CDUSUARIO);
GO

ALTER TABLE TBLVPITEMCOMBO ADD CDTABELAPRECO VARCHAR(20) DEFAULT '0' NOT NULL;
GO

ALTER TABLE TBLVPITEMCOMBO DROP CONSTRAINT PK_TBLVPITEMCOMBO;
GO

--ORACLE
DROP INDEX PK_TBLVPITEMCOMBO;
GO
--/ORACLE

ALTER TABLE TBLVPITEMCOMBO ADD CONSTRAINT PK_TBLVPITEMCOMBO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCOMBO, CDTABELAPRECO, CDPRODUTO, CDUSUARIO);
GO

/*-------------------------------------------------------------------
Descrição: Nova coluna
Autor: Renan
Tarefa: LAV-24691
---------------------------------------------------------------------*/
ALTER TABLE TBLVPREPRESENTANTE ADD VLINDICEFINANCEIRO DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-24798 - GRUPO BIG - Kilo Médio
Descrição: Criação da tabela TBLVPPESOFAIXA
Autor: Raphael Santos
Data: 23/04/2020
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPPESOFAIXA (
	CDEMPRESA 		VARCHAR(20)    NOT NULL,
	QTPESO  		DECIMAL(16,7)  NOT NULL,
	DSFAIXA 		VARCHAR(100) 	   NULL,
	FLFAIXAIDEAL    CHAR(1)      	   NULL,
    CDCORFAIXA      DECIMAL(9,0)       NULL,
	CDUSUARIO	    VARCHAR(8)	   NOT NULL,
    NUCARIMBO	    DECIMAL(9,0)	   NULL,
    FLTIPOALTERACAO	CHAR(1)			   NULL,
    DTALTERACAO	    DATETIME           NULL,
    HRALTERACAO	    VARCHAR(8)    	   NULL,
CONSTRAINT PK_TBLVPPESOFAIXA PRIMARY KEY (CDEMPRESA, QTPESO, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-24203 GRUPO BIG - Pesquisa de mercado com cadastro de produtos a serem pesquisados
Autor: João Henrique Lopes
Data: 03/03/2020
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPPESQUISAMERCADOCONFIG (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
   CDPESQUISAMERCADOCONFIG	VARCHAR(20)          NOT NULL,
   DSPESQUISAMERCADO        VARCHAR(100)         	 NULL,
   DTINICIALVIGENCIA        DATETIME                 NULL,
   DTFIMVIGENCIA            DATETIME                 NULL,
   FLFINALIZADA             CHAR(1)                  NULL,
   FLENVIADA                CHAR(1)                  NULL,
   NUCARIMBO                DECIMAL(9,0)         	 NULL,
   CDUSUARIO                VARCHAR(8)           NOT NULL,
   FLTIPOALTERACAO          CHAR(1)              	 NULL,
   DTALTERACAO              DATETIME             	 NULL,
   HRALTERACAO              VARCHAR(8)           	 NULL,
   CONSTRAINT PK_TBLVPPESQUISAMERCADOCONFIG PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDPESQUISAMERCADOCONFIG, CDUSUARIO)
)
GO

CREATE TABLE TBLVPPESQUISAMERCADOPRODUTO (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDPESQUISAMERCADOCONFIG	VARCHAR(20)          NOT NULL,
   CDPRODUTO                VARCHAR(20)          NOT NULL,
   NUCARIMBO                DECIMAL(9,0)         	 NULL,
   CDUSUARIO                VARCHAR(8)           NOT NULL,
   FLTIPOALTERACAO          CHAR(1)              	 NULL,
   DTALTERACAO              DATETIME             	 NULL,
   HRALTERACAO              VARCHAR(8)           	 NULL,
   CONSTRAINT PK_TBLVPPESQUISAMERCADOPRODUTO PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDPESQUISAMERCADOCONFIG, CDPRODUTO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPPESQUISAMERCADOREG (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
   CDPESQUISAMERCADOCONFIG	VARCHAR(20)          NOT NULL,
   CDCLIENTE                VARCHAR(20)          NOT NULL,
   CDPRODUTO                VARCHAR(20)          NOT NULL,
   CDCONCORRENTE            VARCHAR(20)          NOT NULL,
   DTEMISSAO                DATETIME                 NULL,
   DTINSERCAOPRODUTO        DATETIME                 NULL,
   HRINSERCAOPRODUTO        VARCHAR(8)               NULL,
   VLUNITARIO               DECIMAL(16,7)            NULL,
   FLCONTROLEWMW            CHAR(1)                  NULL,
   DSMENSAGEMCONTROLEWMW    VARCHAR(4000)            NULL,
   FLCONTROLEERP            CHAR(1)                  NULL,
   DSMENSAGEMCONTROLEERP    VARCHAR(4000)            NULL,
   DTRECEBIMENTO            DATETIME                 NULL,
   HRRECEBIMENTO            VARCHAR(8)               NULL,
   DTENVIOERP               DATETIME                 NULL,
   HRENVIOERP               VARCHAR(8)               NULL,
   CDUSUARIOEMISSAO         VARCHAR(20)              NULL,
   NUPEDIDO                 VARCHAR(30)              NULL,
   FLORIGEMPEDIDO           CHAR(1)                  NULL,
   CDLATITUDE               DECIMAL(23,20)           NULL,
   CDLONGITUDE              DECIMAL(23,20)           NULL,
   FLFINALIZADA             CHAR(1)                  NULL,
   NUCARIMBO                DECIMAL(9,0)         	 NULL,
   CDUSUARIO                VARCHAR(8)           NOT NULL,
   FLTIPOALTERACAO          CHAR(1)              	 NULL,
   DTALTERACAO              DATETIME             	 NULL,
   HRALTERACAO              VARCHAR(8)           	 NULL,
   CONSTRAINT PK_TBLVPPESQUISAMERCADOREG PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDPESQUISAMERCADOCONFIG, CDCLIENTE,  CDPRODUTO, CDCONCORRENTE, CDUSUARIO)
)
GO

CREATE TABLE TBLVPFOTOPESQMERPRODCONC (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
   CDPESQUISAMERCADOCONFIG	VARCHAR(20)          NOT NULL,
   NMFOTO                   VARCHAR(100)         NOT NULL,
   CDPRODUTO                VARCHAR(20)          NOT NULL,
   CDCLIENTE                VARCHAR(20)          NOT NULL,
   CDFOTO                   DECIMAL(9)               NULL,
   FLENVIADOSERVIDOR        CHAR(1)                  NULL,
   NUCARIMBO                DECIMAL(9,0)         	 NULL,
   CDUSUARIO                VARCHAR(8)           NOT NULL,
   FLTIPOALTERACAO          CHAR(1)              	 NULL,
   DTALTERACAO              DATETIME             	 NULL,
   HRALTERACAO              VARCHAR(8)           	 NULL,
   CONSTRAINT PK_TBLVPFOTOPESQMERPRODCONC PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDPESQUISAMERCADOCONFIG, NMFOTO, CDPRODUTO, CDCLIENTE, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
LAV-24197
Autor: Renan
Descrição: Nova coluna
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPNOVOCLIENTE ADD FLPRIMEIRAETAPA CHAR(1);
GO


/*------------------------------------------------------------------------
Atividade: LAV-24206 - GRUPO BIG - Venda de produtos em data crítica
Descrição: Criação da coluna FLCRITICO nas entidades Pedido, PedidoERP, Produto
Autor: Raphael Santos
Data: 18/02/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD FLCRITICO CHAR(1);
GO
ALTER TABLE TBLVPPEDIDOERP ADD FLCRITICO CHAR(1);
GO
ALTER TABLE TBLVPPEDIDO ADD FLCRITICOLIBERADOSENHA CHAR(1);
GO
ALTER TABLE TBLVPPEDIDOERP ADD FLCRITICOLIBERADOSENHA CHAR(1);
GO
ALTER TABLE TBLVPPRODUTO ADD FLCRITICO CHAR(1);
GO

/*-------------------------------------------------------------------------
Autor: João Henrique Lopes
Data: 30/03/2020
Atividade: LAV-24470 - GRUPO BIG - Pedido FOB
Descrição: Novas colunas
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPEDIDO ADD FLPENDENTEFOB CHAR(1);
GO
ALTER TABLE TBLVPPEDIDOERP ADD FLPENDENTEFOB CHAR(1);
GO
ALTER TABLE TBLVPPEDIDO ADD CDUSUARIOCANCFOB VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDOERP ADD CDUSUARIOCANCFOB VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDO ADD CDUSUARIOLIBERACAOFOB VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDOERP ADD CDUSUARIOLIBERACAOFOB VARCHAR(20);
GO
ALTER TABLE TBLVPTIPOPEDIDO ADD NUMINCONVERSAOFOB DECIMAL(9,0);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25619 - (AJUSTES) - Revisão da solução com alguns ajustes de validação Pedido FOB
Descrição: Criação da coluna NUCONVERSAOFOB na tabela de produto
Autor: Raphael Santos
Data: 30/03/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTO ADD NUCONVERSAOFOB DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-24690 GRUPO BIG - Bonificação com Verba por Grupo de Produto
Autor: João Henrique Lopes
Data: 07/04/2020
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPEDIDO ADD FLPEDIDOLIBERADOBONVERBAGRPROD CHAR(1);
GO
ALTER TABLE TBLVPPEDIDOERP ADD FLPEDIDOLIBERADOBONVERBAGRPROD CHAR(1);
GO

/*------------------------------------------------------------------------
Atividade: LAV-24694
Data: 17/03/2020
Autor: João Henrique
Descrição: Nova tabela
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPPRODUTOBLOQUEADO (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
   CDPRODUTO            VARCHAR(20)          NOT NULL,
   CDTABELAPRECO        VARCHAR(20)          NOT NULL,
   CDUSUARIOBLOQUEIO    VARCHAR(20)          NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   CDUSUARIO            VARCHAR(8)           NOT NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPPRODUTOBLOQUEADO PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDTABELAPRECO, CDUSUARIO)
)
GO


/*-------------------------------------------------------------------------
Atividade: LAV-24695 GRUPO BIG - Restrição de venda por Supervisor, Representante ou Cliente
Autor: João Henrique Lopes
Data: 16/04/2020
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPRESTRICAOCLIENTE (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
   CDRESTRICAO              VARCHAR(20)          NOT NULL,
   CDCLIENTE                VARCHAR(20)          NOT NULL,
   NUCARIMBO                DECIMAL(9,0)             NULL,
   FLTIPOALTERACAO          CHAR(1)              	 NULL,
   CDUSUARIO                VARCHAR(8)           NOT NULL,
   DTALTERACAO              DATETIME             	 NULL,
   HRALTERACAO              VARCHAR(8)           	 NULL,
   CONSTRAINT PK_TBLVPRESTRICAOCLIENTE PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDRESTRICAO, CDCLIENTE, CDUSUARIO)
)
GO

CREATE TABLE TBLVPRESTRICAOPRODUTO (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
   CDRESTRICAO              VARCHAR(20)          NOT NULL,
   CDPRODUTO                VARCHAR(20)          NOT NULL,
   NUCARIMBO                DECIMAL(9,0)             NULL,
   FLTIPOALTERACAO          CHAR(1)              	 NULL,
   CDUSUARIO                VARCHAR(8)           NOT NULL,
   DTALTERACAO              DATETIME             	 NULL,
   HRALTERACAO              VARCHAR(8)           	 NULL,
   CONSTRAINT PK_TBLVPRESTRICAOPRODUTO PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDRESTRICAO, CDPRODUTO, CDUSUARIO)
)
GO

--VERSAO 6.230

/*-------------------------------------------------------------------------
Novos campos
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD VLINDICEPLATAFORMAVENDACLIFIN DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLINDICEPLATAFORMAVENDACLIFIN DECIMAL(16,7);
GO


--VERSAO 6.231

/*-------------------------------------------------------------------------
Atividade: LAV-24930 - Mariano - Não apresentar a rentabilidade para produtos Iconic
Autor: Raphael Santos
Data: 15/04/2020
Descrição: Criação das colunas vlRentabilidadeTotal, vlPctComissaoTotal na tabela Pedido e vlPctComissaoTotal na tabela ItemPedido
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTCOMISSAOTOTAL DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTCOMISSAOTOTAL DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDO ADD VLPCTCOMISSAOTOTAL DECIMAL(16,7);
GO
ALTER TABLE TBLVPPEDIDOERP ADD VLPCTCOMISSAOTOTAL DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDO ADD VLRENTABILIDADETOTAL DECIMAL(16,7);
GO
ALTER TABLE TBLVPPEDIDOERP ADD VLRENTABILIDADETOTAL DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDO ADD VLFRETETOTAL DECIMAL(16,7);
GO
ALTER TABLE TBLVPPEDIDOERP ADD VLFRETETOTAL DECIMAL(16,7);
GO


--VERSAO 6.232

/*-------------------------------------------------------------------------
Descrição: Condicionado inserts e drops de renomeações de tabelas
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPPESQUISAMERCCONC (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDPESQUISAMERCADOCONFIG	VARCHAR(20)          NOT NULL,
   CDCONCORRENTE            VARCHAR(20)          NOT NULL,
   NUCARIMBO                DECIMAL(9,0)         	 NULL,
   CDUSUARIO                VARCHAR(8)           NOT NULL,
   FLTIPOALTERACAO          CHAR(1)              	 NULL,
   DTALTERACAO              DATETIME             	 NULL,
   HRALTERACAO              VARCHAR(8)           	 NULL,
   CONSTRAINT PK_TBLVPPESQUISAMERCCONC PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDPESQUISAMERCADOCONFIG, CDCONCORRENTE, CDUSUARIO)
)
GO

CREATE TABLE TBLVPRELNOVPESQUISAMERC (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
   CDPESQUISAMERCADOCONFIG	VARCHAR(20)          NOT NULL,
   CDTIPONOVIDADE           VARCHAR(20)          NOT NULL,
   DSNOVIDADEPESQUISA       VARCHAR(4000)            NULL,
   DTEMISSAORELATORIO       DATETIME                 NULL,
   NUCARIMBO                DECIMAL(9,0)         	 NULL,
   CDUSUARIO                VARCHAR(8)           NOT NULL,
   FLTIPOALTERACAO          CHAR(1)              	 NULL,
   DTALTERACAO              DATETIME             	 NULL,
   HRALTERACAO              VARCHAR(8)           	 NULL,
   CONSTRAINT PK_TBLVPRELNOVPESQUISAMERC PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDPESQUISAMERCADOCONFIG, CDTIPONOVIDADE, CDUSUARIO)
)
GO

--SQLSERVER
DECLARE PESQUISAMERCADOCONCORRENTE CURSOR FOR  
	SELECT * FROM INFORMATION_SCHEMA.TABLES where upper(TABLE_NAME) = 'TBLVPPESQUISAMERCADOCONCORRENTE';
OPEN PESQUISAMERCADOCONCORRENTE;  
FETCH NEXT FROM PESQUISAMERCADOCONCORRENTE;  
WHILE @@FETCH_STATUS = 0  
   BEGIN  
      FETCH NEXT FROM PESQUISAMERCADOCONCORRENTE;
	  INSERT INTO TBLVPPESQUISAMERCCONC (CDEMPRESA, CDPESQUISAMERCADOCONFIG, CDCONCORRENTE, NUCARIMBO, CDUSUARIO, FLTIPOALTERACAO, DTALTERACAO, HRALTERACAO)
		SELECT CDEMPRESA, CDPESQUISAMERCADOCONFIG, CDCONCORRENTE, NUCARIMBO, CDUSUARIO, FLTIPOALTERACAO, DTALTERACAO, HRALTERACAO FROM TBLVPPESQUISAMERCADOCONCORRENTE;
	  DROP TABLE TBLVPPESQUISAMERCADOCONCORRENTE;
   END;  
CLOSE PESQUISAMERCADOCONCORRENTE;  
DEALLOCATE PESQUISAMERCADOCONCORRENTE;  
GO

DECLARE RELNOVIDADEPESQUISAMERCADO CURSOR FOR  
	SELECT * FROM INFORMATION_SCHEMA.TABLES where upper(TABLE_NAME) = 'TBLVPRELNOVIDADEPESQUISAMERCADO';
OPEN RELNOVIDADEPESQUISAMERCADO;  
FETCH NEXT FROM RELNOVIDADEPESQUISAMERCADO;  
WHILE @@FETCH_STATUS = 0  
   BEGIN  
      FETCH NEXT FROM RELNOVIDADEPESQUISAMERCADO;
	  INSERT INTO TBLVPRELNOVPESQUISAMERC (CDEMPRESA, CDREPRESENTANTE, CDPESQUISAMERCADOCONFIG, CDTIPONOVIDADE, DSNOVIDADEPESQUISA, DTEMISSAORELATORIO, NUCARIMBO, CDUSUARIO, FLTIPOALTERACAO, DTALTERACAO, HRALTERACAO)
		SELECT CDEMPRESA, CDREPRESENTANTE, CDPESQUISAMERCADOCONFIG, CDTIPONOVIDADE, DSNOVIDADEPESQUISA, DTEMISSAORELATORIO, NUCARIMBO, CDUSUARIO, FLTIPOALTERACAO, DTALTERACAO, HRALTERACAO FROM TBLVPRELNOVIDADEPESQUISAMERCADO;
	  DROP TABLE TBLVPRELNOVIDADEPESQUISAMERCADO;
   END;  
CLOSE RELNOVIDADEPESQUISAMERCADO;  
DEALLOCATE RELNOVIDADEPESQUISAMERCADO;  
GO
--/SQLSERVER

--ORACLE
BEGIN
  FOR r_tab IN (SELECT * FROM user_tables where upper(table_name) like 'TBLVPPESQUISAMERCADOCONCORRENTE') LOOP
    execute immediate 
    	'INSERT INTO TBLVPPESQUISAMERCCONC (CDEMPRESA, CDPESQUISAMERCADOCONFIG, CDCONCORRENTE, NUCARIMBO, CDUSUARIO, FLTIPOALTERACAO, DTALTERACAO, HRALTERACAO)
			SELECT CDEMPRESA, CDPESQUISAMERCADOCONFIG, CDCONCORRENTE, NUCARIMBO, CDUSUARIO, FLTIPOALTERACAO, DTALTERACAO, HRALTERACAO FROM TBLVPPESQUISAMERCADOCONCORRENTE';
	execute immediate
		'DROP TABLE TBLVPPESQUISAMERCADOCONCORRENTE';
  END loop;
  COMMIT;
END;
/

BEGIN
  FOR r_tab IN (SELECT * FROM user_tables where upper(table_name) like 'TBLVPRELNOVIDADEPESQUISAMERCADO') LOOP
    execute immediate 
    	'INSERT INTO TBLVPRELNOVPESQUISAMERC (CDEMPRESA, CDREPRESENTANTE, CDPESQUISAMERCADOCONFIG, CDTIPONOVIDADE, DSNOVIDADEPESQUISA, DTEMISSAORELATORIO, NUCARIMBO, CDUSUARIO, FLTIPOALTERACAO, DTALTERACAO, HRALTERACAO)
			SELECT CDEMPRESA, CDREPRESENTANTE, CDPESQUISAMERCADOCONFIG, CDTIPONOVIDADE, DSNOVIDADEPESQUISA, DTEMISSAORELATORIO, NUCARIMBO, CDUSUARIO, FLTIPOALTERACAO, DTALTERACAO, HRALTERACAO FROM TBLVPRELNOVIDADEPESQUISAMERCADO';
	execute immediate
		'DROP TABLE TBLVPRELNOVIDADEPESQUISAMERCADO';
  END loop;
  COMMIT;
END;
/
--/ORACLE

--POSTGRES
DO
$func$
DECLARE
    statements CURSOR FOR
        SELECT tablename FROM pg_tables where upper(tablename) like 'TBLVPPESQUISAMERCADOCONCORRENTE';
BEGIN
    FOR stmt IN statements LOOP
        EXECUTE 'INSERT INTO TBLVPPESQUISAMERCCONC (CDEMPRESA, CDPESQUISAMERCADOCONFIG, CDCONCORRENTE, NUCARIMBO, CDUSUARIO, FLTIPOALTERACAO, DTALTERACAO, HRALTERACAO)
			SELECT CDEMPRESA, CDPESQUISAMERCADOCONFIG, CDCONCORRENTE, NUCARIMBO, CDUSUARIO, FLTIPOALTERACAO, DTALTERACAO, HRALTERACAO FROM TBLVPPESQUISAMERCADOCONCORRENTE';
		EXECUTE 'DROP TABLE TBLVPPESQUISAMERCADOCONCORRENTE';
    END LOOP;
END;
$func$ LANGUAGE plpgsql;

DO
$func$
DECLARE
    statements CURSOR FOR
        SELECT tablename FROM pg_tables where upper(tablename) like 'TBLVPRELNOVIDADEPESQUISAMERCADO';
BEGIN
    FOR stmt IN statements LOOP
        EXECUTE 'INSERT INTO TBLVPRELNOVPESQUISAMERC (CDEMPRESA, CDREPRESENTANTE, CDPESQUISAMERCADOCONFIG, CDTIPONOVIDADE, DSNOVIDADEPESQUISA, DTEMISSAORELATORIO, NUCARIMBO, CDUSUARIO, FLTIPOALTERACAO, DTALTERACAO, HRALTERACAO)
			SELECT CDEMPRESA, CDREPRESENTANTE, CDPESQUISAMERCADOCONFIG, CDTIPONOVIDADE, DSNOVIDADEPESQUISA, DTEMISSAORELATORIO, NUCARIMBO, CDUSUARIO, FLTIPOALTERACAO, DTALTERACAO, HRALTERACAO FROM TBLVPRELNOVIDADEPESQUISAMERCADO';
		EXECUTE 'DROP TABLE TBLVPRELNOVIDADEPESQUISAMERCADO';
    END LOOP;
END;
$func$ LANGUAGE plpgsql;
--/POSTGRES

/*-------------------------------------------------------------------------
Descricao: Nova coluna na IndicadorWmw
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPINDICADORWMW ADD FLGERAHISTORICOAPURACAO CHAR(1);
GO

/*-------------------------------------------------------------------------
Descricao: Nova tabela ValorIndicadorWmwHist
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPVALORINDICADORWMWHIST (
	CDEMPRESA		VARCHAR(20)			NOT NULL,
	CDREPRESENTANTE	VARCHAR(20)			NOT NULL,
	CDINDICADOR		VARCHAR(20)			NOT NULL,
	CDAPURACAO		VARCHAR(20)			NOT NULL,
	NUSEQHISTORICO	DECIMAL(9)			NOT NULL,
	DSAPURACAO		VARCHAR(20)			NULL,
	VLINDICADOR		DECIMAL(16,7)		NULL,
	DTAPURACAO		DATETIME			NULL,
	HRAPURACAO		VARCHAR(8)			NULL,
	VLMETA			DECIMAL(16,7)		NULL,
	VLINDICADORDIF	DECIMAL(16,7)		NULL,
	CDUSUARIO		VARCHAR(8)			NOT NULL,
	NUCARIMBO		DECIMAL(9)			NULL,
	FLTIPOALTERACAO	CHAR(1)			    NULL,
	DTALTERACAO     DATETIME            NULL,
   	HRALTERACAO     VARCHAR(8)          NULL,
   	CONSTRAINT PK_TBLVPVALORINDICADORWMWHIST PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDINDICADOR, CDAPURACAO, NUSEQHISTORICO, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Descrição: Criacao de colunas
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPMARGEMRENTAB ADD CDGRUPOPRODUTO1 VARCHAR(20);
GO
ALTER TABLE TBLVPMARGEMRENTAB ADD CDPRODUTO VARCHAR(20);
GO
ALTER TABLE TBLVPMARGEMRENTAB ADD FLMARGEMRENTABPEDIDO CHAR(1);
GO
ALTER TABLE TBLVPPEDIDO ADD CDMARGEMRENTAB VARCHAR(40);
GO
ALTER TABLE TBLVPPEDIDOERP ADD CDMARGEMRENTAB VARCHAR(40);
GO


--VERSAO 6.233


/*-------------------------------------------------------------------------
Descricao: Novas colunas na tabela PoliticaComercial
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPOLITICACOMERCIAL ADD VLPCTPOLITICACOMERCIALMIN DECIMAL(16,7);
GO

ALTER TABLE TBLVPPOLITICACOMERCIAL ADD VLPCTPOLITICACOMERCIALMAX DECIMAL(16,7);
GO


/*------------------------------------------------------------------------ 
Descricao: Novo campo de diferencia na tabela de tributacao
-------------------------------------------------------------------------*/ 
ALTER TABLE TBLVPTRIBUTACAO ADD VLPCTDIFERENCA DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
Novas tabelas
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPMOTIVOCHURN (
   CDMOTIVOCHURN        VARCHAR(20)          NOT NULL,
   DSMOTIVOCHURN        VARCHAR(100)             NULL,
   CDUSUARIO		VARCHAR(8)	     NOT NULL,
   NUCARIMBO		DECIMAL(9,0)		NULL,
   FLTIPOALTERACAO      CHAR(1)             	 NULL,
   DTALTERACAO          DATETIME                 NULL,
   HRALTERACAO          VARCHAR(8)         	 NULL,
   CONSTRAINT PK_TBLVPMOTIVOCHURN PRIMARY KEY (CDMOTIVOCHURN, CDUSUARIO)
)
GO

CREATE TABLE TBLVPCLIENTECHURN (
   CDEMPRESA            VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
   CDCHURN	        VARCHAR(20)          NOT NULL,
   CDCLIENTE 	        VARCHAR(20)              NULL,
   DTENTRADACHURN       DATETIME                 NULL,
   CDMOTIVOCHURN        VARCHAR(20)              NULL,
   DSOBSCHURN	        VARCHAR(4000)          	 NULL,
   CDUSUARIO		VARCHAR(8)	     NOT NULL,
   NUCARIMBO		DECIMAL(9,0)		NULL,
   FLTIPOALTERACAO      CHAR(1)             	NULL,
   DTALTERACAO          DATETIME           	NULL,
   HRALTERACAO          VARCHAR(8)         	NULL,
   CONSTRAINT PK_TBLVPCLIENTECHURN PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCHURN, CDUSUARIO)
)
GO

CREATE TABLE TBLVPCLIENTECHURNATUA (
   CDEMPRESA              VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE        VARCHAR(20)          NOT NULL,
   CDCHURN	          VARCHAR(20)          NOT NULL,
   CDCHURNATUA	          VARCHAR(20)          NOT NULL,
   CDMOTIVOCHURN          VARCHAR(20)              NULL,
   DSOBSCHURN	          VARCHAR(4000)            NULL,
   FLCONTROLEWMW         CHAR(1)             	   NULL,
   DSMENSAGEMCONTROLEWMW VARCHAR(4000)            NULL,
   FLCONTROLEERP          CHAR(1)             	   NULL,
   DSMENSAGEMCONTROLEERP  VARCHAR(4000)            NULL,
   CDUSUARIO		  VARCHAR(8)	       NOT NULL,
   NUCARIMBO		  DECIMAL(9,0)		   NULL,
   FLTIPOALTERACAO        CHAR(1)             	   NULL,
   DTALTERACAO            DATETIME           	   NULL,
   HRALTERACAO            VARCHAR(8)         	   NULL,
   CONSTRAINT PK_TBLVPCLIENTECHURNATUA PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCHURN, CDCHURNATUA, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------
Descricao: Novos campos
---------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD VLPCTACRESCIMOITEM DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDOERP ADD VLPCTACRESCIMOITEM DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
Descricao: Nova coluna na  TBLVPDIVULGAINFO
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPDIVULGAINFO ADD NMURL VARCHAR(4000) NULL;
GO


--VERSAO 6.234

/*-------------------------------------------------------------------------
Atividade: LAV-25595 - GRUPO BIG - Cotas de Venda
Autor: Raphael Santos
Data: 17/06/2020
Descrição: Remoção e criação da tabela RESTRICAOPRODUTO
-------------------------------------------------------------------------*/
DROP TABLE TBLVPRESTRICAOPRODUTO;
GO

CREATE TABLE TBLVPRESTRICAOPRODUTO (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
   CDRESTRICAO              VARCHAR(20)          NOT NULL,
   CDPRODUTO                VARCHAR(20)          NOT NULL,
   CDGRUPOPRODUTO1          VARCHAR(20)          NOT NULL,
   CDGRUPOPRODUTO2          VARCHAR(20)          NOT NULL,
   CDGRUPOPRODUTO3          VARCHAR(20)          NOT NULL,
   CDFORNECEDOR             VARCHAR(20)          NOT NULL,
   QTDRESTRICAO             DECIMAL(9,0)             NULL,
   NUCARIMBO                DECIMAL(9,0)             NULL,
   FLTIPOALTERACAO          CHAR(1)              	 NULL,
   CDUSUARIO                VARCHAR(8)           NOT NULL,
   DTALTERACAO              DATETIME             	 NULL,
   HRALTERACAO              VARCHAR(8)           	 NULL,
   CONSTRAINT PK_TBLVPRESTRICAOPRODUTO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDRESTRICAO, CDPRODUTO, CDGRUPOPRODUTO1, CDGRUPOPRODUTO2, CDGRUPOPRODUTO3, CDFORNECEDOR, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25595 - GRUPO BIG - Cotas de Venda
Autor: Raphael Santos
Data: 17/06/2020
Descrição: Criação da tabela RESTRICAO
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPRESTRICAO (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
   CDRESTRICAO              VARCHAR(20)          NOT NULL,
   NUTIPOVIGENCIARESTRICAO  DECIMAL(9,0)             NULL,
   NUNIVELCLIENTE           DECIMAL(9,0)             NULL,
   NUNIVELPRODUTO           DECIMAL(9,0)             NULL,
   DSRESTRICAO              VARCHAR(100)             NULL,
   DTINICIALVIGENCIA        DATETIME                 NULL,
   DTFIMVIGENCIA            DATETIME                 NULL,
   NUCARIMBO                DECIMAL(9,0)             NULL,
   FLTIPOALTERACAO          CHAR(1)              	 NULL,
   CDUSUARIO                VARCHAR(8)           NOT NULL,
   DTALTERACAO              DATETIME             	 NULL,
   HRALTERACAO              VARCHAR(8)           	 NULL,
   CONSTRAINT PK_TBLVPRESTRICAO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDRESTRICAO, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25862  
Autor: Renan
Descrição: Nova Coluna
Data: 03/06/2019
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMCOMBO ADD FLAGRUPADORSIMILARIDADE CHAR(1);
GO

ALTER TABLE TBLVPPRODUTO ADD CDAGRUPADORSIMILARIDADE VARCHAR(100);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-26387  
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPUSUARIOPDA ADD CDTIPOPDA VARCHAR(20);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25787
-------------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPTITULOFINANCEIRO ALTER COLUMN DTPAGAMENTO DATETIME;
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPTITULOFINANCEIRO MODIFY DTPAGAMENTO DATETIME;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPTITULOFINANCEIRO ALTER COLUMN DTPAGAMENTO TYPE DATETIME;
--/POSTGRES

--SQLSERVER
ALTER TABLE TBLVPCAMPOTELA ALTER COLUMN DSEXPRESSAO TEXT;
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPCAMPOTELA ADD (tmpDSEXPRESSAO  CLOB);
UPDATE TBLVPCAMPOTELA SET tmpDSEXPRESSAO=DSEXPRESSAO;
COMMIT;
ALTER TABLE TBLVPCAMPOTELA DROP COLUMN DSEXPRESSAO;
ALTER TABLE TBLVPCAMPOTELA RENAME COLUMN tmpDSEXPRESSAO TO DSEXPRESSAO;
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPCAMPOTELA ALTER COLUMN DSEXPRESSAO TYPE TEXT;
--/POSTGRES

/*-------------------------------------------------------------------------
Atividade: LAV-25600 GRUPO BIG - Solicitação de Autorização para Pedidos e Item do Pedido
Descrição: Criação da tabela SOLAUTORIZACAO
Autores: Raphael Santos e João Henrique
Data: 20/05/2020
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPSOLAUTORIZACAO (
   CDEMPRESA                    VARCHAR(20)         NOT NULL,
   CDREPRESENTANTE              VARCHAR(20)         NOT NULL,
   CDSOLAUTORIZACAO             VARCHAR(20)         NOT NULL,
   FLORIGEMPEDIDO               CHAR(1)             NOT NULL,
   NUPEDIDO                     VARCHAR(30)         NOT NULL,
   CDCLIENTE                    VARCHAR(20)         NOT NULL,
   CDPRODUTO                    VARCHAR(20)         NOT NULL,
   FLTIPOITEMPEDIDO             CHAR(1)             NOT NULL,
   NUSEQPRODUTO                 DECIMAL(9,0)        NOT NULL,
   CDTIPOSOLAUTORIZACAO         DECIMAL(9,0)        NOT NULL,
   QTITEMFISICO                 DECIMAL(16,7)           NULL,
   VLORIGINAL                   DECIMAL(16,7)           NULL,
   VLITEMPEDIDO                 DECIMAL(16,7)           NULL,
   VLTOTALITEMPEDIDO            DECIMAL(16,7)           NULL,
   FLAUTORIZADO                 CHAR(1)                 NULL,
   DSOBSERVACAO                 VARCHAR(1000)           NULL,
   CDUSUARIOSOLAUTORIZACAO      VARCHAR(20)             NULL,
   DTSOLAUTORIZACAO             DATETIME                NULL,
   HRSOLAUTORIZACAO             VARCHAR(5)              NULL,
   CDUSUARIOLIBSOLAUTORIZACAO   VARCHAR(20)             NULL,
   NMUSUARIOLIBSOLAUTORIZACAO   VARCHAR(100)            NULL,
   DTLIBSOLAUTORIZACAO          DATETIME                NULL,
   HRLIBSOLAUTORIZACAO          VARCHAR(5)              NULL,
   FLVISUALIZADO                CHAR(1)                 NULL,
   FLITEMEXCLUIDO               CHAR(1)                 NULL,
   CDUSUARIO	                VARCHAR(8)	        NOT NULL,
   NUCARIMBO	                DECIMAL(9,0)	        NULL,
   FLTIPOALTERACAO	            CHAR(1)			        NULL,
   DTALTERACAO	                DATETIME                NULL,
   HRALTERACAO	                VARCHAR(8)    	        NULL,
   CONSTRAINT PK_TBLVPSOLAUTORIZACAO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDSOLAUTORIZACAO, FLORIGEMPEDIDO, NUPEDIDO, CDCLIENTE, CDPRODUTO, FLTIPOITEMPEDIDO, NUSEQPRODUTO, CDTIPOSOLAUTORIZACAO, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25600 GRUPO BIG - Solicitação de Autorização para Pedidos e Item do Pedido
Descrição: Criação da tabela PERMISSAOSOLAUT
Autores: Raphael Santos e João Henrique
Data: 03/06/2020
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPPERMISSAOSOLAUT (
   CDEMPRESA                    VARCHAR(20)         NOT NULL,
   CDUSUARIOPERMISSAO           VARCHAR(20)         NOT NULL,
   CDTIPOSOLAUTORIZACAO         DECIMAL(9,0)        NOT NULL,
   CDSISTEMA                    DECIMAL(9,0)        NOT NULL,
   FLSOMENTELEITURA             CHAR(1)                 NULL,
   FLIGNORAUSUARIOGRUPOPROD     CHAR(1)                 NULL,
   CDUSUARIO	                VARCHAR(8)	        NOT NULL,
   NUCARIMBO	                DECIMAL(9,0)	        NULL,
   FLTIPOALTERACAO	            CHAR(1)			        NULL,
   DTALTERACAO	                DATETIME                NULL,
   HRALTERACAO	                VARCHAR(8)    	        NULL,
   CONSTRAINT PK_TBLVPPERMISSAOSOLAUT PRIMARY KEY (CDEMPRESA, CDUSUARIOPERMISSAO, CDTIPOSOLAUTORIZACAO, CDSISTEMA, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25600 GRUPO BIG - Solicitação de Autorização para Pedidos e Item do Pedido
Descrição: Criação da tabela USUARIOGRUPOPRODUTO
Autores: Raphael Santos e João Henrique
Data: 03/06/2020
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPUSUARIOGRUPOPRODUTO (
   CDEMPRESA                    VARCHAR(20)         NOT NULL,
   CDUSUARIOGRUPOPRODUTO        VARCHAR(20)         NOT NULL,
   CDGRUPOPRODUTO1              VARCHAR(20)         NOT NULL,
   CDUSUARIO	                VARCHAR(8)	        NOT NULL,
   NUCARIMBO	                DECIMAL(9,0)	        NULL,
   FLTIPOALTERACAO	            CHAR(1)			        NULL,
   DTALTERACAO	                DATETIME                NULL,
   HRALTERACAO	                VARCHAR(8)    	        NULL,
   CONSTRAINT PK_TBLVPUSUARIOGRUPOPRODUTO PRIMARY KEY (CDEMPRESA, CDUSUARIOGRUPOPRODUTO, CDGRUPOPRODUTO1, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25600 GRUPO BIG - Solicitação de Autorização para Pedidos e Item do Pedido
Descrição: Remoção da coluna FLCRITICOLIBERADOSENHA e FLPEDIDOLIBERADOBONVERBAGRPROD na tabela de PEDIDO
Autores: Raphael Santos e João Henrique
Data: 03/06/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO DROP COLUMN FLCRITICOLIBERADOSENHA;
GO
ALTER TABLE TBLVPPEDIDOERP DROP COLUMN FLCRITICOLIBERADOSENHA;
GO
ALTER TABLE TBLVPPEDIDO DROP COLUMN FLPEDIDOLIBERADOBONVERBAGRPROD;
GO
ALTER TABLE TBLVPPEDIDOERP DROP COLUMN FLPEDIDOLIBERADOBONVERBAGRPROD;
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25600 GRUPO BIG - Solicitação de Autorização para Pedidos e Item do Pedido
Descrição: Criação da coluna VLMINAUTORIZACAOPRECO na tabela de PRODUTO
Autores: Raphael Santos e João Henrique
Data: 04/06/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTO ADD VLMINAUTORIZACAOPRECO DECIMAL(16,7);
GO

/*--------------------------------------------------------------------
 Removido campo cdUsuario de algumas tabelas
---------------------------------------------------------------------*/

DROP TABLE TBLVPTEMASISTEMA;
DROP TABLE TBLVPCORSISTEMA;
DROP TABLE TBLVPPERSONALIZACAO;
DROP TABLE TBLVPCONFIGINTEGWEBTC;
DROP TABLE TBLVPCONEXAOPDA;
DROP TABLE TBLVPVALORPARAMETRO;
DROP TABLE TBLVPACAOTELA;

CREATE TABLE TBLVPTEMASISTEMA (
   CDTEMA               DECIMAL(9)           NOT NULL,
   CDESQUEMACOR         DECIMAL(9)           NULL,
   DSTEMA               VARCHAR(100)         NULL,
   FLDEFAULT            CHAR(1)              NULL,
   NUTAMANHOFONTEPADRAO DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPTEMASISTEMA PRIMARY KEY NONCLUSTERED (CDTEMA)
)
GO

CREATE TABLE TBLVPCORSISTEMA (
   CDESQUEMACOR         DECIMAL(9)           NOT NULL,
   CDCOR                DECIMAL(9)           NOT NULL,
   DSUTILIZACAO         VARCHAR(200)         NULL,
   VLR                  DECIMAL(9)           NULL,
   VLG                  DECIMAL(9)           NULL,
   VLB                  DECIMAL(9)           NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPCORSISTEMA PRIMARY KEY NONCLUSTERED (CDESQUEMACOR, CDCOR)
)
GO

CREATE TABLE TBLVPPERSONALIZACAO (
   CDSISTEMA            DECIMAL(9)           NOT NULL,
   CDPERSONALIZACAO     DECIMAL(9)           NOT NULL,
   FLPADRAO             CHAR(1)              NOT NULL,
   IMPERSONALIZACAO     VARBINARY(MAX)       NOT NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   NUCARIMBO            DECIMAL(9)           NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPPERSONALIZACAO PRIMARY KEY (CDSISTEMA, CDPERSONALIZACAO, FLPADRAO)
)
GO

CREATE TABLE TBLVPCONFIGINTEGWEBTC (
   DSTABELA             VARCHAR(50)          NOT NULL,
   DSCHAVE              VARCHAR(200)         NULL,
   FLREMESSA            CHAR(1)              NULL,
   FLRETORNO            CHAR(1)              NULL,
   FLATIVO              CHAR(1)              NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPCONFIGINTEGWEBTC PRIMARY KEY NONCLUSTERED (DSTABELA)
)
GO

CREATE TABLE TBLVPCONEXAOPDA (
   CDCONEXAO            VARCHAR(20)          NOT NULL,
   DSCONEXAO            VARCHAR(30)          NULL,
   DSHOSTFTP            VARCHAR(20)          NULL,
   NUPORTAFTP           DECIMAL(9)           NULL,
   DSURLWEBSERVICE      VARCHAR(100)         NULL,
   FLCONEXAODISCADA     CHAR(1)              NULL,
   FLDEFAULT            CHAR(1)              NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPCONEXAOPDA PRIMARY KEY NONCLUSTERED (CDCONEXAO)
)
GO

CREATE TABLE TBLVPVALORPARAMETRO (
   CDSISTEMA            DECIMAL(9)           NOT NULL,
   CDPARAMETRO          DECIMAL(9)           NOT NULL,
   NMENTIDADE           VARCHAR(30)          NOT NULL,
   VLCHAVE              VARCHAR(150)         NOT NULL,
   VLPARAMETRO          VARCHAR(1000)        NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPVALORPARAMETRO PRIMARY KEY NONCLUSTERED (CDSISTEMA, CDPARAMETRO, NMENTIDADE, VLCHAVE)
)
GO

CREATE TABLE TBLVPACAOTELA (
   CDSISTEMA            DECIMAL(9)           NOT NULL,
   CDTELA               DECIMAL(9)           NOT NULL,
   CDACAO               DECIMAL(9)           NOT NULL,
   CDTELADESTINO        DECIMAL(9)           NULL,
   NMCOMANDOACAO        VARCHAR(500)         NOT NULL,
   NMCONTEXTOACAO       VARCHAR(250)         NULL,
   FLALVOINTERNO        CHAR(1)              NULL,
   NUCARIMBO            DECIMAL(9,0)         NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   DTALTERACAO          DATETIME             NULL,
   HRALTERACAO          VARCHAR(8)           NULL,
   CONSTRAINT PK_TBLVPACAOTELA PRIMARY KEY (CDSISTEMA, CDTELA, CDACAO)
)
GO


--VERSAO 6.235

/*-------------------------------------------------------------------
Descricao: Novas colunas
---------------------------------------------------------------------*/

ALTER TABLE TBLVPREPRESENTANTE ADD CDLATITUDE DECIMAL(23,20);
GO

ALTER TABLE TBLVPREPRESENTANTE ADD CDLONGITUDE DECIMAL(23,20);
GO

--VERSAO 6.236

/*-------------------------------------------------------------------------
Descricao: Novas Colunas
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPVERBAGRUPOSALDO ADD VLTOLERANCIA DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLTOLERANCIAVERGRUSALDO DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLTOLERANCIAVERGRUSALDO DECIMAL(16,7);
GO

--VERSAO 6.237

--VERSAO 6.238

/*-------------------------------------------------------------------------
Descricao: Novas Tabelas, e Colunas.
------------------------------------------------------------------------*/

CREATE TABLE TBLVPPRODUTOCLIENTECOD (
	CDEMPRESA       VARCHAR(20)     NOT NULL,
	CDREPRESENTANTE VARCHAR(20)     NOT NULL,
	CDPRODUTO 	VARCHAR(20)     NOT NULL,
	CDCLIENTE 	VARCHAR(20)     NOT NULL,
	CDPRODUTOCLIENTE VARCHAR(20) 	    NULL,
	CDUSUARIO	 VARCHAR(8)	NOT NULL,
	NUCARIMBO	 DECIMAL(9,0)	    NULL,
	FLTIPOALTERACAO	 CHAR(1)	    NULL,
	DTALTERACAO	 DATETIME	    NULL,
	HRALTERACAO	 VARCHAR(8)	    NULL,
    CONSTRAINT PK_TBLVPPRODUTOCLIENTECOD PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDCLIENTE, CDUSUARIO)
)
GO

CREATE TABLE TBLVPPRODUTOCLIENTECODATUA (
	CDEMPRESA       VARCHAR(20)     NOT NULL,
	CDREPRESENTANTE VARCHAR(20)     NOT NULL,
	CDPRODUTO 	VARCHAR(20)     NOT NULL,
	CDCLIENTE 	VARCHAR(20)     NOT NULL,
	CDPRODUTOCLIENTEATUA	VARCHAR(20)	NOT NULL, 
	CDPRODUTOCLIENTE VARCHAR(20) 	    NULL,
	FLACAO		CHAR(1)			NULL,
	FLCONTROLEWMW	CHAR(1)			NULL,
	DSMENSAGEMCONTROLEWMW	VARCHAR(4000)	NULL,
	DSMENSAGEMCONTROLEERP	VARCHAR(4000)	NULL,
	FLCONTROLEERP	CHAR(1)		NULL,
	DTENVIOERP		DATE 		NULL,
	HRENVIOERP		VARCHAR(5)	NULL,
	CDUSUARIO	 VARCHAR(8)	NOT NULL,
	NUCARIMBO	 DECIMAL(9,0)	    NULL,
	FLTIPOALTERACAO	 CHAR(1)	    NULL,
	DTALTERACAO	 DATETIME	    NULL,
	HRALTERACAO	 VARCHAR(8)	    NULL,
    CONSTRAINT PK_TBLVPPRODUTOCLIENTECODATUA PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDCLIENTE, CDPRODUTOCLIENTEATUA, CDUSUARIO)
)
GO

ALTER TABLE TBLVPITEMPEDIDO ADD CDPRODUTOCLIENTE VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD CDPRODUTOCLIENTE VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDO ADD FLCODIGOINTERNOCLIENTE CHAR(1);
GO

ALTER TABLE TBLVPPEDIDOERP ADD FLCODIGOINTERNOCLIENTE CHAR(1);
GO

--VERSAO 6.239

/*------------------------------------------------------------------
LAV-24904 - ICONIC - Destacar Novo Cliente e Prospect no Painel
Autor: Danilo M
Data: 06/07/2020
--------------------------------------------------------------------*/

ALTER TABLE TBLVPVISITA ADD FLNOVOCLIENTEPROSPECT CHAR(1) NULL;
GO

ALTER TABLE TBLVPVISITA ADD FLLOCALIZACAOCHEGADA CHAR(1);
GO

ALTER TABLE TBLVPVISITA ADD FLLOCALIZACAOSAIDA CHAR(1);
GO

--VERSAO 6.240

--VERSAO 6.241

/*------------------------------------------------------------------------ 
Descricao: Nova tabela TBLVPMOTIVOPERDA
-------------------------------------------------------------------------*/ 
CREATE TABLE TBLVPMOTIVOPERDA (
    CDEMPRESA       		VARCHAR(20)     	    NOT NULL,
    CDREPRESENTANTE 		VARCHAR(20)       	  	NOT NULL,
    CDMOTIVOPERDA   		VARCHAR(20)         	NOT NULL,
    DSMOTIVOPERDA   		VARCHAR(100)         	NULL,
	CDUSUARIO				VARCHAR(8)				NOT NULL,
	NUCARIMBO				DECIMAL(9,0)			NULL,
	FLTIPOALTERACAO			CHAR(1)					NULL,
	DTALTERACAO				DATETIME				NULL,
	HRALTERACAO				VARCHAR(8)				NULL,
	CONSTRAINT		PK_TBLVPMOTIVOPERDA	PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDMOTIVOPERDA, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------ 
Descricao: Novas colunas nas tabelas de pedido e pedidoerp
-------------------------------------------------------------------------*/ 
ALTER TABLE TBLVPPEDIDO ADD CDMOTIVOPERDA VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDOERP ADD CDMOTIVOPERDA VARCHAR(20);
GO

/*------------------------------------------------------------------------
Descricao: Correcao de nomes de colunas
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPNFEESTOQUE ADD CDPEDIDOESTOQUE VARCHAR(20);
GO

--SQLSERVER
EXEC SP_RENAME 'TBLVPNFEESTOQUE.DSNATURAOPERACAO', 'DSNATUREZAOPERACAO', 'COLUMN';
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPNFEESTOQUE RENAME COLUMN DSNATURAOPERACAO to DSNATUREZAOPERACAO;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPNFEESTOQUE RENAME COLUMN DSNATURAOPERACAO to DSNATUREZAOPERACAO;
--/POSTGRES

/*-------------------------------------------------------------------------
Descricao: Criado novo campo na MetaPorGrupoProd
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPMETAPORGRUPOPROD ADD CDAGRUPADORMETA VARCHAR(20);
GO

/*------------------------------------------------------------------
Validacao do multiplo especial para todas as unidades do produto
--------------------------------------------------------------------*/

ALTER TABLE TBLVPPRODUTOUNIDADE ADD NUMULTIPLOESPECIAL DECIMAL(16,7) NULL;
GO

/*-------------------------------------------------------------------------
Descricao: Nova Coluna
------------------------------------------------------------------------*/
ALTER TABLE TBLVPKIT ADD FLEDITADESCONTO CHAR(1);
GO

--VERSAO 6.242

/*-------------------------------------------------------------------------
Atividade: LAV-24474 GRUPO BIG - Simulador de produtos para o Kit validando o lucro e margem
Autores: Renan e João Henrique
Data: 22/06/2020
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMKIT ADD CDTABELAPRECO VARCHAR(20) NULL;
GO
UPDATE TBLVPITEMKIT SET CDTABELAPRECO = '0';
GO
ALTER TABLE TBLVPKIT ADD CDTABELAPRECO VARCHAR(20) NULL;
GO
UPDATE TBLVPKIT SET CDTABELAPRECO = '0';
GO

--SQLSERVER
ALTER TABLE TBLVPITEMKIT ALTER COLUMN CDTABELAPRECO VARCHAR(30) NOT NULL;
GO
ALTER TABLE TBLVPITEMKIT DROP CONSTRAINT PK_TBLVPITEMKIT;
GO
ALTER TABLE TBLVPITEMKIT ADD CONSTRAINT PK_TBLVPITEMKIT PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDKIT, CDPRODUTO, CDTABELAPRECO, CDUSUARIO);
GO
ALTER TABLE TBLVPKIT ALTER COLUMN CDTABELAPRECO VARCHAR(30) NOT NULL;
GO
ALTER TABLE TBLVPKIT DROP CONSTRAINT PK_TBLVPKIT;
GO
ALTER TABLE TBLVPKIT ADD CONSTRAINT PK_TBLVPKIT PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDKIT, CDTABELAPRECO, CDUSUARIO);
GO
--/SQLSERVER


--ORACLE
ALTER TABLE TBLVPITEMKIT MODIFY CDTABELAPRECO VARCHAR(30) NOT NULL;
/

ALTER TABLE TBLVPITEMKIT DROP CONSTRAINT PK_TBLVPITEMKIT;
/

DROP INDEX PK_TBLVPITEMKIT;
/

ALTER TABLE TBLVPITEMKIT ADD CONSTRAINT PK_TBLVPITEMKIT PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDKIT, CDPRODUTO, CDTABELAPRECO, CDUSUARIO);
/

ALTER TABLE TBLVPKIT MODIFY CDTABELAPRECO VARCHAR(30) NOT NULL;
/

ALTER TABLE TBLVPKIT DROP CONSTRAINT PK_TBLVPKIT;
/

DROP INDEX PK_TBLVPKIT;
/

ALTER TABLE TBLVPKIT ADD CONSTRAINT PK_TBLVPKIT PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDKIT, CDTABELAPRECO, CDUSUARIO);
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPITEMKIT ALTER CDTABELAPRECO TYPE VARCHAR(30), ALTER CDTABELAPRECO SET NOT NULL;
ALTER TABLE TBLVPITEMKIT DROP CONSTRAINT PK_TBLVPITEMKIT;
ALTER TABLE TBLVPITEMKIT ADD CONSTRAINT PK_TBLVPITEMKIT PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDKIT, CDPRODUTO, CDTABELAPRECO, CDUSUARIO);
ALTER TABLE TBLVPKIT ALTER CDTABELAPRECO TYPE VARCHAR(30), ALTER CDTABELAPRECO SET NOT NULL;
ALTER TABLE TBLVPKIT DROP CONSTRAINT PK_TBLVPKIT;
ALTER TABLE TBLVPKIT ADD CONSTRAINT PK_TBLVPKIT PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDKIT, CDTABELAPRECO, CDUSUARIO);
--/POSTGRES


ALTER TABLE TBLVPITEMKIT ADD VLUNITARIOKIT DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMKIT ADD QTITEMKIT DECIMAL(9,0);
GO
ALTER TABLE TBLVPITEMKIT ADD FLAGRUPADORSIMILARIDADE CHAR(1);
GO
ALTER TABLE TBLVPITEMTABELAPRECO ADD VLLUCROZERO DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
Autor: Gustavo Heidemann
Atividade: LAV-26962
Descrição: Nova Coluna
Data: 03/08/2020
------------------------------------------------------------------------*/
ALTER TABLE TBLVPCLIENTE ADD FLCODIGOINTERNOCLIENTE CHAR(1);
GO

--VERSAO 6.243


/*-------------------------------------------------------------------------
Atividade: LAV-27104 - Grupo BIG - Produto similar causando lentidao enorme no envio de atualizacao
Descricao: Criacao da coluna cdAgrupProdSimilar na tabela de Produto
Autor: Raphael Santos
Data: 10/08/2020
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPRODUTO ADD CDAGRUPPRODSIMILAR VARCHAR(100);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25978 Novas colunas
Autor: Renan
Data: 20/05/2019
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMTABELAPRECO ADD VLCFOP VARCHAR(100);
GO

ALTER TABLE TBLVPITEMTABELAPRECO ADD VLPCTPISCOFINS DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
Autor: Gustavo Heidemann
Atividade: LAV-23148
Descrição: Nova Coluna
Data: 06/08/2020
------------------------------------------------------------------------*/

ALTER TABLE TBLVPTABELAPRECO ADD FLSOMENTECATALOGO CHAR(1);
GO

/*------------------------------------------------------------------------
Descricao: LAV-26571 - Alteracao de colunas
-------------------------------------------------------------------------*/

--SQLSERVER
EXEC SP_RENAME 'TBLVPRESTRICAOVENDAUN.CDTIPOPEDIDO', 'CDRESTRICAOVENDAUN', 'COLUMN';
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPRESTRICAOVENDAUN RENAME COLUMN CDTIPOPEDIDO to CDRESTRICAOVENDAUN;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPRESTRICAOVENDAUN RENAME COLUMN CDTIPOPEDIDO to CDRESTRICAOVENDAUN;
--/POSTGRES

ALTER TABLE TBLVPRESTRICAOVENDAUN ADD CDTIPOPEDIDO VARCHAR(20);
GO
ALTER TABLE TBLVPRESTRICAOVENDAUN ADD CDTABELAPRECO VARCHAR(20);
GO

--Define a nova coluna CDTABELAPRECO com valores iniciais zerados

UPDATE TBLVPRESTRICAOVENDAUN SET CDTABELAPRECO = '0';

/*-------------------------------------------------------------------------
Descricao: Novas tabelas
Data: 22/10/2018
Atividade: LAV-24654
------------------------------------------------------------------------*/
CREATE TABLE TBLVPMARCADORPEDIDO (
	CDEMPRESA            VARCHAR(20)          NOT NULL,
	CDREPRESENTANTE      VARCHAR(20)          NOT NULL,
	FLORIGEMPEDIDO       VARCHAR(1)          NOT NULL,
	NUPEDIDO            VARCHAR(20)          NOT NULL,
	CDMARCADOR           VARCHAR(20)          NOT NULL,
	CDUSUARIO				VARCHAR(8)			NOT NULL,
	NUCARIMBO				DECIMAL(9,0)			NULL,
	FLTIPOALTERACAO			CHAR(1)					NULL,
	DTALTERACAO				DATETIME				NULL,
	HRALTERACAO				VARCHAR(8)				NULL,
	CONSTRAINT		PK_TBLVPMARCADORPEDIDO	PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, FLORIGEMPEDIDO, NUPEDIDO, CDMARCADOR, CDUSUARIO)
)
GO

--VERSAO 6.243-1

/*-------------------------------------------------------------------------
Autor: Daniel Barbosa
Atividade: LAV-27265
Descrição: Alterar tamanho da coluna cdTabelaPreco
Data: 20/08/2020
------------------------------------------------------------------------*/

--SQLSERVER

ALTER TABLE TBLVPRESTRICAOVENDAUN ALTER COLUMN CDTABELAPRECO VARCHAR(30);
GO

--/SQLSERVER

--ORACLE

ALTER TABLE TBLVPRESTRICAOVENDAUN MODIFY CDTABELAPRECO VARCHAR(30);
/

--/ORACLE

--POSTGRES

ALTER TABLE TBLVPRESTRICAOVENDAUN ALTER CDTABELAPRECO TYPE VARCHAR(30);

--/POSTGRES

/*-------------------------------------------------------------------------
Autor: Daniel Barbosa
Atividade: LAV-27266
Descrição: 
Data: 20/08/2020
------------------------------------------------------------------------*/

--SQLSERVER

ALTER TABLE TBLVPMARCADORPEDIDO ALTER COLUMN NUPEDIDO VARCHAR(30) NOT NULL;
GO

--/SQLSERVER

--ORACLE

ALTER TABLE TBLVPMARCADORPEDIDO MODIFY NUPEDIDO VARCHAR(30);
/

--/ORACLE

--POSTGRES

ALTER TABLE TBLVPMARCADORPEDIDO ALTER NUPEDIDO TYPE VARCHAR(30);

--/POSTGRES



--VERSAO 6.244

/*-------------------------------------------------------------------------
Atividade: LAV-27219 - Karsten - Não está buscando politica comercial correta
Autor: Raphael Santos
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPCOLECAO DROP COLUMN FLATIVO;
GO

ALTER TABLE TBLVPCOLECAOSTATUS DROP COLUMN FLATIVO;
GO

ALTER TABLE TBLVPCONJUNTO DROP COLUMN FLATIVO;
GO

ALTER TABLE TBLVPFAMILIAPRODUTO DROP COLUMN FLATIVO;
GO

ALTER TABLE TBLVPGRUPODESCCLI DROP COLUMN FLATIVO;
GO

ALTER TABLE TBLVPLOCALESTOQUE DROP COLUMN FLATIVO;
GO

ALTER TABLE TBLVPMOTIVOCOLETA DROP COLUMN FLATIVO;
GO

ALTER TABLE TBLVPPOLITICACOMERCIAL DROP COLUMN FLATIVO;
GO

ALTER TABLE TBLVPPOLITICACOMERCIALFAIXA DROP COLUMN FLATIVO;
GO

ALTER TABLE TBLVPPRODUTOATRIBUTO DROP COLUMN FLATIVO;
GO



/*-------------------------------------------------------------------------
Atividade: LAV-26911 - GRUPO BIG - Replicar Combo e Kit para mais de uma Tabela de Preço por vez
Autor: Joao Henrique
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPKIT ADD FLREPLICAPARCIAL CHAR(1);
GO

ALTER TABLE TBLVPCOMBO ADD FLREPLICAPARCIAL CHAR(1);
GO

/*------------------------------------------------------------------
LAV-26998
Autor: Renan
--------------------------------------------------------------------*/

ALTER TABLE TBLVPDESCQUANTIDADE ADD DTINICIALVIGENCIA DATETIME;
GO

ALTER TABLE TBLVPDESCQUANTIDADE ADD DTFIMVIGENCIA DATETIME;
GO


/*-------------------------------------------------------------------------
Atividade: LAV-25951 - Colgate - Desconto Progressivo
Autor: Raphael Santos
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMPEDIDO ADD CDDESCPROGRESSIVO VARCHAR(20);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTDESCPROG DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD CDDESCPROGRESSIVO VARCHAR(20);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTDESCPROG DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25951 - Colgate - Desconto Progressivo
Autor: Joao Henrique
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPEDIDO ADD DTFATURAMENTO DATETIME;
GO
ALTER TABLE TBLVPPEDIDOERP ADD DTFATURAMENTO DATETIME;
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25951 - Colgate - Desconto Progressivo
Autor: Raphael Santos
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPRODUTO ADD CDFAMILIADESCPROG VARCHAR(20);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25951 - Colgate - Desconto Progressivo
Autor: Raphael Santos
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPCLIENTE ADD CDFAIXACLI VARCHAR(20);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25951 - Colgate - Desconto Progressivo
Autor: Raphael Santos
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPDESCPROGRESSIVOCONFIG (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
   CDDESCPROGRESSIVO        VARCHAR(20)          NOT NULL,
   NUNIVELCLIENTE           DECIMAL(9,0)         NOT NULL,
   DSDESCPROGRESSIVO        VARCHAR(100)             NULL,
   VLMINDESCPROGRESSIVO     DECIMAL(16,7)            NULL,
   DTINICIALVIGENCIA        DATETIME             	 NULL,
   DTFIMVIGENCIA            DATETIME             	 NULL,
   CDUSUARIO	            VARCHAR(8)	         NOT NULL,
   NUCARIMBO	            DECIMAL(9,0)	         NULL,
   FLTIPOALTERACAO	        CHAR(1)			         NULL,
   DTALTERACAO	            DATETIME                 NULL,
   HRALTERACAO	            VARCHAR(8)    	         NULL,
   CONSTRAINT PK_TBLVPDESCPROGRESSIVOCONFIG PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDDESCPROGRESSIVO, NUNIVELCLIENTE, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25951 - Colgate - Desconto Progressivo
Autor: Raphael Santos
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPDESCPROGCONFIGFADES (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
   CDDESCPROGRESSIVO        VARCHAR(20)          NOT NULL,
   QTFAMILIA                DECIMAL(9,0)         NOT NULL,
   VLPCTDESCPROG            DECIMAL(16,7)            NULL,
   DSFAIXA                  VARCHAR(100)             NULL,
   CDUSUARIO	            VARCHAR(8)	         NOT NULL,
   NUCARIMBO	            DECIMAL(9,0)	         NULL,
   FLTIPOALTERACAO	        CHAR(1)			         NULL,
   DTALTERACAO	            DATETIME                 NULL,
   HRALTERACAO	            VARCHAR(8)    	         NULL,
   CONSTRAINT PK_TBLVPDESCPROGRESSIVOFAIXA PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDDESCPROGRESSIVO, QTFAMILIA, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25951 - Colgate - Desconto Progressivo
Autor: Raphael Santos
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPDESCPROGCONFIGFAM (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
   CDDESCPROGRESSIVO        VARCHAR(20)          NOT NULL,
   CDFAMILIADESCPROG        VARCHAR(20)          NOT NULL,
   FLTIPOFAMILIAPRO         CHAR(1)                  NULL,
   FLTIPOFAMILIACON         CHAR(1)                  NULL,
   FLFAMACUVALORMIN         CHAR(1)                  NULL,
   CDUSUARIO	            VARCHAR(8)	         NOT NULL,
   NUCARIMBO	            DECIMAL(9,0)	         NULL,
   FLTIPOALTERACAO	        CHAR(1)			         NULL,
   DTALTERACAO	            DATETIME                 NULL,
   HRALTERACAO	            VARCHAR(8)    	         NULL,
   CONSTRAINT PK_TBLVPDESCPROGCONFIGFAM PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDDESCPROGRESSIVO, CDFAMILIADESCPROG, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25951 - Colgate - Desconto Progressivo
Autor: Raphael Santos
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPDESCPROGFAMILIA (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
   CDFAMILIADESCPROG        VARCHAR(20)          NOT NULL,
   DSFAMILIAPROD            VARCHAR(400)             NULL,
   CDUSUARIO	            VARCHAR(8)	         NOT NULL,
   NUCARIMBO	            DECIMAL(9,0)	         NULL,
   FLTIPOALTERACAO	        CHAR(1)			         NULL,
   DTALTERACAO	            DATETIME                 NULL,
   HRALTERACAO	            VARCHAR(8)    	         NULL,
   CONSTRAINT PK_TBLVPDESCPROGFAMILIA PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDFAMILIADESCPROG, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25951 - Colgate - Desconto Progressivo
Autor: Raphael Santos
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPDESCPROGFAIXA (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
   CDFAIXACLI               VARCHAR(20)          NOT NULL,
   DSFAIXACLI               VARCHAR(400)             NULL,
   CDUSUARIO	            VARCHAR(8)	         NOT NULL,
   NUCARIMBO	            DECIMAL(9,0)	         NULL,
   FLTIPOALTERACAO	        CHAR(1)			         NULL,
   DTALTERACAO	            DATETIME                 NULL,
   HRALTERACAO	            VARCHAR(8)    	         NULL,
   CONSTRAINT PK_TBLVPDESCPROGFAIXA PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDFAIXACLI, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-25951 - Colgate - Desconto Progressivo
Autor: Raphael Santos
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPDESCPROGCONFIGFACLI (
   CDEMPRESA                VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
   CDDESCPROGRESSIVO        VARCHAR(20)          NOT NULL,
   CDFAIXACLI               VARCHAR(20)          NOT NULL,
   CDCLIENTE                VARCHAR(20)          NOT NULL,
   CDUSUARIO	            VARCHAR(8)	         NOT NULL,
   NUCARIMBO	            DECIMAL(9,0)	         NULL,
   FLTIPOALTERACAO	        CHAR(1)			         NULL,
   DTALTERACAO	            DATETIME                 NULL,
   HRALTERACAO	            VARCHAR(8)    	         NULL,
   CONSTRAINT PK_TBLVPDESCPROGCONFIGFACLI PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDDESCPROGRESSIVO, CDFAIXACLI, CDCLIENTE, CDUSUARIO)
)
GO

/*------------------------------------------------------------------
LAV-25081 - Adicionar novas colunas para validacao do ignora desconto
Autor: Daniel Barbosa
--------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMPEDIDO ADD FLIGNORADESCQTD CHAR(1);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD FLIGNORADESCQTDPRO CHAR(1);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD FLIGNORADESCQTD CHAR(1);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD FLIGNORADESCQTDPRO CHAR(1);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-27521 - Karsten - Scripts duplicados v2
Autor: Raphael Santos
-------------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPLINHA DROP CONSTRAINT PK_TBLVPLINHA;
GO
ALTER TABLE TBLVPLINHA ALTER COLUMN CDLINHA VARCHAR(20) NOT NULL;
GO
ALTER TABLE TBLVPLINHA ADD CONSTRAINT PK_TBLVPLINHA PRIMARY KEY (CDEMPRESA, CDLINHA, CDUSUARIO);
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPLINHA DROP CONSTRAINT PK_TBLVPLINHA;
/

DROP INDEX PK_TBLVPLINHA;
/

ALTER TABLE TBLVPLINHA MODIFY CDLINHA VARCHAR(20);
/

ALTER TABLE TBLVPLINHA ADD CONSTRAINT PK_TBLVPLINHA PRIMARY KEY (CDEMPRESA, CDLINHA, CDUSUARIO);
/

--/ORACLE

--POSTGRES
ALTER TABLE TBLVPLINHA DROP CONSTRAINT PK_TBLVPLINHA;
ALTER TABLE TBLVPLINHA ALTER COLUMN CDLINHA type VARCHAR(20);
ALTER TABLE TBLVPLINHA ADD CONSTRAINT PK_TBLVPLINHA PRIMARY KEY (CDEMPRESA, CDLINHA, CDUSUARIO);
--/POSTGRES

--VERSAO 6.245

/*------------------------------------------------------------------------
Atividade: LAV-26971 - Karsten - Familia de produto X política Comercial
Autor: Raphael Santos
Data: 04/09/2020
Descrição: Adicionado coluna CDFAMILIAPADRAO na entidade de produto
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTO ADD CDFAMILIAPADRAO VARCHAR(20);
GO

/*-------------------------------------------------------------------------
Autor: Gustavo Heidemann
Atividade: LAV-26835
Descrição: Nova Tabela
Data: 08/09/2020
------------------------------------------------------------------------*/
CREATE TABLE TBLVPMOTIVOPENDENCIAJUST (
	CDEMPRESA		VARCHAR(20)	NOT NULL,
	CDREPRESENTANTE		VARCHAR(20)	NOT NULL,
	CDMOTIVOPENDENCIA	VARCHAR(20)	NOT NULL,
	CDMOTIVOPENDENCIAJUST	VARCHAR(20)	NOT NULL,
	DSMOTIVOPENDENCIAJUST	VARCHAR(100)	NULL,
	FLUSAOBSERVACAO		CHAR(1)		NULL,
	CDUSUARIO		VARCHAR(20)	NOT NULL,
	NUCARIMBO		DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO		CHAR(1)		NULL,
	DTALTERACAO		DATETIME	NULL,
	HRALTERACAO		VARCHAR(8)	NULL,
	CONSTRAINT PK_TBLVPMOTIVOPENDENCIAJUST PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDMOTIVOPENDENCIA, CDMOTIVOPENDENCIAJUST, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Autor: Gustavo Heidemann
Atividade: LAV-26835
Descrição: Novas Colunas
Data: 09/09/2020
------------------------------------------------------------------------*/
ALTER TABLE TBLVPMOTIVOPENDENCIA ADD NUPRIORIDADEJUST DECIMAL(9,0);
GO

ALTER TABLE TBLVPPEDIDO ADD CDMOTIVOPENDENCIA VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDO ADD CDMOTIVOPENDENCIAJUST VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDO ADD DSOBSMOTIVOPENDENCIA VARCHAR(4000);
GO

ALTER TABLE TBLVPPEDIDOERP ADD CDMOTIVOPENDENCIA VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDOERP ADD CDMOTIVOPENDENCIAJUST VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDOERP ADD DSOBSMOTIVOPENDENCIA VARCHAR(4000);
GO

/*-------------------------------------------------------------------------
Autor: Gustavo Heidemann
Atividade: LAV-26838
Descrição: Nova Coluna
Data: 04/09/2020
------------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTODESTAQUE ADD FLFILTROSELECIONADO CHAR(1);
GO

/*------------------------------------------------------------------
LAV-26844 - Salvar o dsProduto na itemPedido para futuras consultas.
Autor: Daniel Barbosa
Data: 08/09/2020
--------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMPEDIDO ADD DSPRODUTO VARCHAR(100);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD DSPRODUTO VARCHAR(100);
GO

/*-------------------------------------------------------------------------
Descrição: Nova tabela
Autor: Renan
Data: 21/06/2019
------------------------------------------------------------------------*/
CREATE TABLE TBLVPMARCADORPRODUTO (
	CDEMPRESA		VARCHAR(20)	NOT NULL,
	CDREPRESENTANTE	VARCHAR(20)	NOT NULL,
	CDPRODUTO		VARCHAR(20)	NOT NULL,
	CDMARCADOR		VARCHAR(20)	NOT NULL,
	CDCLIENTE		VARCHAR(20) NOT NULL,
	CDUSUARIO       VARCHAR(20) NOT NULL,
    NUCARIMBO       DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	DTALTERACAO		DATETIME		NULL,
	HRALTERACAO		VARCHAR(8)		NULL,
	CONSTRAINT PK_TBLVPMARCADORPRODUTO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDMARCADOR, CDCLIENTE, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Atividade: LAV-26170 GRUPO BIG - Gera novidade resposta solicitação autorização no app
Autor: João Henrique
Data: 03/07/2020
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPRELNOVSOLAUTORIZACAO (
    CDEMPRESA            VARCHAR(20)   NOT NULL,
    CDREPRESENTANTE      VARCHAR(20)   NOT NULL,
    CDSOLAUTORIZACAO     VARCHAR(20)   NOT NULL,
    CDTIPOSOLAUTORIZACAO DECIMAL(9,0)  NOT NULL,
    FLORIGEMPEDIDO       CHAR(1)       NOT NULL,
    CDTIPONOVIDADE       VARCHAR(20)   NOT NULL,
    NUPEDIDO             VARCHAR(30)   NOT NULL,
    CDCLIENTE            VARCHAR(20)   NOT NULL,
    CDPRODUTO            VARCHAR(20)   NOT NULL,
    FLTIPOITEMPEDIDO     CHAR(1)       NOT NULL,
    NUSEQPRODUTO         DECIMAL(9,0)  NOT NULL,
    FLAUTORIZADO         CHAR(1)       NULL,
    DTEMISSAORELATORIO   DATETIME      NULL,
    NUCARIMBO            DECIMAL(9,0)  NULL,
    FLTIPOALTERACAO      CHAR(1)       NULL,
    CDUSUARIO            VARCHAR(8)    NOT NULL,
    DTALTERACAO          DATETIME      NULL,
    HRALTERACAO          VARCHAR(8)    NULL,
    CONSTRAINT PK_TBLVPRELNOVSOLAUTORIZACAO PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDSOLAUTORIZACAO, CDTIPOSOLAUTORIZACAO, FLORIGEMPEDIDO, CDTIPONOVIDADE, NUPEDIDO, CDCLIENTE, CDPRODUTO, FLTIPOITEMPEDIDO, NUSEQPRODUTO, CDUSUARIO)
)
GO

/*------------------------------------------------------------------
LAV-26699 - Iconic - Resposta de questionário com múltipla seleção
Autor: Danilo M
Data: 25/08/2020
--------------------------------------------------------------------*/

--SQLSERVER
ALTER TABLE TBLVPPESQUISARESPAPPHISTCLI ALTER COLUMN CDRESPOSTA VARCHAR(20) NOT NULL;
GO
--/SQLSERVER

ALTER TABLE TBLVPPESQUISARESPAPPHISTCLI DROP CONSTRAINT PK_TBLVPPESQUISARESPAPPHISTCLI;
GO

--ORACLE
DROP INDEX PK_TBLVPPESQUISARESPAPPHISTCLI;
/
--/ORACLE

ALTER TABLE TBLVPPESQUISARESPAPPHISTCLI ADD CONSTRAINT PK_TBLVPPESQUISARESPAPPHISTCLI PRIMARY KEY (CDEMPRESA, CDCLIENTE, CDQUESTIONARIO, CDPERGUNTA, CDRESPOSTA, CDUSUARIO);
GO

/*-------------------------------------------------------------------------
Descrição: Renascer Madeiras - Integração de Serviços com ERP Sênior
Autor: Renê C. Duarte
Data: 09/09/2020
------------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTO ADD FLSERVICO CHAR(1);
GO

--VERSAO 6.246

/*-------------------------------------------------------------------------
Autor: Gustavo Heidemann
Atividade: LAV-27839
Descrição: Nova Coluna
Data: 23/09/2020
------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD FLPEDIDOPERDIDO CHAR(1);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD FLPEDIDOPERDIDO CHAR(1);
GO

/*-------------------------------------------------------------------------
LAV-27117
Autor: Suelen Roecker
Descrição: Novas Colunas
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPSTATUSPEDIDOPDA ADD FLRELACIONAPEDIDOPDA CHAR(1) NULL;
GO

--VERSAO 6.247

/*-------------------------------------------------------------------------
Autor: Danilo M.
Atividade: LAV-27114
Descrição: Nova Coluna
------------------------------------------------------------------------*/
ALTER TABLE TBLVPTIPOPEDIDO ADD FLIGNORAENVIOERP CHAR(1);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-27310 - GRUPO BIG - Apresentar a Data e hora da solicitação de autorização na Web
           LAV-27324 - GRUPO BIG - Ajustar campo de hora na SolAutorizacao
Descricao: Atualização da coluna HRLIBSOLAUTORIZACAO e HRSOLAUTORIZACAO da entidade SOLAUTORIZACAO e correção das horas contidas nos registros
Autor: Raphael Santos
Data: 19/08/2020
-------------------------------------------------------------------------*/

--SQLSERVER
ALTER TABLE TBLVPSOLAUTORIZACAO ALTER COLUMN HRLIBSOLAUTORIZACAO VARCHAR(8);
GO

ALTER TABLE TBLVPSOLAUTORIZACAO ALTER COLUMN HRSOLAUTORIZACAO VARCHAR(8);
GO

UPDATE TBLVPSOLAUTORIZACAO SET HRLIBSOLAUTORIZACAO = CONCAT(HRLIBSOLAUTORIZACAO, ':00') WHERE LEN(HRLIBSOLAUTORIZACAO) = 5;
UPDATE TBLVPSOLAUTORIZACAO SET HRSOLAUTORIZACAO = CONCAT(HRSOLAUTORIZACAO, ':00') WHERE LEN(HRSOLAUTORIZACAO) = 5;
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPSOLAUTORIZACAO MODIFY HRLIBSOLAUTORIZACAO VARCHAR(8);
/

ALTER TABLE TBLVPSOLAUTORIZACAO MODIFY HRSOLAUTORIZACAO VARCHAR(8);
/

UPDATE TBLVPSOLAUTORIZACAO SET HRLIBSOLAUTORIZACAO = CONCAT(HRLIBSOLAUTORIZACAO, ':00') WHERE LENGTH(HRLIBSOLAUTORIZACAO) = 5;
UPDATE TBLVPSOLAUTORIZACAO SET HRSOLAUTORIZACAO = CONCAT(HRSOLAUTORIZACAO, ':00') WHERE LENGTH(HRSOLAUTORIZACAO) = 5;
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPSOLAUTORIZACAO ALTER HRLIBSOLAUTORIZACAO TYPE VARCHAR(8);

ALTER TABLE TBLVPSOLAUTORIZACAO ALTER HRSOLAUTORIZACAO TYPE VARCHAR(8);

UPDATE TBLVPSOLAUTORIZACAO SET HRLIBSOLAUTORIZACAO = CONCAT(HRLIBSOLAUTORIZACAO, ':00') WHERE LENGTH(HRLIBSOLAUTORIZACAO) = 5;
UPDATE TBLVPSOLAUTORIZACAO SET HRSOLAUTORIZACAO = CONCAT(HRSOLAUTORIZACAO, ':00') WHERE LENGTH(HRSOLAUTORIZACAO) = 5;
--/POSTGRES

--VERSAO 6.247-1

/*-------------------------------------------------------------------------
Atividade: LAV-27661 COLGATE - Considerar pedido atual para Desconto Progressivo
Autor: João Henrique
Data: 11/09/2020
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPSTATUSPEDIDOPDA ADD FLCONSIDERADESCPROG CHAR(1);
GO

--VERSAO 6.247-2

--SQLSERVER
ALTER TABLE TBLVPVALORPARAMETRO ALTER COLUMN VLPARAMETRO VARCHAR(4000);
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPVALORPARAMETRO MODIFY VLPARAMETRO VARCHAR(4000);
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPVALORPARAMETRO ALTER COLUMN VLPARAMETRO TYPE VARCHAR(4000);
--/POSTGRES

--VERSAO 6.248

--VERSAO 6.249

/*-------------------------------------------------------------------------
Atividade: LAV-26651 Grupo Pereira - Sistema critica desconto máximo sem dar desconto
Autor: Joao Henrique
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPTABELAPRECO ADD FLDMAXVLBASEITEMPED CHAR(1);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-27373
Autor: Fernando
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPNFEESTOQUE DROP CONSTRAINT PK_TBLVPNFEESTOQUE;
GO
ALTER TABLE TBLVPNFEESTOQUE ADD CONSTRAINT PK_TBLVPNFEESTOQUE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, NUSERIEREMESSA, NUNOTAREMESSA, CDUSUARIO);
GO

ALTER TABLE TBLVPITEMNFEESTOQUE DROP CONSTRAINT PK_TBLVPITEMNFEESTOQUE;
GO
ALTER TABLE TBLVPITEMNFEESTOQUE ADD CONSTRAINT PK_TBLVPITEMNFEESTOQUE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, NUSERIEREMESSA, NUNOTAREMESSA, CDPRODUTO, CDUSUARIO);
GO

/*------------------------------------------------------------------------
Atividade: LAV-28214
Descrição: Karsten - Melhorias na tela de listagem de itens do pedido (completa)
Autor: Gustavo Heidemann
Data: 09/11/2020
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPRODUTO ADD DSDIMENSOES VARCHAR(100);
GO

/*------------------------------------------------------------------------
Atividade: LAV-26295
Autor: Ronan Cardoso
Data: 26/10/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPTELA ADD FLEXPORTAPDF CHAR(1);
GO

--VERSAO 6.250

/*-------------------------------------------------------------------------
Autor: Daniel Barbosa
Atividade: LAV-27789
Descrição: Nova Coluna
Data: 28/10/2020
------------------------------------------------------------------------*/
ALTER TABLE TBLVPMARCADOR ADD FLFILTROSELECIONADO CHAR(1);
GO

/*-------------------------------------------------------------------------
LAV-25056
Autor: Daniel Barbosa
Descrição: Alteração parâmetro
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPCONTATO ADD FLCONTATONOVOCLIENTE CHAR(1);
GO

ALTER TABLE TBLVPCONTATOERP ADD FLCONTATONOVOCLIENTE CHAR(1);
GO

/*-------------------------------------------------------------------------
LAV-28101 - GELO MINERALE - Possibilidade de relacionamento do vendedor ao veiculo
Data: 09/11/2020
Autor: João Henrique
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPFECHAMENTODIARIO ADD DSPLACAVEICULO VARCHAR(8);
GO
ALTER TABLE TBLVPFECHAMENTODIARIO ADD KMINICIALVEICULO DECIMAL(16,7);
GO
ALTER TABLE TBLVPFECHAMENTODIARIO ADD KMFINALVEICULO DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
Autor: João Henrique
Atividade: LAV-28467
Data: 12/11/2020
------------------------------------------------------------------------*/
CREATE TABLE TBLVPFECHAMENTODIARIOEST (
	CDEMPRESA		VARCHAR(20)		NOT NULL,
	CDREPRESENTANTE	VARCHAR(20)		NOT NULL,
	DTMOVIMENTACAO	DATETIME		NOT NULL,
	CDPRODUTO		VARCHAR(20)		NOT NULL,
	QTREMESSA		DECIMAL(16,7)	NULL,
	QTRETORNO		DECIMAL(16,7)	NULL,
	QTVENDIDO		DECIMAL(16,7)	NULL,
	VLSALDO         DECIMAL(16,7)   NULL,
	CDUSUARIO		VARCHAR(8)		NOT NULL,
	NUCARIMBO		DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	DTALTERACAO		DATETIME		NULL,
	HRALTERACAO		VARCHAR(8)		NULL,
	CONSTRAINT PK_TBLVPFECHAMENTODIARIOEST PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, DTMOVIMENTACAO, CDPRODUTO, CDUSUARIO)
)
GO

/*------------------------------------------------------------------
Atividade: LAV-28178
Autor: Danilo
Data: 24/11/2020
Descrição: Nova Coluna
--------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD VLFINALPEDIDODESCTRIBFRETE DECIMAL(16,7) NULL;
GO

ALTER TABLE TBLVPPEDIDOERP ADD VLFINALPEDIDODESCTRIBFRETE DECIMAL(16,7) NULL;
GO

/*------------------------------------------------------------------
Atividade: LAV-28397
Autor: Renan
Data: 19/10/2020
Descrição: Novas Colunas
--------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD FLAUTORIZADO CHAR(1) NULL;
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD FLAUTORIZADO CHAR(1) NULL;
GO

/*------------------------------------------------------------------
Atividade: LAV-28565 GELO MINERALE - Novo layout do pedido impresso v3
Autor: João Henrique
Data: 17/11/2020
--------------------------------------------------------------------*/

CREATE TABLE TBLVPEMPRESAFILIALIMP (
	CDEMPRESA		    VARCHAR(20)		NOT NULL,
	CDREPRESENTANTE	    VARCHAR(20)		NOT NULL,
	CDFILIALIMP	        VARCHAR(20)		NOT NULL,
    DSRAZAOSOCIALFILIAL	VARCHAR(100)	NULL,
    NUTELEFONE	        VARCHAR(20)	    NULL,
    NUCELULAR	        VARCHAR(20)	    NULL,
	CDUSUARIO		    VARCHAR(8)		NOT NULL,
	NUCARIMBO		    DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO	    CHAR(1)			NULL,
	DTALTERACAO		    DATETIME		NULL,
	HRALTERACAO		    VARCHAR(8)		NULL,
	CONSTRAINT PK_TBLVPEMPRESAFILIALIMP PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDFILIALIMP, CDUSUARIO)
)
GO

/*------------------------------------------------------------------
Atividade: LAV-28601
Autor: Suelen Roecker
Data: 18/11/2020
Descrição: Novas Colunas
--------------------------------------------------------------------*/
ALTER TABLE TBLVPRESUMODIA ADD VLTOTALPESO DECIMAL(16,7);
GO

--VERSAO 6.250-1

--VERSAO 6.250-2
/*------------------------------------------------------------------
Atividade: LAV-28805
Autor: Gabriel
Data: 08/12/2020
Descrição: Novas Colunas
--------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD QTENCOMENDA DECIMAL(16,7);
ALTER TABLE TBLVPPEDIDO ADD VLTOTALENCOMENDA DECIMAL(16,7);

ALTER TABLE TBLVPPEDIDOERP ADD QTENCOMENDA DECIMAL(16,7);
ALTER TABLE TBLVPPEDIDOERP ADD VLTOTALENCOMENDA DECIMAL(16,7);

ALTER TABLE TBLVPITEMPEDIDO ADD QTENCOMENDA DECIMAL(16,7);
ALTER TABLE TBLVPITEMPEDIDO ADD VLTOTALENCOMENDA DECIMAL(16,7);

ALTER TABLE TBLVPITEMPEDIDOERP ADD QTENCOMENDA DECIMAL(16,7);
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLTOTALENCOMENDA DECIMAL(16,7);

--VERSAO 6.251

/*-------------------------------------------------------------------------
Autor: Gustavo Heidemann
Atividade: LAV-26890
Data: 09/12/2020
------------------------------------------------------------------------*/
 
/*------------------------------------------------------------------------
Descrição: Novas colunas
------------------------------------------------------------------------*/
 
ALTER TABLE TBLVPPEDIDO ADD FLGERANFCE CHAR(1);
GO

ALTER TABLE TBLVPPEDIDO ADD FLNFCEIMPRESSA CHAR(1);
GO

ALTER TABLE TBLVPPEDIDOERP ADD FLGERANFCE CHAR(1);
GO

ALTER TABLE TBLVPPEDIDOERP ADD FLNFCEIMPRESSA CHAR(1);
GO

ALTER TABLE TBLVPTIPOPAGAMENTO ADD VLINDICEPAGAMENTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPPAGAMENTOPEDIDO ADD VLPAGAMENTOBRUTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPPAGAMENTOPEDIDO ADD VLINDICEPAGAMENTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPPAGAMENTOPEDIDOERP ADD VLPAGAMENTOBRUTO DECIMAL(16,7);
GO

ALTER TABLE TBLVPPAGAMENTOPEDIDOERP ADD VLINDICEPAGAMENTO DECIMAL(16,7);
GO
 
/*------------------------------------------------------------------------
Descrição: Novas tabelas
------------------------------------------------------------------------*/
CREATE TABLE TBLVPNFCE (
   CDEMPRESA				VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      	VARCHAR(20)          NOT NULL,
   NUPEDIDO             	VARCHAR(30)          NOT NULL,
   FLORIGEMPEDIDO       	CHAR(1)              NOT NULL,
   QTTOTALITEM				DECIMAL(16,7)        NULL,  
   VLTOTALNFCE 				DECIMAL(16,7)        NULL,
   VLTOTALDESCONTO			DECIMAL(16,7)        NULL,
   VLTOTALLIQUIDONFCE		DECIMAL(16,7)        NULL,
   DSFORMAPAGAMENTO			VARCHAR(50)			 NULL,
   VLTOTALPAGO				DECIMAL(16,7)		 NULL,
   VLTROCO					DECIMAL(16,7)		 NULL,
   NUCHAVEACESSO			VARCHAR(50)			 NULL,
   NUNFCE					VARCHAR(20)			 NULL,
   NUSERIE					VARCHAR(5)			 NULL,
   DTEMISSAO				DATETIME             NULL,
   HREMISSAO				VARCHAR(8)           NULL,
   NUPROTOCOLOAUTORIZACAO	VARCHAR(20)          NULL,	
   DTAUTORIZACAO			DATETIME             NULL,
   HRAUTORIZACAO			VARCHAR(8)           NULL,
   VLTOTALTRIBUTOS			DECIMAL(16,7)        NULL,
   VLPCTTRIBUTOSFEDERAIS	DECIMAL(16,7)        NULL,
   VLPCTTRIBUTOSESTADUAIS	DECIMAL(16,7)        NULL,
   VLPCTTRIBUTOSMUNICIPAIS	DECIMAL(16,7)        NULL,
   CDTIPOEMISSAO			CHAR(1)				 NULL,
   NUVERSAOQRCODE			VARCHAR(3)			 NULL,
   NUAMBIENTENFCE			CHAR(1)				 NULL,
   DSDIGESTVALUENFCE		VARCHAR(60)			 NULL,
   CDIDENTIFICACAOCSC		VARCHAR(20)			 NULL,
   DSURLQRCODE				VARCHAR(1000)		 NULL,
   CDMENSAGEMRETORNO    	VARCHAR(20)          NULL,
   DSMENSAGEMRETORNO    	VARCHAR(200)         NULL,
   FLTIPOALTERACAO	CHAR(1)				NULL,
	NUCARIMBO		DECIMAL(9,0)		NULL,
    DTALTERACAO     DATETIME            NULL,
    HRALTERACAO     VARCHAR(8)          NULL,
	CDUSUARIO		VARCHAR(8)		NOT NULL,
   CONSTRAINT PK_TBLVPNFCE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, FLORIGEMPEDIDO, NUPEDIDO, CDUSUARIO)
)
GO
CREATE TABLE TBLVPITEMNFCE (
   CDEMPRESA				VARCHAR(20)          NOT NULL,
   CDREPRESENTANTE      	VARCHAR(20)          NOT NULL,
   NUPEDIDO             	VARCHAR(30)          NOT NULL,
   FLORIGEMPEDIDO       	CHAR(1)              NOT NULL,
   CDPRODUTO 				VARCHAR(20)          NOT NULL,
   NUSEQPRODUTO          	DECIMAL(9,0)         NOT NULL,
   QTITEMFISICO				DECIMAL(16,7)        NULL,
   CDUNIDADE				VARCHAR(20)			 NULL,
   VLUNITARIO				DECIMAL(16,7)		 NULL,
   VLTOTALITEM				DECIMAL(16,7)		 NULL,
   FLTIPOALTERACAO	CHAR(1)				NULL,
	NUCARIMBO		DECIMAL(9,0)		NULL,
	DTALTERACAO     DATETIME            NULL,
	HRALTERACAO     VARCHAR(8)          NULL,
	CDUSUARIO		VARCHAR(8)		NOT NULL,
   CONSTRAINT PK_TBLVPITEMNFCE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, FLORIGEMPEDIDO, NUPEDIDO, CDPRODUTO, NUSEQPRODUTO, CDUSUARIO)
)
GO
ALTER TABLE TBLVPSERIENFE ADD CDTIPONOTA VARCHAR(1) default '1' NOT NULL;
GO
ALTER TABLE TBLVPEMPRESA ADD DSURLCONSULTA VARCHAR(100);
GO
ALTER TABLE TBLVPEMPRESA ADD NUCSC VARCHAR(50);
GO
ALTER TABLE TBLVPSERIENFE DROP CONSTRAINT PK_TBLVPSERIENFE;
GO
DROP INDEX PK_TBLVPSERIENFE;
GO
ALTER TABLE TBLVPSERIENFE ADD CONSTRAINT PK_TBLVPSERIENFE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, NUSERIENFE, CDTIPONOTA, CDUSUARIO);
GO
ALTER TABLE TBLVPTIPOPEDIDO ADD FLGERANFCE CHAR(1);
GO
ALTER TABLE TBLVPEMPRESA ADD CDESTADO VARCHAR(50);
GO
ALTER TABLE TBLVPEMPRESA DROP COLUMN DSTIMEZONE;
GO

/*------------------------------------------------------------------
Atividade: LAV-28805
Autor: Gabriel
Data: 08/12/2020
Descrição: Novas Colunas
--------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD QTENCOMENDA DECIMAL(16,7);
GO
ALTER TABLE TBLVPPEDIDO ADD VLTOTALENCOMENDA DECIMAL(16,7);
GO

ALTER TABLE TBLVPPEDIDOERP ADD QTENCOMENDA DECIMAL(16,7);
GO
ALTER TABLE TBLVPPEDIDOERP ADD VLTOTALENCOMENDA DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD QTENCOMENDA DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDO ADD VLTOTALENCOMENDA DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD QTENCOMENDA DECIMAL(16,7);
GO
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLTOTALENCOMENDA DECIMAL(16,7);
GO

/*------------------------------------------------------------------------
Autor: Ronan Cardoso
Atividade: LAV-28977
Data: 14/12/2020
Descrição: Adição da coluna cdTabelaPreco na tabela MargemRentab
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPMARGEMRENTAB ADD CDTABELAPRECO VARCHAR(30);
GO

/*------------------------------------------------------------------------
Atividade: LAV-28512
Descrição: Criação de nova tabela
Autor: Suelen Roecker
Data: 13/11/2020
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPTIPOPEDPRODDESCACRES (
    CDEMPRESA               VARCHAR(20)         NOT NULL,
    CDREPRESENTANTE         VARCHAR(20)         NOT NULL,
    CDTIPOPEDIDO            VARCHAR(20)         NOT NULL,
    CDPRODUTO               VARCHAR(20)         NOT NULL,
    VLPCTMAXDESCONTO        DECIMAL(16,7)       NULL,
    VLPCTMAXACRESCIMO       DECIMAL(16,7)       NULL,
    VLBASE                  DECIMAL(16,7)       NULL,
    NUCARIMBO				DECIMAL(9,0)		NULL,
    CDUSUARIO				VARCHAR(8)			NOT NULL,
    FLTIPOALTERACAO			CHAR(1)				NULL,
    DTALTERACAO				DATETIME			NULL,
    HRALTERACAO				VARCHAR(8)			NULL,
	CONSTRAINT PK_TBLVPTIPOPEDPRODDESCACRES	PRIMARY KEY(CDEMPRESA, CDREPRESENTANTE, CDTIPOPEDIDO, CDPRODUTO, CDUSUARIO)
);
GO

/*-------------------------------------------------------------------------
LAV-28346
Autor: Suelen Roecker
Data: 11/12/2020
Descrição: Novas Colunas
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPEDIDO ADD VLRENTABILIDADESUG DECIMAL (16,7);
GO
ALTER TABLE TBLVPPEDIDOERP ADD VLRENTABILIDADESUG DECIMAL (16,7);
GO


/*------------------------------------------------------------------
Atividade: LAV-28471 GELO MINERALE - Permitir lançamento de valores no fechamento diário
Autor: João Henrique Lopes
Data: 30/11/2020
--------------------------------------------------------------------*/

CREATE TABLE TBLVPFECHAMENTODIARIOLAN (
	CDEMPRESA		    VARCHAR(20)		NOT NULL,
    CDREPRESENTANTE	    VARCHAR(20)		NOT NULL,
    DTFECHAMENTODIARIO 	DATETIME		NOT NULL,
    CDTIPOLANCAMENTO 	VARCHAR(20)		NOT NULL,
    VLTOTALLANCAMENTO	DECIMAL(16,7)	NULL,
	CDUSUARIO		    VARCHAR(8)		NOT NULL,
	NUCARIMBO		    DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO	    CHAR(1)			NULL,
	DTALTERACAO		    DATETIME		NULL,
	HRALTERACAO		    VARCHAR(8)		NULL,
	CONSTRAINT PK_TBLVPFECHAMENTODIARIOLAN PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, DTFECHAMENTODIARIO, CDTIPOLANCAMENTO, CDUSUARIO)
)
GO

CREATE TABLE TBLVPTIPOLANCAMENTO (
	CDEMPRESA		    VARCHAR(20)		NOT NULL,
    CDREPRESENTANTE	    VARCHAR(20)		NOT NULL,
    CDTIPOLANCAMENTO 	VARCHAR(20)		NOT NULL,
    DSTIPOLANCAMENTO	VARCHAR(100)	NULL,
	CDUSUARIO		    VARCHAR(8)		NOT NULL,
	NUCARIMBO		    DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO	    CHAR(1)			NULL,
	DTALTERACAO		    DATETIME		NULL,
	HRALTERACAO		    VARCHAR(8)		NULL,
	CONSTRAINT PK_TBLVPTIPOLANCAMENTO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDTIPOLANCAMENTO, CDUSUARIO)
)
GO

--VERSAO 6.252

/*------------------------------------------------------------------
LAV-25081 - Adicionar novas colunas para validacao do ignora desconto
Autor: Daniel Barbosa
--------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMPEDIDO ADD FLIGNORADESCQTDPRO CHAR(1);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD FLIGNORADESCQTDPRO CHAR(1);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-27743 - ICONIC - Calcular Pontuação na importação dos pedidos retornados
Descrição: Criação da coluna nuConversaoUnidadeNegociado nas tabelas de itemPedido e itemPedidoErp
Autor: Raphael Santos
Data: 26/08/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD NUCONVERSAOUNIDADENEGOCIADO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD NUCONVERSAOUNIDADENEGOCIADO DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
Atividade: LAV-27743 - ICONIC - Calcular Pontuação na importação dos pedidos retornados
Descrição: Remoção da coluna QTDIASFAIXAPONTUACAO nas tabelas de pedido e pedidoErp
Autor: Raphael Santos
Data: 13/10/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO DROP COLUMN QTDIASFAIXAPONTUACAO;
GO

ALTER TABLE TBLVPPEDIDOERP DROP COLUMN QTDIASFAIXAPONTUACAO;
GO

/*-------------------------------------------------------------------------
Atividade: LAV-27743 - ICONIC - Calcular Pontuação na importação dos pedidos retornados
Descrição: Criação das colunas cdPontuacaoConfig, qtDiasFaixaPontuacao nas tabelas de itemPedido e itemPedidoErp
Autor: Raphael Santos
Data: 13/10/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD CDPONTUACAOCONFIG VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD CDPONTUACAOCONFIG VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD QTDIASFAIXAPONTUACAO DECIMAL(9,0);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD QTDIASFAIXAPONTUACAO DECIMAL(9,0);
GO


/*-------------------------------------------------------------------------
Atividade: LAV-27388 - ICONIC - Cadastro e informação de campanhas
Descrição: Exclusão da coluna FLDIVULGAINFO, e criação da coluna NUDIVULGAINFO
Autor: Raphael Santos
Data: 17/11/2020
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCLIENTE DROP COLUMN FLDIVULGAINFO;
ALTER TABLE TBLVPCLIENTE ADD NUDIVULGAINFO DECIMAL(9,0);

/*-------------------------------------------------------------------------
Atividade: LAV-27388 - ICONIC - Cadastro e informação de campanhas
Descrição: ALTERAÇÃO DA COLUNA dsTipoDivulgaInfoTxt NA TABELA DIVULGAINFO
Autor: Raphael Santos
Data: 17/11/2020
------------------------------------------------------------------------*/
--SQLSERVER
ALTER TABLE TBLVPDIVULGAINFO ALTER COLUMN DSTIPODIVULGAINFOTXT VARCHAR(400);
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPDIVULGAINFO MODIFY DSTIPODIVULGAINFOTXT VARCHAR(400);
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPDIVULGAINFO ALTER COLUMN DSTIPODIVULGAINFOTXT TYPE VARCHAR(400);
--/POSTGRES

/*-------------------------------------------------------------------------
Autor: Danilo M.
Atividade: LAV-26702
Descrição: Novas Colunas
Data: 28/10/2020
------------------------------------------------------------------------*/
ALTER TABLE TBLVPPERGUNTARESPOSTA ADD DSEXPRESSAO VARCHAR(100);
GO
ALTER TABLE TBLVPPERGUNTARESPOSTA ADD CDPERGUNTASSECUNDARIAS VARCHAR(100);
GO

ALTER TABLE TBLVPPERGUNTA ADD FLSECUNDARIA VARCHAR(1);
GO

--VERSAO 6.253

/*-------------------------------------------------------------------------
LAV-28879
Autor: Suelen Roecker
Descrição: Novas Tabelas
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPHISTTROCADEVOLUCAOPROD (
 CDEMPRESA                VARCHAR(20)          NOT NULL,
 CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
 CDPRODUTO                VARCHAR(20)          NOT NULL,
 CDCLIENTE                VARCHAR(20)          NOT NULL,
 DSPRODUTO                VARCHAR(100)         NULL,
 PERCTROCADEVSEISMESES    DECIMAL(16,7)        NULL,
 PERCTROCADEVTRESMESES    DECIMAL(16,7)        NULL,
 PERCTROCADEVTRINTADIAS   DECIMAL(16,7)        NULL,
 QTVENDASEISMESES         VARCHAR(20)          NULL,
 QTVENDATRESMESES         VARCHAR(20)          NULL,
 QTVENDATRINTADIAS        VARCHAR(20)          NULL,
 DIASSEMCOMPRAS           DECIMAL(9)           NULL,
 CDUSUARIO		          VARCHAR(8)		   NOT NULL,
 NUCARIMBO		          DECIMAL(9,0)	       NULL,
 FLTIPOALTERACAO	      CHAR(1)			   NULL,
 DTALTERACAO		      DATETIME		       NULL,
 HRALTERACAO		      VARCHAR(8)		   NULL,
 CONSTRAINT PK_TBLVPHISTTROCADEVOLUCAOPROD PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDCLIENTE,CDUSUARIO)
)
GO

CREATE TABLE TBLVPHISTTROCADEVOLUCAOCLI(
 CDEMPRESA                VARCHAR(20)          NOT NULL,
 CDREPRESENTANTE          VARCHAR(20)          NOT NULL,
 CDPRODUTO                VARCHAR(20)          NOT NULL,
 CDCLIENTE                VARCHAR(20)          NOT NULL,
 DSPRODUTO                VARCHAR(100)         NULL,
 PERCTROCADEVSEISMESES    DECIMAL(16,7)        NULL,
 PERCTROCADEVTRESMESES    DECIMAL(16,7)        NULL,
 PERCTROCADEVTRINTADIAS   DECIMAL(16,7)        NULL,
 DIASSEMCOMPRAS           DECIMAL(9)           NULL,
 CDUSUARIO		          VARCHAR(8)		   NOT NULL,
 NUCARIMBO		          DECIMAL(9,0)	       NULL,
 FLTIPOALTERACAO	      CHAR(1)			   NULL,
 DTALTERACAO		      DATETIME		       NULL,
 HRALTERACAO		      VARCHAR(8)		   NULL,
 CONSTRAINT PK_TBLVPHISTTROCADEVOLUCAOCLI PRIMARY KEY NONCLUSTERED (CDEMPRESA, CDREPRESENTANTE, CDPRODUTO, CDCLIENTE,CDUSUARIO)
)
GO

--VERSAO 6.254

/*-------------------------------------------------------------------------
Autor: Daniel Barbosa
Atividade: LAV-27830
Descrição: Novas Colunas
Data: 22/01/2021
----------------------------------------------------------------------*/

ALTER TABLE TBLVPPERGUNTA ADD FLRESPOSTAAUTOMATICA VARCHAR(1);
GO
ALTER TABLE TBLVPPERGUNTA ADD NMENTIDADE VARCHAR(30);
GO
ALTER TABLE TBLVPPERGUNTA ADD NMCAMPO VARCHAR(30);
GO
ALTER TABLE TBLVPPERGUNTA ADD FLSOMENTELEITURA VARCHAR(1);
GO

UPDATE TBLVPPERGUNTA SET FLRESPOSTAAUTOMATICA = '1';

/*-------------------------------------------------------------------------
LAV-28650
Autor: Matheus Schiavon
Descrição: Adição coluna
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPSTATUSNFE  ADD FLBLOQUEIAIMPRESSAO CHAR(1);
GO

/*-------------------------------------------------------------------------
LAV-28999
Autor: Matheus Schiavon
Descrição: Adição coluna
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCONDICAOPAGAMENTO ADD QTMAXVALORPARCELA DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
LAV-28996
Autor: Ronan Cardoso
Descrição: Adição de coluna na tabela Pedido
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD QTDIASVCTOPARCELAS VARCHAR(50);
GO
ALTER TABLE TBLVPPEDIDOERP ADD QTDIASVCTOPARCELAS VARCHAR(50);
GO

/*-------------------------------------------------------------------------
Descrição: Nova tabela e colunas
Autor: Renan
Data: 09/02/2021
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTO ADD CDGRUPOPRODUTO5 VARCHAR(20);
GO

ALTER TABLE TBLVPINDICEGRUPOPROD ADD CDGRUPOPRODUTO4 VARCHAR(20) DEFAULT '0' NOT NULL;
GO

ALTER TABLE TBLVPINDICEGRUPOPROD ADD CDGRUPOPRODUTO5 VARCHAR(20) DEFAULT '0' NOT NULL;
GO

CREATE TABLE TBLVPGRUPOPRODUTO5 (
    CDGRUPOPRODUTO1     VARCHAR(20)     NOT NULL,
    CDGRUPOPRODUTO2     VARCHAR(20)     NOT NULL,
    CDGRUPOPRODUTO3     VARCHAR(20)     NOT NULL,
    CDGRUPOPRODUTO4     VARCHAR(20)     NOT NULL,
    CDGRUPOPRODUTO5     VARCHAR(20)     NOT NULL,
    DSGRUPOPRODUTO5    	VARCHAR(100)        NULL,
    CDUSUARIO           VARCHAR(8)      NOT NULL,
    NUCARIMBO           DECIMAL(9,0)        NULL,
    FLTIPOALTERACAO     CHAR(1)             NULL,
    DTALTERACAO         DATETIME            NULL,
    HRALTERACAO         VARCHAR(8)          NULL,
    CONSTRAINT PK_TBLVPGRUPOPRODUTO5 PRIMARY KEY (CDGRUPOPRODUTO1, CDGRUPOPRODUTO2, CDGRUPOPRODUTO3, CDGRUPOPRODUTO4, CDGRUPOPRODUTO5, CDUSUARIO)
)
GO

ALTER TABLE TBLVPINDICEGRUPOPROD DROP CONSTRAINT PK_TBLVPINDICEGRUPOPROD;
GO

--ORACLE
DROP INDEX PK_TBLVPINDICEGRUPOPROD;
GO
--/ORACLE

ALTER TABLE TBLVPINDICEGRUPOPROD ADD CONSTRAINT PK_TBLVPINDICEGRUPOPROD PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDGRUPOPRODUTO1, CDGRUPOPRODUTO2, CDGRUPOPRODUTO3, CDGRUPOPRODUTO4, CDGRUPOPRODUTO5, CDTABELAPRECO, CDCONDICAOPAGAMENTO, CDUSUARIO);
GO

--VERSAO 6.254-1

/*-------------------------------------------------------------------------
Autor: Danilo M.
Atividade: LAV-28577
Data: 22/02/2021
------------------------------------------------------------------------*/

ALTER TABLE TBLVPPEDIDO ADD DSMOTIVOCANCCONDPAGTO  VARCHAR(500);
GO
ALTER TABLE TBLVPPEDIDO ADD CDUSUARIOCANCCONDPAGTO  VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDO ADD CDUSUARIOLIBERACAOCONDPAGTO  VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDO ADD FLPENDENTECONDPAGTO VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDOERP ADD FLPENDENTECONDPAGTO VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDOERP ADD DSMOTIVOCANCCONDPAGTO  VARCHAR(500);
GO
ALTER TABLE TBLVPPEDIDOERP ADD CDUSUARIOCANCCONDPAGTO  VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDOERP ADD CDUSUARIOLIBERACAOCONDPAGTO  VARCHAR(20);
GO

--VERSAO 6.254-2

--VERSAO 6.254-3

--VERSAO 6.255

/*-------------------------------------------------------------------------
Autor: Danilo M.
Atividade: LAV-28577
Data: 22/02/2021
------------------------------------------------------------------------*/

ALTER TABLE TBLVPPEDIDO ADD DSMOTIVOCANCCONDPAGTO  VARCHAR(500);
GO
ALTER TABLE TBLVPPEDIDO ADD CDUSUARIOCANCCONDPAGTO  VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDO ADD CDUSUARIOLIBERACAOCONDPAGTO  VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDO ADD FLPENDENTECONDPAGTO VARCHAR(20);
GO

ALTER TABLE TBLVPPEDIDOERP ADD FLPENDENTECONDPAGTO VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDOERP ADD DSMOTIVOCANCCONDPAGTO  VARCHAR(500);
GO
ALTER TABLE TBLVPPEDIDOERP ADD CDUSUARIOCANCCONDPAGTO  VARCHAR(20);
GO
ALTER TABLE TBLVPPEDIDOERP ADD CDUSUARIOLIBERACAOCONDPAGTO  VARCHAR(20);
GO

/*-------------------------------------------------------------------------
Autor: Renan
Atividade: LAV-27315
Data: 12/02/2021
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD FLAGRUPADORSIMILARIDADE CHAR(1);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD CDAGRUPADORSIMILARIDADE VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDO ADD CDPRODUTOAGRSIMILARIDADE VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD FLAGRUPADORSIMILARIDADE CHAR(1);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD CDAGRUPADORSIMILARIDADE VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD CDPRODUTOAGRSIMILARIDADE VARCHAR(20);
GO

ALTER TABLE TBLVPSOLAUTORIZACAO ADD FLAGRUPADORSIMILARIDADE CHAR(1);
GO

CREATE TABLE TBLVPITEMPEDIDOAGRSIMILAR (
    CDEMPRESA               VARCHAR(20)     NOT NULL,
    CDREPRESENTANTE         VARCHAR(20)     NOT NULL, 
    FLORIGEMPEDIDO          VARCHAR(20)     NOT NULL,
    NUPEDIDO                VARCHAR(30)     NOT NULL,
    CDPRODUTO               VARCHAR(20)     NOT NULL,
    CDPRODUTOSIMILAR        VARCHAR(20)     NOT NULL,
    FLTIPOITEMPEDIDO        CHAR(1)         NOT NULL,
    NUSEQPRODUTO            DECIMAL(9,0)    NOT NULL,
    CDAGRUPADORSIMILARIDADE VARCHAR(20)         NULL,
    QTITEMFISICO            DECIMAL(16,7)       NULL,
    CDUSUARIO               VARCHAR(8)      NOT NULL,
    NUCARIMBO               DECIMAL(9,0)        NULL,
    FLTIPOALTERACAO         CHAR(1)             NULL,
    DTALTERACAO             DATETIME            NULL,
    HRALTERACAO             VARCHAR(8)          NULL,
    CONSTRAINT PK_TBLVPITEMPEDIDOAGRSIMILAR PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, FLORIGEMPEDIDO, NUPEDIDO, CDPRODUTO, CDPRODUTOSIMILAR, FLTIPOITEMPEDIDO, NUSEQPRODUTO, CDUSUARIO) 
)
GO


/*------------------------------------------------------------------------
Atividade: LAV-29414 - ICONIC - Pontuação Faixa dias por valor de pedido
Descrição: Adicionando coluna VLTOTALPEDIDO na tabela PONTUACAOFAXADIAS como chave primária.
Autor: Raphael Santos
Data: 22/02/2021
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPONTUACAOFAIXADIAS ADD VLTOTALPEDIDO DECIMAL(16,7) DEFAULT 0 NOT NULL;
GO
ALTER TABLE TBLVPPONTUACAOFAIXADIAS DROP CONSTRAINT PK_TBLVPPONTUACAOFAIXADIAS;
GO

--ORACLE
DROP INDEX PK_TBLVPPONTUACAOFAIXADIAS;
GO
--/ORACLE

ALTER TABLE TBLVPPONTUACAOFAIXADIAS ADD CONSTRAINT PK_TBLVPPONTUACAOFAIXADIAS PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDPONTUACAOCONFIG, FLTIPOFATORCORRECAO, QTDIASMEDIOS, VLTOTALPEDIDO, CDUSUARIO);
GO

/*------------------------------------------------------------------------
Atividade: LAV-29414 - ICONIC - Pontuação Faixa dias por valor de pedido
Descrição: Adicionando coluna FLCALCULAPONTUACAO na tabela PEDIDO.
Autor: Raphael Santos
Data: 24/02/2021
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD FLCALCULAPONTUACAO CHAR(1);
GO

ALTER TABLE TBLVPPEDIDOERP ADD FLCALCULAPONTUACAO CHAR(1);
GO


/*-------------------------------------------------------------------------
Descrição: Nova tabela
Autor: Éber Mainardes
Data: 01/03/2021
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPFAIXACLIENTE (
    CDEMPRESA           VARCHAR(20) NOT NULL,
	CDREPRESENTANTE     VARCHAR(20) NOT NULL,
	CDCLIENTE           VARCHAR(20) NOT NULL,
	CDFAIXACLI          VARCHAR(20) NOT NULL,
    CDUSUARIO           VARCHAR(8)      NOT NULL,
    NUCARIMBO           DECIMAL(9,0)        NULL,
    FLTIPOALTERACAO     CHAR(1)             NULL,
    DTALTERACAO         DATETIME            NULL,
    HRALTERACAO         VARCHAR(8)          NULL,
    CONSTRAINT PK_TBLVPFAIXACLIENTE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, CDFAIXACLI)
)
GO

--VERSAO 6.256

/*-------------------------------------------------------------------------
LAV-26696
Autor: Suelen Roecker
Descrição:Novas Colunas
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPITEMPEDIDO ADD VLPCTFAIXADESCQTDPESO DECIMAL(16,7);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD VLPCTFAIXADESCQTDPESO DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
LAV-29314
Autor: Anderson Longará
Descrição: Nova Coluna
Data: 18/02/2021
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPRODUTO ADD FLIGNORAPESO CHAR(1) NULL;
GO

/*-------------------------------------------------------------------------
LAV-29441
Autor: Matheus Schiavon
Descrição: Adição coluna
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCLIENTE ADD DSDESCONTOBLOQUEADOLIST VARCHAR(4000);
GO

ALTER TABLE TBLVPCLIENTE ADD DSACRESCIMOBLOQUEADOLIST VARCHAR(4000);
GO

/*-------------------------------------------------------------------------
LAV-29774
Autor: Matheus Schiavon
Descrição: Adição coluna
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCONDICAOPAGAMENTO ADD QTMAXVALOR DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
LAV-29441
Autor: Suelen Roecker
Descrição: Alteração de coluna
-------------------------------------------------------------------------*/
--SQLSERVER
EXEC SP_RENAME 'TBLVPTELA.FLEXPORTAPDF', 'FLEXPORTAPDFSMARTPHONE', 'COLUMN';
GO
--/SQLSERVER

--ORACLE
ALTER TABLE TBLVPTELA RENAME COLUMN FLEXPORTAPDF TO FLEXPORTAPDFSMARTPHONE;
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPTELA RENAME COLUMN FLEXPORTAPDF TO FLEXPORTAPDFSMARTPHONE;
--/POSTGRES

--VERSAO 6.257

/*-------------------------------------------------------------------------
Descrição: Novas colunas e tabela
Autor: Renan
Data: 02/03/2021
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPDESCQUANTIDADE ADD FLAGRUPADORSIMILARIDADE CHAR(1);
GO

CREATE TABLE TBLVPDESCQTDEAGRSIMILAR (
    CDEMPRESA           VARCHAR(20) NOT NULL,
    CDREPRESENTANTE     VARCHAR(20) NOT NULL,
    CDTABELAPRECO       VARCHAR(30) NOT NULL,
    CDPRODUTO           VARCHAR(20) NOT NULL,
    CDPRODUTOSIMILAR    VARCHAR(20) NOT NULL,
    CDUSUARIO           VARCHAR(8)  NOT NULL,
    NUCARIMBO           DECIMAL(9,0)    NULL,
    FLTIPOALTERACAO     CHAR(1)         NULL,
    DTALTERACAO         DATETIME        NULL,
    HRALTERACAO         VARCHAR(8)      NULL,
    CONSTRAINT PK_TBLVPDESCQTDEAGRSIMILAR PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDTABELAPRECO, CDPRODUTO, CDPRODUTOSIMILAR, CDUSUARIO)
)
GO

/*-------------------------------------------------------------------------
Autor: Gustavo Heidemann
Atividade: LAV-27251
Descrição: Novas Tabelas
Data: 24/02/2021
------------------------------------------------------------------------*/

CREATE TABLE TBLVPSAFRA (
	CDSAFRA			VARCHAR(20)		NOT NULL,
	DSSAFRA			VARCHAR(100)	NULL,
	CDUSUARIO		VARCHAR(20)		NOT NULL,
	NUCARIMBO		DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	DTALTERACAO		DATETIME		NULL,
	HRALTERACAO		VARCHAR(8)		NULL,
	CONSTRAINT PK_TBLVPSAFRA PRIMARY KEY (CDSAFRA, CDUSUARIO) 
)
GO

CREATE TABLE TBLVPDAPMATRICULA (
	CDEMPRESA		VARCHAR(20)		NOT NULL,
	CDREPRESENTANTE	VARCHAR(20)		NOT NULL,
	CDCLIENTE		VARCHAR(20)		NOT NULL,
	CDSAFRA			VARCHAR(20)		NOT NULL,
	CDDAPMATRICULA	VARCHAR(100)	NOT NULL,
	DTEMISSAO		DATETIME		NULL,
	DTVALIDADE		DATETIME		NULL,
	DSCIDADE		VARCHAR(100)	NULL,
	DSLOCALIDADE	VARCHAR(100)	NULL,
	CDUF			VARCHAR(20)		NULL,
	NUMAXSEQLAUDO	DECIMAL(9,0)	NULL,
	CDUSUARIO		VARCHAR(20)		NOT NULL,
	NUCARIMBO		DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	DTALTERACAO		DATETIME		NULL,
	HRALTERACAO		VARCHAR(8)		NULL,
	CONSTRAINT PK_TBLVPDAPMATRICULA PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, CDSAFRA, CDDAPMATRICULA, CDUSUARIO) 
)
GO

CREATE TABLE TBLVPDAPCULTURA (
	CDEMPRESA		VARCHAR(20)		NOT NULL,
	CDREPRESENTANTE	VARCHAR(20)		NOT NULL,
	CDCLIENTE		VARCHAR(20)		NOT NULL,
	CDSAFRA			VARCHAR(20)		NOT NULL,
	CDDAPMATRICULA	VARCHAR(100)	NOT NULL,
	CDDAPCULTURA	VARCHAR(20)		NOT NULL,
	DSDAPCULTURA	VARCHAR(100)	NULL,
	QTAREA			DECIMAL(16,7)	NULL,
	CDUSUARIO		VARCHAR(20)		NOT NULL,
	NUCARIMBO		DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	DTALTERACAO		DATETIME		NULL,
	HRALTERACAO		VARCHAR(8)		NULL,
	CONSTRAINT PK_TBLVPDAPCULTURA PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, CDSAFRA, CDDAPMATRICULA, CDDAPCULTURA, CDUSUARIO) 
)
GO

CREATE TABLE TBLVPDAPLAUDO (
	CDEMPRESA			VARCHAR(20)		NOT NULL,
	CDREPRESENTANTE		VARCHAR(20)		NOT NULL,
	CDCLIENTE			VARCHAR(20)		NOT NULL,
	CDDAPMATRICULA		VARCHAR(100)	NOT NULL,
	CDSAFRA				VARCHAR(20)		NOT NULL,
	CDDAPCULTURA		VARCHAR(20)		NOT NULL,
	CDDAPLAUDO			VARCHAR(20)		NOT NULL,
	NUSEQLAUDO			DECIMAL(9,0)	NULL,
	FLSTATUSLAUDO		CHAR(1)			NULL,
	QTAREA				DECIMAL(16,7)	NULL,
	DTEMISSAO			DATETIME		NULL,
	DSASPECTOCULTURA	TEXT			NULL,
	DSRECOMENDACOES		TEXT			NULL,
	IMASSTECNICO		VARBINARY(MAX)	NULL,
	IMASSCLIENTE		VARBINARY(MAX)	NULL,
	CDLATITUDE			DECIMAL(23,20)	NULL,
	CDLONGITUDE 		DECIMAL(23,20)	NULL,
	DSOBSERVACAO 		VARCHAR(1000)	NULL,
	CDUSUARIO			VARCHAR(20)		NOT NULL,
	NUCARIMBO			DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO		CHAR(1)			NULL,
	DTALTERACAO			DATETIME		NULL,
	HRALTERACAO			VARCHAR(8)		NULL,
	CONSTRAINT PK_TBLVPDAPLAUDO PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, CDDAPMATRICULA, CDSAFRA, CDDAPCULTURA, CDDAPLAUDO, CDUSUARIO) 
)
GO

CREATE TABLE TBLVPDAPLAUDOATUA (
	CDEMPRESA				VARCHAR(20)		NOT NULL,
	CDREPRESENTANTE			VARCHAR(20)		NOT NULL,
	CDCLIENTE				VARCHAR(20)		NOT NULL,
	CDDAPMATRICULA			VARCHAR(100)	NOT NULL,
	CDSAFRA					VARCHAR(20)		NOT NULL,
	CDDAPCULTURA			VARCHAR(20)		NOT NULL,
	CDDAPLAUDO				VARCHAR(20)		NOT NULL,
	NUSEQLAUDO				DECIMAL(9,0)	NULL,
	FLSTATUSLAUDO			CHAR(1)			NULL,
	QTAREA					DECIMAL(16,7)	NULL,
	DTEMISSAO				DATETIME		NULL,
	DSASPECTOCULTURA		TEXT			NULL,
	DSRECOMENDACOES			TEXT			NULL,
	NMIMGASSTECNICO			VARCHAR(100)	NULL,
	NMIMGASSCLIENTE			VARCHAR(100)	NULL,
	CDLATITUDE				DECIMAL(23,20)	NULL,
	CDLONGITUDE 			DECIMAL(23,20)	NULL,
	DSOBSERVACAO 			VARCHAR(1000)	NULL,
	CDUSUARIO				VARCHAR(20)		NOT NULL,
	NUCARIMBO				DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO			CHAR(1)			NULL,
	DTALTERACAO				DATETIME		NULL,
	HRALTERACAO				VARCHAR(8)		NULL,
	CONSTRAINT PK_TBLVPDAPLAUDOATUA PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, CDDAPMATRICULA, CDSAFRA, CDDAPCULTURA, CDDAPLAUDO, CDUSUARIO) 
)
GO

/*------------------------------------------------------------------------
Atividade: LAV-29489 - GRUPO BIG - Escolher qual Similar Vender nas regras Combo e Kit
Descrição: Criação da tabela ITEMKITAGRSIMILAR
Autor: Raphael Santos
Data: 11/03/2021
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPITEMKITAGRSIMILAR (
	CDEMPRESA           VARCHAR(20)     NOT NULL,
	CDREPRESENTANTE     VARCHAR(20)     NOT NULL,
	CDKIT               VARCHAR(20)     NOT NULL,
	CDPRODUTO           VARCHAR(20)     NOT NULL,
	CDTABELAPRECO       VARCHAR(30)     NOT NULL,
	CDPRODUTOSIMILAR    VARCHAR(20)     NOT NULL,
    CDUSUARIO           VARCHAR(8)      NOT NULL,
    NUCARIMBO           DECIMAL(9,0)        NULL,
    FLTIPOALTERACAO     CHAR(1)             NULL,
    DTALTERACAO         DATETIME            NULL,
    HRALTERACAO         VARCHAR(8)          NULL,
    CONSTRAINT PK_TBLVPITEMKITAGRSIMILAR PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDKIT, CDPRODUTO, CDTABELAPRECO, CDPRODUTOSIMILAR, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------
Atividade: LAV-29489 - GRUPO BIG - Escolher qual Similar Vender nas regras Combo e Kit
Descrição: Criação da tabela ITEMCOMBOAGRSIMILAR
Autor: Raphael Santos
Data: 11/03/2021
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPITEMCOMBOAGRSIMILAR (
	CDEMPRESA           VARCHAR(20)     NOT NULL,
	CDREPRESENTANTE     VARCHAR(20)     NOT NULL,
	CDCOMBO             VARCHAR(20)     NOT NULL,
	CDPRODUTO           VARCHAR(20)     NOT NULL,
	CDTABELAPRECO       VARCHAR(30)     NOT NULL,
	CDPRODUTOSIMILAR    VARCHAR(20)     NOT NULL,
	FLTIPOITEMCOMBO     CHAR(1)             NULL,
    CDUSUARIO           VARCHAR(8)      NOT NULL,
    NUCARIMBO           DECIMAL(9,0)        NULL,
    FLTIPOALTERACAO     CHAR(1)             NULL,
    DTALTERACAO         DATETIME            NULL,
    HRALTERACAO         VARCHAR(8)          NULL,
    CONSTRAINT PK_TBLVPITEMCOMBOAGRSIMILAR PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCOMBO, CDPRODUTO, CDTABELAPRECO, CDPRODUTOSIMILAR, CDUSUARIO)
)
GO

--VERSAO 6.258

--VERSAO 6.300

--VERSAO 6.301


/*-------------------------------------------------------------------------
Autor: Daniel Barbosa
Descrição: Nova coluna
Data: 16/04/2021
------------------------------------------------------------------------*/

ALTER TABLE TBLVPHISTTROCADEVOLUCAOCLI ADD FLTOTALCLIENTE CHAR(1);
GO


/*-------------------------------------------------------------------------
Autor: Gustavo Heidemann
Atividade: LAV-30317
Descrição: Recriando as tabelas com a nova primary key
Data: 16/04/2021
------------------------------------------------------------------------*/

DROP TABLE TBLVPDAPMATRICULA;

CREATE TABLE TBLVPDAPMATRICULA (
	CDEMPRESA		VARCHAR(20)		NOT NULL,
	CDCLIENTE		VARCHAR(20)		NOT NULL,
	CDSAFRA			VARCHAR(20)		NOT NULL,
	CDDAPMATRICULA	VARCHAR(100)	NOT NULL,
	DTEMISSAO		DATETIME		NULL,
	DTVALIDADE		DATETIME		NULL,
	DSCIDADE		VARCHAR(100)	NULL,
	DSLOCALIDADE	VARCHAR(100)	NULL,
	CDUF			VARCHAR(20)		NULL,
	NUMAXSEQLAUDO	DECIMAL(9,0)	NULL,
	CDUSUARIO		VARCHAR(20)		NOT NULL,
	NUCARIMBO		DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	DTALTERACAO		DATETIME		NULL,
	HRALTERACAO		VARCHAR(8)		NULL,
	CONSTRAINT PK_TBLVPDAPMATRICULA PRIMARY KEY (CDEMPRESA, CDCLIENTE, CDSAFRA, CDDAPMATRICULA, CDUSUARIO) 
)
GO

DROP TABLE TBLVPDAPCULTURA;

CREATE TABLE TBLVPDAPCULTURA (
	CDEMPRESA		VARCHAR(20)		NOT NULL,
	CDCLIENTE		VARCHAR(20)		NOT NULL,
	CDSAFRA			VARCHAR(20)		NOT NULL,
	CDDAPMATRICULA	VARCHAR(100)	NOT NULL,
	CDDAPCULTURA	VARCHAR(20)		NOT NULL,
	DSDAPCULTURA	VARCHAR(100)	NULL,
	QTAREA			DECIMAL(16,7)	NULL,
	CDUSUARIO		VARCHAR(20)		NOT NULL,
	NUCARIMBO		DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO	CHAR(1)			NULL,
	DTALTERACAO		DATETIME		NULL,
	HRALTERACAO		VARCHAR(8)		NULL,
	CONSTRAINT PK_TBLVPDAPCULTURA PRIMARY KEY (CDEMPRESA, CDCLIENTE, CDSAFRA, CDDAPMATRICULA, CDDAPCULTURA, CDUSUARIO) 
)
GO

DROP TABLE TBLVPDAPLAUDO;

CREATE TABLE TBLVPDAPLAUDO (
	CDEMPRESA			VARCHAR(20)		NOT NULL,
	CDCLIENTE			VARCHAR(20)		NOT NULL,
	CDDAPMATRICULA		VARCHAR(100)	NOT NULL,
	CDSAFRA				VARCHAR(20)		NOT NULL,
	CDDAPCULTURA		VARCHAR(20)		NOT NULL,
	CDDAPLAUDO			VARCHAR(20)		NOT NULL,
	NUSEQLAUDO			DECIMAL(9,0)	NULL,
	FLSTATUSLAUDO		CHAR(1)			NULL,
	QTAREA				DECIMAL(16,7)	NULL,
	DTEMISSAO			DATETIME		NULL,
	DSASPECTOCULTURA	TEXT			NULL,
	DSRECOMENDACOES		TEXT			NULL,
	IMASSTECNICO		VARBINARY(MAX)	NULL,
	IMASSCLIENTE		VARBINARY(MAX)	NULL,
	CDLATITUDE			DECIMAL(23,20)	NULL,
	CDLONGITUDE 		DECIMAL(23,20)	NULL,
	DSOBSERVACAO 		VARCHAR(1000)	NULL,
	CDUSUARIO			VARCHAR(20)		NOT NULL,
	NUCARIMBO			DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO		CHAR(1)			NULL,
	DTALTERACAO			DATETIME		NULL,
	HRALTERACAO			VARCHAR(8)		NULL,
	CONSTRAINT PK_TBLVPDAPLAUDO PRIMARY KEY (CDEMPRESA, CDCLIENTE, CDDAPMATRICULA, CDSAFRA, CDDAPCULTURA, CDDAPLAUDO, CDUSUARIO) 
)
GO

DROP TABLE TBLVPDAPLAUDOATUA;

CREATE TABLE TBLVPDAPLAUDOATUA (
	CDEMPRESA				VARCHAR(20)		NOT NULL,
	CDCLIENTE				VARCHAR(20)		NOT NULL,
	CDDAPMATRICULA			VARCHAR(100)	NOT NULL,
	CDSAFRA					VARCHAR(20)		NOT NULL,
	CDDAPCULTURA			VARCHAR(20)		NOT NULL,
	CDDAPLAUDO				VARCHAR(20)		NOT NULL,
	NUSEQLAUDO				DECIMAL(9,0)	NULL,
	FLSTATUSLAUDO			CHAR(1)			NULL,
	QTAREA					DECIMAL(16,7)	NULL,
	DTEMISSAO				DATETIME		NULL,
	DSASPECTOCULTURA		TEXT			NULL,
	DSRECOMENDACOES			TEXT			NULL,
	NMIMGASSTECNICO			VARCHAR(100)	NULL,
	NMIMGASSCLIENTE			VARCHAR(100)	NULL,
	CDLATITUDE				DECIMAL(23,20)	NULL,
	CDLONGITUDE 			DECIMAL(23,20)	NULL,
	DSOBSERVACAO 			VARCHAR(1000)	NULL,
	CDUSUARIO				VARCHAR(20)		NOT NULL,
	NUCARIMBO				DECIMAL(9,0)	NULL,
	FLTIPOALTERACAO			CHAR(1)			NULL,
	DTALTERACAO				DATETIME		NULL,
	HRALTERACAO				VARCHAR(8)		NULL,
	CONSTRAINT PK_TBLVPDAPLAUDOATUA PRIMARY KEY (CDEMPRESA, CDCLIENTE, CDDAPMATRICULA, CDSAFRA, CDDAPCULTURA, CDDAPLAUDO, CDUSUARIO) 
)
GO

--VERSAO 6.302

/*-------------------------------------------------------------------------
LAV-30542
Autor: Suelen Roecker
Descrição: Nova Tabela e Novo Parâmetro
-------------------------------------------------------------------------*/

CREATE TABLE TBLVPENVIOCAMPANHAPUB (
    CDEMPRESA                   VARCHAR(20)     NOT NULL,
    CDREPRESENTANTE             VARCHAR(20)     NOT NULL,
	CDCAMPANHAPUBLICITARIA      VARCHAR(20)     NOT NULL,
	CDCLIENTE                   VARCHAR(20)     NOT NULL,
	DSCAMPANHAPUBLICITARIA      VARCHAR(20)     NULL,
    CDUSUARIO                   VARCHAR(8)      NOT NULL,
    NUCARIMBO                   DECIMAL(9,0)    NULL,
    FLTIPOALTERACAO             CHAR(1)         NULL,
    DTALTERACAO                 DATETIME        NULL,
    HRALTERACAO                 VARCHAR(8 )     NULL,
    CONSTRAINT PK_TBLVPENVIOCAMPANHAPUB PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCAMPANHAPUBLICITARIA, CDCLIENTE)
)
GO

ALTER TABLE TBLVPPEDIDO ADD FLVINCULACAMPANHAPUBLICITARIA CHAR(1);
GO
ALTER TABLE TBLVPPEDIDO ADD CDCAMPANHAPUBLICITARIA VARCHAR(100);
GO
ALTER TABLE TBLVPPEDIDOERP ADD FLVINCULACAMPANHAPUBLICITARIA CHAR(1);
GO
ALTER TABLE TBLVPPEDIDOERP ADD CDCAMPANHAPUBLICITARIA VARCHAR(100);
GO

--VERSAO 6.303

/*-------------------------------------------------------------------------
Autor: Rovani Pereira
Atividade: LAV-30068
Descrição: Funcionalidade de Recado vinculado ao cliente
Data: 18/05/2021
------------------------------------------------------------------------*/
ALTER TABLE TBLVPRECADO ADD CDEMPRESA VARCHAR(20);
ALTER TABLE TBLVPRECADO ADD CDCLIENTE VARCHAR(20);

/*-------------------------------------------------------------------------
LAV-30821
Autor: Ronan Cardoso
Descrição:Novas colunas na tabela MARGEMRENTAB
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPMARGEMRENTAB ADD VLPCTMARGEMRENTABMIN DECIMAL(16,7);
GO

ALTER TABLE TBLVPMARGEMRENTAB ADD VLPCTMARGEMRENTABMAX DECIMAL(16,7);
GO

/*-------------------------------------------------------------------------
LAV-30495
Autor: Suelen Roecker
Descrição: Novas Colunas
Data: 24/05/21
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPPRODUTO ADD FLIGNORAVALIDACAO CHAR(1);
GO

--VERSAO 6.304

/*------------------------------------------------------------------------
Atividade: LAV-29487
Autor: Renan
Data: 11/03/2021
Descrição: Adicao de tabelas de relacionamento de cliente com kit, combo e desconto quantidade, respectivamente.
-------------------------------------------------------------------------*/
CREATE TABLE TBLVPKITCLIENTE (
	CDEMPRESA           VARCHAR(20)     NOT NULL,
	CDREPRESENTANTE     VARCHAR(20)     NOT NULL,
	CDKIT               VARCHAR(20)     NOT NULL,
	CDTABELAPRECO       VARCHAR(30)     NOT NULL,
	CDCLIENTE		    VARCHAR(20)     NOT NULL,
    CDUSUARIO           VARCHAR(8)      NOT NULL,
    NUCARIMBO           DECIMAL(9,0)        NULL,
    FLTIPOALTERACAO     CHAR(1)             NULL,
    DTALTERACAO         DATETIME            NULL,
    HRALTERACAO         VARCHAR(8)          NULL,
    CONSTRAINT PK_TBLVPKITCLIENTE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDKIT, CDTABELAPRECO, CDCLIENTE, CDUSUARIO)
)
GO

CREATE TABLE TBLVPCOMBOCLIENTE (
	CDEMPRESA           VARCHAR(20)     NOT NULL,
	CDREPRESENTANTE     VARCHAR(20)     NOT NULL,
	CDCOMBO             VARCHAR(20)     NOT NULL,
	CDTABELAPRECO       VARCHAR(30)     NOT NULL,
	CDCLIENTE		    VARCHAR(20)     NOT NULL,
    CDUSUARIO           VARCHAR(8)      NOT NULL,
    NUCARIMBO           DECIMAL(9,0)        NULL,
    FLTIPOALTERACAO     CHAR(1)             NULL,
    DTALTERACAO         DATETIME            NULL,
    HRALTERACAO         VARCHAR(8)          NULL,
    CONSTRAINT PK_TBLVPCOMBOCLIENTE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCOMBO, CDTABELAPRECO, CDCLIENTE, CDUSUARIO)
)
GO

CREATE TABLE TBLVPDESCQUANTIDADECLIENTE (
	CDEMPRESA           VARCHAR(20)     NOT NULL,
	CDREPRESENTANTE     VARCHAR(20)     NOT NULL,
	CDTABELAPRECO       VARCHAR(30)     NOT NULL,
	CDPRODUTO           VARCHAR(20)     NOT NULL,
	CDCLIENTE		    VARCHAR(20)     NOT NULL,
    CDUSUARIO           VARCHAR(8)      NOT NULL,
    NUCARIMBO           DECIMAL(9,0)        NULL,
    FLTIPOALTERACAO     CHAR(1)             NULL,
    DTALTERACAO         DATETIME            NULL,
    HRALTERACAO         VARCHAR(8)          NULL,
    CONSTRAINT PK_TBLVPDESCQUANTIDADECLIENTE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDTABELAPRECO, CDPRODUTO, CDCLIENTE, CDUSUARIO)
)
GO

/*------------------------------------------------------------------------
Atividade: LAV-30195 - Grupo BIG - Duplicidade de informações tela de autorização
Descrição: Adicionando a coluna CDTABELAPRECO na tabela TBLVWSOLAUTORIZACAO
Autor: Raphael Santos
Data: 06/05/2021
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPSOLAUTORIZACAO ADD CDTABELAPRECO VARCHAR(30);
GO

UPDATE TBLVPSOLAUTORIZACAO SET CDTABELAPRECO = (
    SELECT TA.CDTABELAPRECO FROM TBLVPPEDIDO TA WHERE
        TA.CDEMPRESA = TBLVPSOLAUTORIZACAO.CDEMPRESA
    AND TA.CDREPRESENTANTE = TBLVPSOLAUTORIZACAO.CDREPRESENTANTE
    AND TA.FLORIGEMPEDIDO = TBLVPSOLAUTORIZACAO.FLORIGEMPEDIDO
    AND TA.NUPEDIDO = TBLVPSOLAUTORIZACAO.NUPEDIDO
    AND TA.CDCLIENTE = TBLVPSOLAUTORIZACAO.CDCLIENTE
	AND TA.CDUSUARIO = TBLVPSOLAUTORIZACAO.CDUSUARIO
) WHERE CDTABELAPRECO IS NULL;

UPDATE TBLVPSOLAUTORIZACAO SET CDTABELAPRECO = (
    SELECT TA.CDTABELAPRECO FROM TBLVPITEMPEDIDO TA WHERE
        TA.CDEMPRESA = TBLVPSOLAUTORIZACAO.CDEMPRESA
    AND TA.CDREPRESENTANTE = TBLVPSOLAUTORIZACAO.CDREPRESENTANTE
    AND TA.FLORIGEMPEDIDO = TBLVPSOLAUTORIZACAO.FLORIGEMPEDIDO
    AND TA.NUPEDIDO = TBLVPSOLAUTORIZACAO.NUPEDIDO
    AND TA.CDPRODUTO = TBLVPSOLAUTORIZACAO.CDPRODUTO
    AND TA.FLTIPOITEMPEDIDO = TBLVPSOLAUTORIZACAO.FLTIPOITEMPEDIDO
    AND TA.NUSEQPRODUTO = TBLVPSOLAUTORIZACAO.NUSEQPRODUTO
	AND TA.CDUSUARIO = TBLVPSOLAUTORIZACAO.CDUSUARIO
) WHERE CDTABELAPRECO IS NULL;

/*-------------------------------------------------------------------------
Atividade: LAV-30472
Autor: Rovani Pereira
Descrição: Nova Coluna na Tabela TIPOPEDIDO
Data: 26/05/21
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPTIPOPEDIDO ADD CDLOCALESTOQUE VARCHAR(20);
GO

/*-------------------------------------------------------------------------
LAV-30548
Autor: Danilo M.
Descrição:Nova Coluna e Parametro
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPFACEAMENTOESTOQUE ADD QTSUGESTAOVENDAREP DECIMAL(16,7) NULL;
GO


/*-------------------------------------------------------------------------
LAV-30396
Autor: Ronan Cardoso
Descrição:Novas colunas nas tabelas TABELAPRECO e REPRESENTANTE
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPTABELAPRECO ADD VLINDICECOMISSAOREPINTERNO DECIMAL(16,7);
GO

ALTER TABLE TBLVPREPRESENTANTE ADD FLREPRESENTANTEINTERNO CHAR(1);
GO

/*-------------------------------------------------------------------------
LAV-30166
Autor: Rovani Pereira
Descrição:Novo campo na PK e na tabela. Parâmetro para JSON.
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMKIT ADD CDUNIDADE VARCHAR(20) DEFAULT '0';
GO

ALTER TABLE TBLVPITEMKIT DROP CONSTRAINT PK_TBLVPITEMKIT;
GO

UPDATE TBLVPITEMKIT SET CDUNIDADE = '0' WHERE CDUNIDADE IS NULL;

--SQLSERVER
ALTER TABLE TBLVPITEMKIT ALTER COLUMN CDUNIDADE VARCHAR(20) NOT NULL
GO

--/SQLSERVER

--ORACLE
DECLARE COUNT_INDEXES INTEGER;
BEGIN
	SELECT
	COUNT(*)
INTO
	COUNT_INDEXES
FROM
	USER_INDEXES
WHERE
	INDEX_NAME = 'PK_TBLVPITEMKIT';

IF COUNT_INDEXES > 0 THEN EXECUTE IMMEDIATE 'DROP INDEX PK_TBLVPITEMKIT';
END IF;
END;
/
--/ORACLE

ALTER TABLE TBLVPITEMKIT ADD CONSTRAINT PK_TBLVPITEMKIT PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDKIT, CDPRODUTO, CDTABELAPRECO, CDUNIDADE, CDUSUARIO);
GO

--VERSAO 6.306

--VERSAO 6.307

/*-------------------------------------------------------------------------
LAV-30544
Autor: Raphael Custodio
Descrição: Novas colunas na tabela TBLVPDESCPROGRESSIVOCONFIG
-------------------------------------------------------------------------*/

ALTER TABLE TBLVPDESCPROGRESSIVOCONFIG ADD VLMAXDESCPROGRESSIVO DECIMAL(16,7);
GO
ALTER TABLE TBLVPDESCPROGCONFIGFAM ADD FLFAMACUVALORMAX CHAR(1);
GO

--VERSAO 6.308

/*-------------------------------------------------------------------
Atividade: LAV-30939
Autor: Rene Celestino Duarte
Descricao: Histórico de item por status de pedido configurado
Data: 21/07/2021
---------------------------------------------------------------------*/

/*-------------------------------------------------------------------------
NOVA COLUNA
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPSTATUSPEDIDOPDA ADD FLIGNORAHISTORICOITEM VARCHAR(1) DEFAULT 'N';
GO

/*-------------------------------------------------------------------------
Atividade: LAV-31393 - ICONIC - Incrementar Divulga Info com download de imagem exterma por meio de um link
Autor: Raphael Santos
Data: 23/07/2021
Descrição: Criação da coluna NMURLIMAGEMLINK na tabela TBLVPDIVULGAINFO
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPDIVULGAINFO ADD NMURLIMAGEMLINK VARCHAR(4000) NULL;
GO
	
--VERSAO 6.309

/*-------------------------------------------------------------------------
LAV-31036
Autor: Rovani Pereira
Descrição: Novas Colunas para a entidade de Pedido e para StatusPedidoPda.
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPPEDIDO ADD FLEDICAOBLOQUEADA CHAR(1);
ALTER TABLE TBLVPPEDIDOERP ADD FLEDICAOBLOQUEADA CHAR(1);
ALTER TABLE TBLVPSTATUSPEDIDOPDA ADD FLCONVERTETIPOPEDIDOREPLICACAO CHAR(1);

--VERSAO 6.310

/*-------------------------------------------------------------------------
LAV-31385
Autor: Rovani Pereira
Descrição: 	Nova Coluna para a entidade StatusPedidoPda.
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPSTATUSPEDIDOPDA ADD FLOCULTAVALORESCOMISSAO CHAR(1);
GO

--VERSAO 6.311
	
/*-------------------------------------------------------------------------
LAV-31245
Autor: Suelen Viana
Descrição: Nova coluna na TipoPedido
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPTIPOPEDIDO ADD FLBLOQUEIAMULTRELACAOPEDERP CHAR(1);

/*-------------------------------------------------------------------------
LAV-31922
Autor: Raphael Custodio
Descrição: Alterado coluna FLCONSIDERADESCPROG para FLCONSIDERADESCPROGFAMVLMIN e adicionado FLCONSIDERADESCPRO;
-------------------------------------------------------------------------*/
--SQLSERVER
EXEC SP_RENAME 'TBLVPSTATUSPEDIDOPDA.FLCONSIDERADESCPROG', 'FLCONSIDERADESCPROGFAMVLMIN', 'COLUMN';
GO
--/SQLSERVER
--ORACLE
ALTER TABLE TBLVPSTATUSPEDIDOPDA RENAME COLUMN FLCONSIDERADESCPROG to FLCONSIDERADESCPROGFAMVLMIN;
/
--/ORACLE
--POSTGRES
ALTER TABLE TBLVPSTATUSPEDIDOPDA RENAME COLUMN FLCONSIDERADESCPROG to FLCONSIDERADESCPROGFAMVLMIN;
--/POSTGRES

ALTER TABLE TBLVPSTATUSPEDIDOPDA ADD FLCONSIDERADESCPROGVLMAX CHAR(1);
GO


--VERSAO 6.312


/*-------------------------------------------------------------------------
Atividade: LAV-31332
Autor: Rovani Pereira
Data: 16/09/2021
Descrição: Nova coluna para Entidade Cliente, funcionalidade de Produto Controlado.
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPCLIENTE ADD NULICENCAPRODUTOCONTROLADO VARCHAR(100);

/*-------------------------------------------------------------------------
ATIVIDADE: LAV-31193
AUTOR: DANILO MARCELINO
DATA: 28/09/2021
DESCRIÇÃO: NOVA COLUNA
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPITEMPEDIDO ADD VLRENTABILIDADESUG DECIMAL(16,7);
ALTER TABLE TBLVPITEMPEDIDOERP ADD VLRENTABILIDADESUG DECIMAL(16,7);

--VERSAO 6.313

/*-------------------------------------------------------------------------
LAV-29989
Autor: Renan
Descrição: Novas colunas
-------------------------------------------------------------------------*/
ALTER TABLE TBLVPVERBACLIENTE ADD CDVERBASALDOCLIENTE VARCHAR(20) DEFAULT '0' NOT NULL;
GO

ALTER TABLE TBLVPVERBACLIENTE ADD CDGRUPOPRODUTO1 VARCHAR(20) DEFAULT '0' NOT NULL;
GO

ALTER TABLE TBLVPITEMPEDIDO ADD CDVERBASALDOCLIENTE VARCHAR(20);
GO

ALTER TABLE TBLVPITEMPEDIDOERP ADD CDVERBASALDOCLIENTE VARCHAR(20);
GO

ALTER TABLE TBLVPVERBACLIENTE DROP CONSTRAINT PK_TBLVPVERBACLIENTE;
GO

--ORACLE
DECLARE COUNT_INDEXES INTEGER; BEGIN SELECT COUNT(*) INTO COUNT_INDEXES FROM USER_INDEXES WHERE INDEX_NAME = 'PK_TBLVPVERBACLIENTE'; IF COUNT_INDEXES > 0 THEN EXECUTE IMMEDIATE 'DROP INDEX PK_TBLVPVERBACLIENTE'; END IF; END;
/
--/ORACLE

ALTER TABLE TBLVPVERBACLIENTE ADD CONSTRAINT PK_TBLVPVERBACLIENTE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, FLORIGEMSALDO, CDCLIENTE, CDVERBASALDOCLIENTE, CDGRUPOPRODUTO1, CDUSUARIO);
GO

ALTER TABLE TBLVPCONEXAOPDA ADD FLCONEXAOSECUNDARIA CHAR(1);
GO

/*-------------------------------------------------------------------------
ATIVIDADE: LAV-31902
AUTOR: Ronan Cardoso
DATA: 15/10/2021
DESCRIÇÃO: Correção de pks.
-------------------------------------------------------------------------*/
--ORACLE
DECLARE COUNT_PKS INTEGER; BEGIN select COUNT(*) INTO COUNT_PKS from all_constraints where table_name = 'TBLVPENVIOCAMPANHAPUB' and constraint_name = 'PK_TBLVPENVIOCAMPANHAPUB'; IF COUNT_PKS > 0 THEN EXECUTE IMMEDIATE 'ALTER TABLE TBLVPENVIOCAMPANHAPUB DROP CONSTRAINT PK_TBLVPENVIOCAMPANHAPUB'; END IF; END;
/
DECLARE COUNT_PKS INTEGER; BEGIN select COUNT(*) INTO COUNT_PKS from all_constraints where table_name = 'TBLVPENVIOCAMPANHAPUBLICITARIA' and constraint_name = 'PK_TBLVPENVIOCAMPANHAPUBLICITARIA'; IF COUNT_PKS > 0 THEN EXECUTE IMMEDIATE 'ALTER TABLE TBLVPENVIOCAMPANHAPUB DROP CONSTRAINT PK_TBLVPENVIOCAMPANHAPUBLICITARIA'; END IF; END;
/
DECLARE COUNT_PKS INTEGER; BEGIN select COUNT(*) INTO COUNT_PKS from all_constraints where table_name = 'TBLVPENVIOCAMPANHAPUB' and constraint_name = 'PK_TBLVPENVIOCAMPANHAPUBLICITARIA'; IF COUNT_PKS > 0 THEN EXECUTE IMMEDIATE 'ALTER TABLE TBLVPENVIOCAMPANHAPUB DROP CONSTRAINT PK_TBLVPENVIOCAMPANHAPUBLICITARIA'; END IF; END;
/
DECLARE COUNT_PKS INTEGER; BEGIN select COUNT(*) INTO COUNT_PKS from all_constraints where table_name = 'TBLVPENVIOCAMPANHAPUB' and constraint_name = 'PK_TBLVPENVIOCAMPANHAPUBLI'; IF COUNT_PKS > 0 THEN EXECUTE IMMEDIATE 'ALTER TABLE TBLVPENVIOCAMPANHAPUB DROP CONSTRAINT PK_TBLVPENVIOCAMPANHAPUBLI'; END IF; END;
/
ALTER TABLE TBLVPENVIOCAMPANHAPUB ADD CONSTRAINT PK_TBLVPENVIOCAMPANHAPUB PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCAMPANHAPUBLICITARIA, CDCLIENTE, CDUSUARIO);
/
DECLARE COUNT_PKS INTEGER; BEGIN select COUNT(*) INTO COUNT_PKS from all_constraints where table_name = 'TBLVPFAIXACLIENTE' and constraint_name = 'PK_TBLVPFAIXACLIENTE'; IF COUNT_PKS > 0 THEN EXECUTE IMMEDIATE 'ALTER TABLE TBLVPFAIXACLIENTE DROP CONSTRAINT PK_TBLVPFAIXACLIENTE'; END IF; END;
/
DECLARE COUNT_INDEXES INTEGER; BEGIN SELECT COUNT(*) INTO COUNT_INDEXES FROM USER_INDEXES WHERE INDEX_NAME = 'PK_TBLVPFAIXACLIENTE'; IF COUNT_INDEXES > 0 THEN EXECUTE IMMEDIATE 'DROP INDEX PK_TBLVPFAIXACLIENTE'; END IF; END;
/
ALTER TABLE TBLVPFAIXACLIENTE ADD CONSTRAINT PK_TBLVPFAIXACLIENTE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, CDFAIXACLI, CDUSUARIO);
/
--/ORACLE

--POSTGRES
ALTER TABLE TBLVPENVIOCAMPANHAPUB DROP CONSTRAINT PK_TBLVPENVIOCAMPANHAPUBLI;
ALTER TABLE TBLVPENVIOCAMPANHAPUB ADD PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCAMPANHAPUBLICITARIA, CDCLIENTE, CDUSUARIO);
ALTER TABLE TBLVPFAIXACLIENTE DROP CONSTRAINT PK_TBLVPFAIXACLIENTE;
DROP INDEX IF EXISTS PK_TBLVPFAIXACLIENTE;
ALTER TABLE TBLVPFAIXACLIENTE ADD PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, CDFAIXACLI, CDUSUARIO);
--/POSTGRES

--SQLSERVER
ALTER TABLE TBLVPENVIOCAMPANHAPUB DROP CONSTRAINT PK_TBLVPENVIOCAMPANHAPUBLI;
GO
ALTER TABLE TBLVPENVIOCAMPANHAPUB ADD CONSTRAINT PK_TBLVPENVIOCAMPANHAPUB PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCAMPANHAPUBLICITARIA, CDCLIENTE, CDUSUARIO);
GO
ALTER TABLE TBLVPFAIXACLIENTE DROP CONSTRAINT PK_TBLVPFAIXACLIENTE;
GO
DROP INDEX PK_TBLVPFAIXACLIENTE ON TBLVPFAIXACLIENTE;
GO
ALTER TABLE TBLVPFAIXACLIENTE ADD CONSTRAINT PK_TBLVPFAIXACLIENTE PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDCLIENTE, CDFAIXACLI, CDUSUARIO);
GO
--/SQLSERVER