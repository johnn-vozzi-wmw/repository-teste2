/*** versão do sistema para qual o banco é compatível ***/
update TBLVPSISTEMA set DSVERSAOSISTEMA = '3.29' where CDSISTEMA = 20;


/*-------------------------------------------------------------------------
Data: 15/10/2013
Autor: Guilherme Ribeiro
Descrição: Ajustes no tamanho de campos em tabelas do Pda difenrentes da Web
------------------------------------------------------------------------*/

--SQLSERVER

--TBLVPCAMPANHA
ALTER TABLE TBLVPCAMPANHA ALTER COLUMN DSCAMPANHA VARCHAR(4000);

--TBLVPCLIENTE
ALTER TABLE TBLVPCLIENTE ALTER COLUMN NMRAZAOSOCIAL VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSEMAIL VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSOBSERVACAO VARCHAR(255);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN NMFANTASIA VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN NMCONTATOPRINCIPAL VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSLOGRADOUROCOMERCIAL VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSCOMPLEMENTOCOMERCIAL VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSBAIRROCOMERCIAL VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSCIDADECOMERCIAL VARCHAR(100);

-- TBLVPCONCORRENTE
ALTER TABLE TBLVPCONCORRENTE ALTER COLUMN DSCONCORRENTE VARCHAR(100);

-- TBLVPCONDICAOCOMERCIAL
ALTER TABLE TBLVPCONDICAOCOMERCIAL ALTER COLUMN DSCONDICAOCOMERCIAL VARCHAR(100);

-- TBLVPFICHAFINANCEIRA
ALTER TABLE TBLVPFICHAFINANCEIRA ALTER COLUMN DSPAGAMENTOANTECIPADO VARCHAR(100);
ALTER TABLE TBLVPFICHAFINANCEIRA ALTER COLUMN DSPAGAMENTOATRASADO VARCHAR(100);
ALTER TABLE TBLVPFICHAFINANCEIRA ALTER COLUMN DSPAGAMENTOVENCIMENTO VARCHAR(100);

-- TBLVPITEMPEDIDOERP
ALTER TABLE TBLVPITEMPEDIDOERP ALTER COLUMN CDLOTEPRODUTO VARCHAR(20);

-- TBLVPITEMTABELAPRECO
ALTER TABLE TBLVPITEMTABELAPRECO ALTER COLUMN QTMAXVENDA DECIMAL(16,7);

-- TBLVPPEDIDO
ALTER TABLE TBLVPPEDIDO ALTER COLUMN DSMENSAGEMENTREGA VARCHAR(255);
ALTER TABLE TBLVPPEDIDO ALTER COLUMN DSMOTIVODESCONTO VARCHAR(4000);

-- TBLVPPEDIDOERP
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN DSMENSAGEMENTREGA VARCHAR(255);
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN DSMOTIVODESCONTO VARCHAR(4000);

-- TBLVPPRODUTO
ALTER TABLE TBLVPPRODUTO ALTER COLUMN DSREFERENCIA VARCHAR(100);
ALTER TABLE TBLVPPRODUTO ALTER COLUMN DSUNIDADEFATURAMENTO VARCHAR(100);
ALTER TABLE TBLVPPRODUTO ALTER COLUMN DSUNIDADEFISICA VARCHAR(100);

--TBLVPSUGESTAOVENDA
ALTER TABLE TBLVPSUGESTAOVENDA ALTER COLUMN DSSUGESTAOVENDA VARCHAR(100);

-- TBLVPTITULOFINANCEIRO
ALTER TABLE TBLVPTITULOFINANCEIRO ALTER COLUMN DSHISTORICO VARCHAR(300);
ALTER TABLE TBLVPTITULOFINANCEIRO ALTER COLUMN DSOBSERVACAO VARCHAR(120);

-- ALTERAÇÕES CAMPOS DE HORA TABELAS TBLVPPEDIDO E TBLVPPEDIDOERP PARA VARCHAR
ALTER TABLE TBLVPPEDIDO ALTER COLUMN HREMISSAO VARCHAR(5);
ALTER TABLE TBLVPPEDIDO ALTER COLUMN HRFECHAMENTO VARCHAR(5);
ALTER TABLE TBLVPPEDIDO ALTER COLUMN HRTRANSMISSAOPDA VARCHAR(5);
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN HREMISSAO VARCHAR(5);
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN HRFECHAMENTO VARCHAR(5);
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN HRTRANSMISSAOPDA VARCHAR(5);

--/SQLSERVER

--ORACLE

--TBLVPCAMPANHA
ALTER TABLE TBLVPCAMPANHA ALTER COLUMN DSCAMPANHA VARCHAR(4000);

--TBLVPCLIENTE
ALTER TABLE TBLVPCLIENTE ALTER COLUMN NMRAZAOSOCIAL VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSEMAIL VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSOBSERVACAO VARCHAR(255);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN NMFANTASIA VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN NMCONTATOPRINCIPAL VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSLOGRADOUROCOMERCIAL VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSCOMPLEMENTOCOMERCIAL VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSBAIRROCOMERCIAL VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSCIDADECOMERCIAL VARCHAR(100);

-- TBLVPCONCORRENTE
ALTER TABLE TBLVPCONCORRENTE ALTER COLUMN DSCONCORRENTE VARCHAR(100);

-- TBLVPCONDICAOCOMERCIAL
ALTER TABLE TBLVPCONDICAOCOMERCIAL ALTER COLUMN DSCONDICAOCOMERCIAL VARCHAR(100);

-- TBLVPFICHAFINANCEIRA
ALTER TABLE TBLVPFICHAFINANCEIRA ALTER COLUMN DSPAGAMENTOANTECIPADO VARCHAR(100);
ALTER TABLE TBLVPFICHAFINANCEIRA ALTER COLUMN DSPAGAMENTOATRASADO VARCHAR(100);
ALTER TABLE TBLVPFICHAFINANCEIRA ALTER COLUMN DSPAGAMENTOVENCIMENTO VARCHAR(100);

-- TBLVPITEMPEDIDOERP
ALTER TABLE TBLVPITEMPEDIDOERP ALTER COLUMN CDLOTEPRODUTO VARCHAR(20);

-- TBLVPITEMTABELAPRECO
ALTER TABLE TBLVPITEMTABELAPRECO ALTER COLUMN QTMAXVENDA DECIMAL(16,7);

-- TBLVPPEDIDO
ALTER TABLE TBLVPPEDIDO ALTER COLUMN DSMENSAGEMENTREGA VARCHAR(255);
ALTER TABLE TBLVPPEDIDO ALTER COLUMN DSMOTIVODESCONTO VARCHAR(4000);

-- TBLVPPEDIDOERP
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN DSMENSAGEMENTREGA VARCHAR(255);
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN DSMOTIVODESCONTO VARCHAR(4000);

-- TBLVPPRODUTO
ALTER TABLE TBLVPPRODUTO ALTER COLUMN DSREFERENCIA VARCHAR(100);
ALTER TABLE TBLVPPRODUTO ALTER COLUMN DSUNIDADEFATURAMENTO VARCHAR(100);
ALTER TABLE TBLVPPRODUTO ALTER COLUMN DSUNIDADEFISICA VARCHAR(100);

--TBLVPSUGESTAOVENDA
ALTER TABLE TBLVPSUGESTAOVENDA ALTER COLUMN DSSUGESTAOVENDA VARCHAR(100);

-- TBLVPTITULOFINANCEIRO
ALTER TABLE TBLVPTITULOFINANCEIRO ALTER COLUMN DSHISTORICO VARCHAR(300);
ALTER TABLE TBLVPTITULOFINANCEIRO ALTER COLUMN DSOBSERVACAO VARCHAR(120);

-- ALTERAÇÕES CAMPOS DE HORA TABELAS TBLVPPEDIDO E TBLVPPEDIDOERP PARA VARCHAR
ALTER TABLE TBLVPPEDIDO ALTER COLUMN HREMISSAO VARCHAR(5);
ALTER TABLE TBLVPPEDIDO ALTER COLUMN HRFECHAMENTO VARCHAR(5);
ALTER TABLE TBLVPPEDIDO ALTER COLUMN HRTRANSMISSAOPDA VARCHAR(5);
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN HREMISSAO VARCHAR(5);
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN HRFECHAMENTO VARCHAR(5);
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN HRTRANSMISSAOPDA VARCHAR(5);

--/ORACLE

--POSTGRES

--TBLVPCAMPANHA
ALTER TABLE TBLVPCAMPANHA ALTER COLUMN DSCAMPANHA TYPE VARCHAR(4000);

--TBLVPCLIENTE
ALTER TABLE TBLVPCLIENTE ALTER COLUMN NMRAZAOSOCIAL TYPE VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSEMAIL TYPE VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSOBSERVACAO TYPE VARCHAR(255);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN NMFANTASIA TYPE VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN NMCONTATOPRINCIPAL TYPE VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSLOGRADOUROCOMERCIAL TYPE VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSCOMPLEMENTOCOMERCIAL TYPE VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSBAIRROCOMERCIAL TYPE VARCHAR(100);
ALTER TABLE TBLVPCLIENTE ALTER COLUMN DSCIDADECOMERCIAL TYPE VARCHAR(100);

-- TBLVPCONCORRENTE
ALTER TABLE TBLVPCONCORRENTE ALTER COLUMN DSCONCORRENTE TYPE VARCHAR(100);

-- TBLVPCONDICAOCOMERCIAL
ALTER TABLE TBLVPCONDICAOCOMERCIAL ALTER COLUMN DSCONDICAOCOMERCIAL TYPE VARCHAR(100);

-- TBLVPFICHAFINANCEIRA
ALTER TABLE TBLVPFICHAFINANCEIRA ALTER COLUMN DSPAGAMENTOANTECIPADO TYPE VARCHAR(100);
ALTER TABLE TBLVPFICHAFINANCEIRA ALTER COLUMN DSPAGAMENTOATRASADO TYPE VARCHAR(100);
ALTER TABLE TBLVPFICHAFINANCEIRA ALTER COLUMN DSPAGAMENTOVENCIMENTO TYPE VARCHAR(100);

-- TBLVPITEMPEDIDOERP
ALTER TABLE TBLVPITEMPEDIDOERP ALTER COLUMN CDLOTEPRODUTO TYPE VARCHAR(20);

-- TBLVPITEMTABELAPRECO
ALTER TABLE TBLVPITEMTABELAPRECO ALTER COLUMN QTMAXVENDA TYPE DECIMAL(16,7);

-- TBLVPPEDIDO
ALTER TABLE TBLVPPEDIDO ALTER COLUMN DSMENSAGEMENTREGA TYPE VARCHAR(255);
ALTER TABLE TBLVPPEDIDO ALTER COLUMN DSMOTIVODESCONTO TYPE VARCHAR(4000);

-- TBLVPPEDIDOERP
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN DSMENSAGEMENTREGA TYPE VARCHAR(255);
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN DSMOTIVODESCONTO TYPE VARCHAR(4000);

-- TBLVPPRODUTO
ALTER TABLE TBLVPPRODUTO ALTER COLUMN DSREFERENCIA TYPE VARCHAR(100);
ALTER TABLE TBLVPPRODUTO ALTER COLUMN DSUNIDADEFATURAMENTO TYPE VARCHAR(100);
ALTER TABLE TBLVPPRODUTO ALTER COLUMN DSUNIDADEFISICA TYPE VARCHAR(100);

--TBLVPSUGESTAOVENDA
ALTER TABLE TBLVPSUGESTAOVENDA ALTER COLUMN DSSUGESTAOVENDA TYPE VARCHAR(100);

-- TBLVPTITULOFINANCEIRO
ALTER TABLE TBLVPTITULOFINANCEIRO ALTER COLUMN DSHISTORICO TYPE VARCHAR(300);
ALTER TABLE TBLVPTITULOFINANCEIRO ALTER COLUMN DSOBSERVACAO TYPE VARCHAR(120);

-- ALTERAÇÕES CAMPOS DE HORA TABELAS TBLVPPEDIDO E TBLVPPEDIDOERP PARA VARCHAR
ALTER TABLE TBLVPPEDIDO ALTER COLUMN HREMISSAO TYPE VARCHAR(5);
ALTER TABLE TBLVPPEDIDO ALTER COLUMN HRFECHAMENTO TYPE VARCHAR(5);
ALTER TABLE TBLVPPEDIDO ALTER COLUMN HRTRANSMISSAOPDA TYPE VARCHAR(5);
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN HREMISSAO TYPE VARCHAR(5);
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN HRFECHAMENTO TYPE VARCHAR(5);
ALTER TABLE TBLVPPEDIDOERP ALTER COLUMN HRTRANSMISSAOPDA TYPE VARCHAR(5);

--/POSTGRES


/*-------------------------------------------------------------------------
Data: 17/10/2013
Autor: Pedro
Descrição: Novas tabelas de framework
------------------------------------------------------------------------*/
CREATE TABLE TBLVPUSUARIOSISTEMA (
   CDSISTEMA            DECIMAL(9)           NOT NULL,
   CDUSUARIO            VARCHAR(20)          NOT NULL,
   CDFUNCAO             VARCHAR(20)          NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   NUCARIMBO            DECIMAL(9)           NULL,
   CONSTRAINT PK_TBLVPUSUARIOSISTEMA PRIMARY KEY (CDSISTEMA, CDUSUARIO)
)
go

CREATE TABLE TBLVPAUTORIZACAO (
   CDSISTEMA            DECIMAL(9)           NOT NULL,
   CDPAPEL              VARCHAR(20)          NOT NULL,
   CDTELA               DECIMAL(9)           NOT NULL,
   CDACAO               DECIMAL(9)           NOT NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   NUCARIMBO            DECIMAL(9)           NULL,
   CONSTRAINT PK_TBLVPAUTORIZACAO PRIMARY KEY (CDSISTEMA, CDPAPEL, CDTELA, CDACAO)
)
go

CREATE TABLE TBLVPMENU (
   CDSISTEMA            DECIMAL(9)           NOT NULL,
   CDMENU               DECIMAL(9)           NOT NULL,
   CDMENUPAI            DECIMAL(9)           NULL,
   CDTELA               DECIMAL(9)           NULL,
   CDACAO               DECIMAL(9)           NULL,
   NMMENU               VARCHAR(50)          NULL,
   NUORDEM              DECIMAL(9)           NULL,
   IMICONE              IMAGE                NULL,
   NUCARIMBO            DECIMAL(9)           NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   CONSTRAINT PK_TBLVPMENU PRIMARY KEY (CDSISTEMA, CDMENU)
)
go

CREATE TABLE TBLVPFUNCAOPAPEL (
   CDFUNCAO             VARCHAR(20)          NOT NULL,
   CDSISTEMA            DECIMAL(9)           NOT NULL,
   CDPAPEL              VARCHAR(20)          NOT NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   NUCARIMBO            DECIMAL(9)           NULL,
   CONSTRAINT PK_TBLVPFUNCAOPAPEL PRIMARY KEY (CDFUNCAO, CDSISTEMA, CDPAPEL)
)
go


/*-------------------------------------------------------------------------
Data: 21/10/2013
Autor: Fernando
Descrição: Ajuste na tabela PRODUTOTIPOPED
------------------------------------------------------------------------*/
alter table TBLVPPRODUTOTIPOPED DROP CONSTRAINT PK_TBLVPPRODUTOTIPOPED;
alter table TBLVPPRODUTOTIPOPED ADD CONSTRAINT PK_TBLVPPRODUTOTIPOPED
PRIMARY KEY (CDEMPRESA, CDREPRESENTANTE, CDTIPOPEDIDO, CDPRODUTO, CDUSUARIO);


/*-------------------------------------------------------------------------
Data: 28/10/2013
Autor: Pedro
Descrição: Novas tabelas de framework
------------------------------------------------------------------------*/
CREATE TABLE TBLVPTELA (
   CDSISTEMA            DECIMAL(9)           NOT NULL,
   CDTELA               DECIMAL(9)           NOT NULL,
   NMTELA               VARCHAR(100)         NOT NULL,
   DSTELA               VARCHAR(1000)        NULL,
   CDTIPOTELA           VARCHAR(20)          NULL,
   DSSQL                VARCHAR(4000)        NULL,
   CDTIPOGRID           VARCHAR(20)          NULL,
   CDTIPOGRAFICO        DECIMAL(9)           NULL,
   FLTOOLTIPVISIVEL     CHAR(1)              NULL,
   DSFORMATOTOOLTIP     VARCHAR(100)         NULL,
   FLPOSSUILEGENDA      CHAR(1)              NULL,
   CDPOSICAOLEGENDA     DECIMAL(9)           NULL,
   DSFORMATOLEGENDA     VARCHAR(100)         NULL,
   NULIMITEREGISTROSGRAFICO DECIMAL(9)           NULL,
   FLPOSSUIOPCAOOUTROS  CHAR(1)              NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   NUCARIMBO            DECIMAL(9)           NULL,
   CONSTRAINT PK_TBLVPTELA PRIMARY KEY (CDSISTEMA, CDTELA)
)
go

CREATE TABLE TBLVPCAMPOTELA (
   CDSISTEMA            DECIMAL(9)           NOT NULL,
   CDTELA               DECIMAL(9)           NOT NULL,
   NMCAMPO              VARCHAR(30)          NOT NULL,
   FLTIPOCAMPO          CHAR(1)              NOT NULL,
   CDDOMINIO            DECIMAL(9)           NULL,
   DSLABEL              VARCHAR(100)         NULL,
   NUORDEM              DECIMAL(9)           NULL,
   FLVISIVEL            CHAR(1)              NULL,
   NUWIDTH              DECIMAL(9)           NULL,
   FLORDENACAOPADRAO    CHAR(1)              NULL,
   FLORDENACAOASC       CHAR(1)              NULL,
   VLPADRAO             VARCHAR(4000)        NULL,
   DSEXPRESSAO          VARCHAR(4000)        NULL,
   CDNIVELGRUPOLISTA    DECIMAL(9)           NULL,
   FLUSAOPCAOFILTROTODOS CHAR(1)              NULL,
   CDTIPOOPERACAO       DECIMAL(9)           NULL,
   CDTIPOVARIAVELGRAFICO DECIMAL(9)           NULL,
   FLTIPOALTERACAO      CHAR(1)              NULL,
   NUCARIMBO            DECIMAL(9)           NULL,
   CONSTRAINT PK_TBLVPCAMPOTELA PRIMARY KEY (CDSISTEMA, CDTELA, NMCAMPO, FLTIPOCAMPO)
)
go

